[2023-08-31T02:41:29.845+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509
[2023-08-31T02:41:29.846+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings'
[2023-08-31T02:41:29.877+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509
[2023-08-31T02:41:29.878+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings'
[2023-08-31T02:41:29.913+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Autotrader_ETL_DAG.extract_listings manual__2023-08-31T02:41:28.950073+00:00 [queued]>
[2023-08-31T02:41:29.921+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Autotrader_ETL_DAG.extract_listings manual__2023-08-31T02:41:28.950073+00:00 [queued]>
[2023-08-31T02:41:29.922+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-08-31T02:41:29.935+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): extract_listings> on 2023-08-31 02:41:28.950073+00:00
[2023-08-31T02:41:29.940+0000] {standard_task_runner.py:57} INFO - Started process 659 to run task
[2023-08-31T02:41:29.942+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'Autotrader_ETL_DAG', 'extract_listings', 'manual__2023-08-31T02:41:28.950073+00:00', '--job-id', '95', '--raw', '--subdir', 'DAGS_FOLDER/autotrader_etl.py', '--cfg-path', '/tmp/tmp98ppuxdi']
[2023-08-31T02:41:29.945+0000] {standard_task_runner.py:85} INFO - Job 95: Subtask extract_listings
[2023-08-31T02:41:29.983+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509
[2023-08-31T02:41:29.984+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=Autotrader_ETL_DAG/run_id=manual__2023-08-31T02:41:28.950073+00:00/task_id=extract_listings'
[2023-08-31T02:41:29.986+0000] {task_command.py:415} INFO - Running <TaskInstance: Autotrader_ETL_DAG.extract_listings manual__2023-08-31T02:41:28.950073+00:00 [running]> on host 1a0e8b05e04d
[2023-08-31T02:41:30.066+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Autotrader_ETL_DAG' AIRFLOW_CTX_TASK_ID='extract_listings' AIRFLOW_CTX_EXECUTION_DATE='2023-08-31T02:41:28.950073+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-08-31T02:41:28.950073+00:00'
[2023-08-31T02:41:30.069+0000] {logging_mixin.py:151} INFO - environ({'DUMB_INIT_SETSID': '1', 'HOSTNAME': '1a0e8b05e04d', 'PYTHON_VERSION': '3.8.17', 'LANGUAGE': 'C.UTF-8', 'AIRFLOW_USER_HOME_DIR': '/home/***', 'ADDITIONAL_RUNTIME_APT_DEPS': '', 'PWD': '/opt/***', 'AIRFLOW_VERSION': '2.7.0', 'AIRFLOW__CORE__LOAD_EXAMPLES': 'false', 'INSTALL_MSSQL_CLIENT': 'true', 'PYTHON_SETUPTOOLS_VERSION': '57.5.0', 'GUNICORN_CMD_ARGS': '--worker-tmp-dir /dev/shm', 'LD_PRELOAD': '/usr/lib/x86_64-linux-gnu/libstdc++.so.6', 'HOME': '/home/***', 'LANG': 'C.UTF-8', 'AIRFLOW_HOME': '/opt/***', 'GPG_KEY': 'E3FF2839C048B25C084DEBE9B26995E310250568', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN': 'postgresql+psycopg2://***:***@postgres/***', 'AIRFLOW__CORE__EXECUTOR': 'LocalExecutor', 'COMMIT_SHA': '126b507e825df6302f31024cd9b961b50d18a165', 'AIRFLOW_PIP_VERSION': '23.2.1', 'ADDITIONAL_RUNTIME_APT_COMMAND': '', 'INSTALL_POSTGRES_CLIENT': 'true', 'SHLVL': '0', 'LC_MESSAGES': 'C.UTF-8', 'RUNTIME_APT_DEPS': '', 'PYTHON_PIP_VERSION': '23.0.1', 'RUNTIME_APT_COMMAND': 'echo', 'LD_LIBRARY_PATH': '/usr/local/lib', 'LC_CTYPE': 'C.UTF-8', 'PYTHON_GET_PIP_SHA256': '45a2bb8bf2bb5eff16fdd00faef6f29731831c7c59bd9fc2bf1f3bed511ff1fe', 'AIRFLOW_INSTALLATION_METHOD': '', 'LC_ALL': 'C.UTF-8', 'PYTHON_GET_PIP_URL': 'https://github.com/pypa/get-pip/raw/9af82b715db434abb94a0a6f3569f43e72157346/public/get-pip.py', 'INSTALL_MYSQL_CLIENT': 'true', 'PATH': '/root/bin:/home/***/.local/bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'PYTHON_BASE_IMAGE': 'python:3.8-slim-bullseye', 'AIRFLOW_UID': '50000', 'BUILD_ID': '', 'DEBIAN_FRONTEND': 'noninteractive', 'PROJECT_ID': 'autotrader-toyota-dashboard', 'PRIVATE_KEY_ID': 'fb895d03968770ea33d396df0de213bcd0ba0f16', 'PRIVATE_KEY': '-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDJXYIfB5+ELMor\nPu6X7PSYgV1zJDNGokrePJfrIJZGcuvGSaQIThu8aEZ4kQQGgcYPFfNpqqFCvSJq\ndFNQjimyZlbc570/Q28NaRSVFNWO9OB7yUjTxA0SnZIavCsMnWB3ozAFZBKbxI+9\nM0/H/QAVwNSarf9IH7Hng/kP0hGHqTwJ3dflqt6glZYjpqDg2uHfyFmoflddQSSx\nM6tV4v6atq9bjWELDBmVSdyc/oUK5xbjeWq+hK2lFssw6YQFy/ymRy1lhvZDPuYf\noSvO01s2T+9uZahM0gueirfNsK+v08eqskwKP6ed5F2FRJ37mYkW/CXguBFjanMs\naco7kzdNAgMBAAECggEAFChMrM+GC+Sx7kdT+hhp2dRlZu/SRDld1kZpjMuLz4yU\nhpp7latAAonLuCkIJqCaE4uGfObsUrJ9PfvcFT3N9cJh4qY+HxWgic6hlVTrFe70\ng9+/7xb6mgj1BcEdbBta+072MSv14ur32qBG1cXBWuwdPEi7u9wUYpEm/wrv300H\nmYllmeP2s/uex5su3mUFvosc1QzNUzvZ4Qa+AyPepMxLUM/s5prqYY6qSzFp1OeT\nPyg3jMQbbuzEcieKR9mN2co1ohm4WJ9yCRhs4EwDG3Fv2tX+89/J3r+0/yEJdUPE\nLCJKutqKvxWukLaPAGLNK8cQUDAoI7v06kB7egVsfwKBgQDzOenjT5ZN4QaYtzZY\n+T39NvPtVQgjL/0M4Yoz2n8JaZUcAxlnLFeuKifCeSE209+krNEbTOVyX5T7fTBx\nH2JK3oCXaJr7uXvP4pZWoGVBgMdznAEtBkYJe6l6ue+WBoMy5L1I3KQqqA83t8tv\n1sXzFRvXt4pngWTF/9QDgGQ4ewKBgQDT8MojepFVLyWuLohWq9sWgbxkDBEarMf2\nI/aIUwcEZ1qU1/wxBoiFY2e43YAzECraKFGJwxK1J1Xv0dkX6ykRMZ50ktQKhgYt\nklg7mpoP0aV3B/SJj/7MwOTgpE7NmMzJ7KDyMrpjoWSfoa++Sodk+U1E4ika1asL\nHC45W0DY1wKBgQCP14IwwlKbgCcMjd2ARPaaF7Ouegkz9h9rTL8U53UVtfFO/a46\nTAkWoSueYVB5QlgS5XlM8e8H8usCyAir/el9aZUW9fAiSpGkYdaTKIx5bpWGE47G\nd91XomCaiffc+8D/ijM/Me2MpJNLWlDftV6f4a3zp0Ic8HMOfbt+zqF2nQKBgGZm\n1DP6N5gx9IHJR+SgmnWwb4bjcawyyVa7H5XUj/JnwZNjHB3P60yPsADZPOTvLdVE\nX8kxMKvIerQp7zuoSqpdEBOBEeSXxwpjyC/cTg3QnKL7fAKvSUxC8xM7MDwUVPZH\nV6hOLFKRG14psBFAT1TRQ61BnNyzWjY/AnKCDb33AoGAU6FUQ+tsUalvKrhEknCY\nHNUznyw+8p/xzBvbisb4mmM1PH9I1arAg7LUVh6emWf34Fy9eGP6+OH9tJ7es2Gt\nXUrAbTQKyA6c4ifjnHtGh38arGOk4bWZPscEWt6+vx0neUaIEdMBXrfHlzfvCEi0\nftTzUiruJIlfr18d2DdoNmo=\n-----END PRIVATE KEY-----\n', 'CLIENT_EMAIL': 'autotrader-dashboard@autotrader-toyota-dashboard.iam.gserviceaccount.com', 'CLIENT_ID': '100550075900422365800', 'CLIENT_X509_CERT_URL': 'https://www.googleapis.com/robot/v1/metadata/x509/autotrader-dashboard%40autotrader-toyota-dashboard.iam.gserviceaccount.com', '_AIRFLOW_PARSING_CONTEXT_DAG_ID': 'Autotrader_ETL_DAG', '_AIRFLOW_PARSING_CONTEXT_TASK_ID': 'extract_listings', 'AIRFLOW_CTX_DAG_OWNER': '***', 'AIRFLOW_CTX_DAG_ID': 'Autotrader_ETL_DAG', 'AIRFLOW_CTX_TASK_ID': 'extract_listings', 'AIRFLOW_CTX_EXECUTION_DATE': '2023-08-31T02:41:28.950073+00:00', 'AIRFLOW_CTX_TRY_NUMBER': '1', 'AIRFLOW_CTX_DAG_RUN_ID': 'manual__2023-08-31T02:41:28.950073+00:00'})
[2023-08-31T02:41:30.069+0000] {logging_mixin.py:151} INFO - {'type': 'service_account', 'project_id': 'autotrader-toyota-dashboard', 'private_key_id': 'fb895d03968770ea33d396df0de213bcd0ba0f16', 'private_key': '-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDJXYIfB5+ELMor\nPu6X7PSYgV1zJDNGokrePJfrIJZGcuvGSaQIThu8aEZ4kQQGgcYPFfNpqqFCvSJq\ndFNQjimyZlbc570/Q28NaRSVFNWO9OB7yUjTxA0SnZIavCsMnWB3ozAFZBKbxI+9\nM0/H/QAVwNSarf9IH7Hng/kP0hGHqTwJ3dflqt6glZYjpqDg2uHfyFmoflddQSSx\nM6tV4v6atq9bjWELDBmVSdyc/oUK5xbjeWq+hK2lFssw6YQFy/ymRy1lhvZDPuYf\noSvO01s2T+9uZahM0gueirfNsK+v08eqskwKP6ed5F2FRJ37mYkW/CXguBFjanMs\naco7kzdNAgMBAAECggEAFChMrM+GC+Sx7kdT+hhp2dRlZu/SRDld1kZpjMuLz4yU\nhpp7latAAonLuCkIJqCaE4uGfObsUrJ9PfvcFT3N9cJh4qY+HxWgic6hlVTrFe70\ng9+/7xb6mgj1BcEdbBta+072MSv14ur32qBG1cXBWuwdPEi7u9wUYpEm/wrv300H\nmYllmeP2s/uex5su3mUFvosc1QzNUzvZ4Qa+AyPepMxLUM/s5prqYY6qSzFp1OeT\nPyg3jMQbbuzEcieKR9mN2co1ohm4WJ9yCRhs4EwDG3Fv2tX+89/J3r+0/yEJdUPE\nLCJKutqKvxWukLaPAGLNK8cQUDAoI7v06kB7egVsfwKBgQDzOenjT5ZN4QaYtzZY\n+T39NvPtVQgjL/0M4Yoz2n8JaZUcAxlnLFeuKifCeSE209+krNEbTOVyX5T7fTBx\nH2JK3oCXaJr7uXvP4pZWoGVBgMdznAEtBkYJe6l6ue+WBoMy5L1I3KQqqA83t8tv\n1sXzFRvXt4pngWTF/9QDgGQ4ewKBgQDT8MojepFVLyWuLohWq9sWgbxkDBEarMf2\nI/aIUwcEZ1qU1/wxBoiFY2e43YAzECraKFGJwxK1J1Xv0dkX6ykRMZ50ktQKhgYt\nklg7mpoP0aV3B/SJj/7MwOTgpE7NmMzJ7KDyMrpjoWSfoa++Sodk+U1E4ika1asL\nHC45W0DY1wKBgQCP14IwwlKbgCcMjd2ARPaaF7Ouegkz9h9rTL8U53UVtfFO/a46\nTAkWoSueYVB5QlgS5XlM8e8H8usCyAir/el9aZUW9fAiSpGkYdaTKIx5bpWGE47G\nd91XomCaiffc+8D/ijM/Me2MpJNLWlDftV6f4a3zp0Ic8HMOfbt+zqF2nQKBgGZm\n1DP6N5gx9IHJR+SgmnWwb4bjcawyyVa7H5XUj/JnwZNjHB3P60yPsADZPOTvLdVE\nX8kxMKvIerQp7zuoSqpdEBOBEeSXxwpjyC/cTg3QnKL7fAKvSUxC8xM7MDwUVPZH\nV6hOLFKRG14psBFAT1TRQ61BnNyzWjY/AnKCDb33AoGAU6FUQ+tsUalvKrhEknCY\nHNUznyw+8p/xzBvbisb4mmM1PH9I1arAg7LUVh6emWf34Fy9eGP6+OH9tJ7es2Gt\nXUrAbTQKyA6c4ifjnHtGh38arGOk4bWZPscEWt6+vx0neUaIEdMBXrfHlzfvCEi0\nftTzUiruJIlfr18d2DdoNmo=\n-----END PRIVATE KEY-----\n', 'client_email': 'autotrader-dashboard@autotrader-toyota-dashboard.iam.gserviceaccount.com', 'client_id': '100550075900422365800', 'auth_uri': 'https://accounts.google.com/o/oauth2/auth', 'token_uri': 'https://oauth2.googleapis.com/token', 'auth_provider_x509_cert_url': 'https://www.googleapis.com/oauth2/v1/certs', 'client_x509_cert_url': 'https://www.googleapis.com/robot/v1/metadata/x509/autotrader-dashboard%40autotrader-toyota-dashboard.iam.gserviceaccount.com', 'universe_domain': 'googleapis.com'}
[2023-08-31T02:42:15.454+0000] {local_task_job_runner.py:294} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2023-08-31T02:42:15.458+0000] {process_utils.py:131} INFO - Sending 15 to group 659. PIDs of all processes in the group: [659]
[2023-08-31T02:42:15.459+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 659
[2023-08-31T02:42:15.461+0000] {taskinstance.py:1632} ERROR - Received SIGTERM. Terminating subprocesses.
[2023-08-31T02:42:15.462+0000] {python.py:194} INFO - Done. Returned value was: Task received SIGTERM signal
[2023-08-31T02:42:15.470+0000] {xcom.py:661} ERROR - Object of type AirflowException is not JSON serializable. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config or make sure to decorate your object with attr.
[2023-08-31T02:42:15.472+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 91, in default
    return serialize(o)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/serialization/serde.py", line 178, in serialize
    raise TypeError(f"cannot serialize object of type {cls}")
TypeError: cannot serialize object of type <class '***.exceptions.AirflowException'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 74, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2485, in xcom_push
    XCom.set(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 74, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 244, in set
    value = cls.serialize_value(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 659, in serialize_value
    return json.dumps(value, cls=XComEncoder).encode("UTF-8")
  File "/usr/local/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 104, in encode
    return super().encode(o)
  File "/usr/local/lib/python3.8/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.8/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 93, in default
    return super().default(o)
  File "/usr/local/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type AirflowException is not JSON serializable
[2023-08-31T02:42:15.480+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=Autotrader_ETL_DAG, task_id=extract_listings, execution_date=20230831T024128, start_date=20230831T024129, end_date=20230831T024215
[2023-08-31T02:42:15.492+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 95 for task extract_listings (Object of type AirflowException is not JSON serializable; 659)
[2023-08-31T02:42:15.511+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=659, status='terminated', exitcode=1, started='02:41:29') (659) terminated with exit code 1
