[0m00:25:57.081113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d5a8be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d57915d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d5791310>]}


============================== 00:25:57.090319 | 069fbc23-1af4-4cd0-ae7f-2f911eec6cde ==============================
[0m00:25:57.090319 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:25:57.092078 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m00:25:58.088505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '069fbc23-1af4-4cd0-ae7f-2f911eec6cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d366fa10>]}
[0m00:25:58.112818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '069fbc23-1af4-4cd0-ae7f-2f911eec6cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d36845d0>]}
[0m00:25:58.114909 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:25:58.117071 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:25:58.118655 [debug] [MainThread]: Command `dbt run` failed at 00:25:58.118477 after 1.10 seconds
[0m00:25:58.119822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d5905950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d59057d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d57a7f90>]}
[0m00:25:58.121067 [debug] [MainThread]: Flushing usage events
[0m00:28:26.879175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618907d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618907e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9619288e10>]}


============================== 00:28:26.884881 | 7e055841-b1b7-47bd-b5b3-dfae07a27a1c ==============================
[0m00:28:26.884881 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:28:26.886446 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'quiet': 'False'}
[0m00:28:26.930751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e055841-b1b7-47bd-b5b3-dfae07a27a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961893b3d0>]}
[0m00:28:26.944980 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-130tbe0z'
[0m00:28:26.946320 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:28:27.345120 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:28:27.348356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:28:27.450700 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:28:27.461806 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m00:28:27.566174 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m00:28:27.574889 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m00:28:27.682193 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m00:28:27.705399 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:28:30.713511 [info ] [MainThread]: Installed from version 1.1.1
[0m00:28:30.715027 [info ] [MainThread]: Up to date!
[0m00:28:30.716334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7e055841-b1b7-47bd-b5b3-dfae07a27a1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961916ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618fbd6d0>]}
[0m00:28:30.717364 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m00:28:34.007343 [info ] [MainThread]: Installed from version 0.10.1
[0m00:28:34.008836 [info ] [MainThread]: Up to date!
[0m00:28:34.010256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7e055841-b1b7-47bd-b5b3-dfae07a27a1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618922950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961916ecd0>]}
[0m00:28:34.011231 [info ] [MainThread]: Installing calogica/dbt_date
[0m00:28:35.181437 [info ] [MainThread]: Installed from version 0.10.0
[0m00:28:35.182797 [info ] [MainThread]: Up to date!
[0m00:28:35.184010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7e055841-b1b7-47bd-b5b3-dfae07a27a1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96192cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618922950>]}
[0m00:28:35.186613 [debug] [MainThread]: Command `dbt deps` succeeded at 00:28:35.186416 after 8.33 seconds
[0m00:28:35.187680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618e7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961ceaba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961cdf0090>]}
[0m00:28:35.188733 [debug] [MainThread]: Flushing usage events
[0m00:28:48.832819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87910454d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8791060dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790d62110>]}


============================== 00:28:48.838563 | 51da83e3-576c-4994-9433-cb1b8e79ccc7 ==============================
[0m00:28:48.838563 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:28:48.840312 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True'}
[0m00:28:49.386855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51da83e3-576c-4994-9433-cb1b8e79ccc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec12750>]}
[0m00:28:49.406619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51da83e3-576c-4994-9433-cb1b8e79ccc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790f0b450>]}
[0m00:28:49.408029 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:28:49.494246 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:28:49.505296 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:28:49.506731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51da83e3-576c-4994-9433-cb1b8e79ccc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec26190>]}
[0m00:28:49.667326 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading autotrader_toyota_dbt: analytics/schema.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     description: obt creation for dashboard use
    6  |     columns:
    7  |       - name: avg_price_national
    8  |       description: avg price nationally for a given car model, year combination
    9  |       tests:
    10 |        - not_null
    11 |       - name: avg_price_state
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 8, column 7
[0m00:28:49.669017 [debug] [MainThread]: Command `dbt run` failed at 00:28:49.668834 after 0.86 seconds
[0m00:28:49.669980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790cedfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8791062750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ec04950>]}
[0m00:28:49.670946 [debug] [MainThread]: Flushing usage events
[0m00:33:00.911156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ae70d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6acedc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6afac990>]}


============================== 00:33:00.915801 | 1b915581-48d9-4ab7-ade0-14073a6ae18f ==============================
[0m00:33:00.915801 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:33:00.917204 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'static_parser': 'True'}
[0m00:33:01.396318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b915581-48d9-4ab7-ade0-14073a6ae18f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a68a12350>]}
[0m00:33:01.412689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b915581-48d9-4ab7-ade0-14073a6ae18f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a689f7890>]}
[0m00:33:01.414402 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:33:01.478587 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:33:01.489631 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:33:01.490740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b915581-48d9-4ab7-ade0-14073a6ae18f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a68a34250>]}
[0m00:33:01.610232 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading autotrader_toyota_dbt: staging/schema.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |       - not_null
    8  |     columns:
    9  |       - name: date
    10 |       description: date listing was extracted
    11 |       tests:
    12 |        - dbt_expectations.expect_column_values_to_be_of_type:
    13 |           column_type: date
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 9, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 10, column 7
[0m00:33:01.611760 [debug] [MainThread]: Command `dbt run` failed at 00:33:01.611579 after 0.72 seconds
[0m00:33:01.612586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ab19d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a68a47d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a68a10bd0>]}
[0m00:33:01.613375 [debug] [MainThread]: Flushing usage events
[0m00:38:42.348508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f5c8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f86ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f57e110>]}


============================== 00:38:42.355498 | 7287083b-5358-450b-960d-34a7ed16a785 ==============================
[0m00:38:42.355498 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:38:42.356822 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager'}
[0m00:38:42.969165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7287083b-5358-450b-960d-34a7ed16a785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d427390>]}
[0m00:38:42.986081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7287083b-5358-450b-960d-34a7ed16a785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d4634d0>]}
[0m00:38:42.987505 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:38:43.061390 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:38:43.073982 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:38:43.075338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7287083b-5358-450b-960d-34a7ed16a785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d45ce50>]}
[0m00:38:46.496864 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m00:38:46.510177 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m00:38:46.515271 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m00:38:46.519540 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m00:38:46.528809 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m00:38:46.531068 [debug] [MainThread]: 1603: static parser failed on warehouse/date_dim.sql
[0m00:38:46.536453 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/date_dim.sql
[0m00:38:46.538875 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m00:38:46.545497 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m00:38:46.548012 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m00:38:46.553805 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m00:38:46.685344 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named date_dim. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for date_dim in one of these files:
   - models/warehouse/schema.yml
  models/analytics/schema.yml
[0m00:38:46.687078 [debug] [MainThread]: Command `dbt run` failed at 00:38:46.686928 after 4.36 seconds
[0m00:38:46.688138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f429fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703f59e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703c09d850>]}
[0m00:38:46.689187 [debug] [MainThread]: Flushing usage events
[0m00:40:04.312557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304027cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30405efb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3040a339d0>]}


============================== 00:40:04.317693 | 63400550-76b6-4d2f-b53a-8f039e461e9a ==============================
[0m00:40:04.317693 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:40:04.319061 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None'}
[0m00:40:04.772064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303e58cad0>]}
[0m00:40:04.788024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304017c6d0>]}
[0m00:40:04.789297 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:40:04.853812 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:40:04.865494 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:40:04.866534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303e5ae450>]}
[0m00:40:08.265837 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m00:40:08.279645 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m00:40:08.284554 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m00:40:08.288628 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m00:40:08.298216 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m00:40:08.300641 [debug] [MainThread]: 1603: static parser failed on warehouse/date_dim.sql
[0m00:40:08.306661 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/date_dim.sql
[0m00:40:08.309542 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m00:40:08.315837 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m00:40:08.318290 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m00:40:08.323920 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m00:40:08.552460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303e46b6d0>]}
[0m00:40:08.574620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303e394850>]}
[0m00:40:08.575774 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:40:08.576944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63400550-76b6-4d2f-b53a-8f039e461e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303e47e550>]}
[0m00:40:08.579278 [info ] [MainThread]: 
[0m00:40:08.580751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:40:08.582505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m00:40:08.583356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:08.584942 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/usr/local/airflow/include/gcp/service_account.json''
[0m00:40:08.586767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:08.587687 [debug] [MainThread]: Connection 'list_autotrader-toyota-dashboard' was properly closed.
[0m00:40:08.588574 [info ] [MainThread]: 
[0m00:40:08.589779 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m00:40:08.591182 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/usr/local/airflow/include/gcp/service_account.json'
[0m00:40:08.592903 [debug] [MainThread]: Command `dbt run` failed at 00:40:08.592683 after 4.30 seconds
[0m00:40:08.594074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3040a1ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304008d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30405efc10>]}
[0m00:40:08.595190 [debug] [MainThread]: Flushing usage events
[0m00:42:45.616044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba00bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba94b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba562f90>]}


============================== 00:42:45.620702 | 8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5 ==============================
[0m00:42:45.620702 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:42:45.622058 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m00:42:46.066485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba987950>]}
[0m00:42:46.082958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db835d910>]}
[0m00:42:46.084497 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:42:46.150631 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:42:46.181487 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:42:46.182945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db819cb50>]}
[0m00:42:49.653180 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m00:42:49.666401 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m00:42:49.670943 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m00:42:49.675373 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m00:42:49.684462 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m00:42:49.686831 [debug] [MainThread]: 1603: static parser failed on warehouse/date_dim.sql
[0m00:42:49.693282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/date_dim.sql
[0m00:42:49.695655 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m00:42:49.701815 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m00:42:49.704714 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m00:42:49.710347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m00:42:49.950378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db8246790>]}
[0m00:42:49.974949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db8074510>]}
[0m00:42:49.976145 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:42:49.977256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7c9910-f33a-41cd-bd36-4f2bdb98a6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db81c1290>]}
[0m00:42:49.979347 [info ] [MainThread]: 
[0m00:42:49.980753 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:42:49.982459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m00:42:49.983350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:51.543804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:51.545229 [debug] [MainThread]: Connection 'list_autotrader-toyota-dashboard' was properly closed.
[0m00:42:51.546320 [info ] [MainThread]: 
[0m00:42:51.547464 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m00:42:51.548611 [error] [MainThread]: Encountered an error:

[0m00:42:51.565548 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 405, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 545, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m00:42:51.567441 [debug] [MainThread]: Command `dbt run` failed at 00:42:51.567270 after 5.97 seconds
[0m00:42:51.568350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbb7f0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba6a62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba574f10>]}
[0m00:42:51.569188 [debug] [MainThread]: Flushing usage events
[0m00:47:08.512919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2e27d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2e087d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab267d850>]}


============================== 00:47:08.518477 | 4e55440b-7d55-485e-9f39-d00ec71847b4 ==============================
[0m00:47:08.518477 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:47:08.519778 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False'}
[0m00:47:08.552869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e55440b-7d55-485e-9f39-d00ec71847b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2e162d0>]}
[0m00:47:08.557059 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wek948d5'
[0m00:47:08.558128 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:47:08.994108 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:47:08.997046 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:47:09.151221 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:47:09.158881 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m00:47:09.302222 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m00:47:09.309193 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m00:47:09.420197 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m00:47:09.437108 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:47:12.789017 [info ] [MainThread]: Installed from version 1.1.1
[0m00:47:12.790299 [info ] [MainThread]: Up to date!
[0m00:47:12.791497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e55440b-7d55-485e-9f39-d00ec71847b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2693250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab266bb10>]}
[0m00:47:12.792329 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m00:47:16.588677 [info ] [MainThread]: Installed from version 0.10.1
[0m00:47:16.589961 [info ] [MainThread]: Up to date!
[0m00:47:16.590974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e55440b-7d55-485e-9f39-d00ec71847b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2680f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2681a10>]}
[0m00:47:16.591839 [info ] [MainThread]: Installing calogica/dbt_date
[0m00:47:17.776806 [info ] [MainThread]: Installed from version 0.10.0
[0m00:47:17.778184 [info ] [MainThread]: Up to date!
[0m00:47:17.779259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e55440b-7d55-485e-9f39-d00ec71847b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2680f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab2681a10>]}
[0m00:47:17.781246 [debug] [MainThread]: Command `dbt deps` succeeded at 00:47:17.781094 after 9.29 seconds
[0m00:47:17.782171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab6a4f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab6a1c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab68b7dd0>]}
[0m00:47:17.783595 [debug] [MainThread]: Flushing usage events
[0m00:48:13.287774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6367b0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63809d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636b58950>]}


============================== 00:48:13.292353 | 8b5bb19d-997d-495f-bfc2-3fcd530d29e6 ==============================
[0m00:48:13.292353 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:48:13.293638 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m00:48:13.850901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6346fce10>]}
[0m00:48:13.867231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6346fe690>]}
[0m00:48:13.868705 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:48:13.935421 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:48:16.377050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:48:16.377915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:48:16.385095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd635522d50>]}
[0m00:48:16.408878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd634712410>]}
[0m00:48:16.410076 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:48:16.411218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6397b8290>]}
[0m00:48:16.413331 [info ] [MainThread]: 
[0m00:48:16.414965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:48:16.416749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m00:48:16.417607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:17.944358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now create_autotrader-toyota-dashboard_autotrader_staging)
[0m00:48:17.946019 [debug] [ThreadPool]: Creating schema "database: "autotrader-toyota-dashboard"
schema: "autotrader_staging"
"
[0m00:48:17.957123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:17.960848 [debug] [ThreadPool]: On create_autotrader-toyota-dashboard_autotrader_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "connection_name": "create_autotrader-toyota-dashboard_autotrader_staging"} */
create schema if not exists `autotrader-toyota-dashboard`.`autotrader_staging`
  
[0m00:48:24.202627 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:fe5ff6c0-5ece-4626-8f4b-2888afb8d8e7&page=queryresults
[0m00:48:24.206341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m00:48:24.207276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:25.106264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m00:48:25.107494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:26.442361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m00:48:26.443693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:27.686180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63452d890>]}
[0m00:48:27.688035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:48:27.689155 [info ] [MainThread]: 
[0m00:48:27.706506 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m00:48:27.707940 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m00:48:27.709244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_staging)
[0m00:48:27.710058 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m00:48:27.718491 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m00:48:27.732377 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 00:48:27.710686 => 00:48:27.731963
[0m00:48:27.733585 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m00:48:27.766769 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m00:48:27.781439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:27.786245 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    price is not null 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) != 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    car_model = upper(car_model),
    type = upper(type),
    suburb = upper(suburb),
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    price = replace(replace(price, '$', ''), ',', ''),
    odometer = replace(replace(odometer, 'km', ''), ',', ''),
    year,
    car_model = case
    when car_model like '%LAND CRUISER%' then regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2')
    else replace(car_model, type, '')
    end,
    type = case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end,
    suburb = ltrim(replace(replace(suburb, '(', ''), ')', '')),
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m00:48:28.579488 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "price" at [17:5]')
[0m00:48:29.402422 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d7c61bba-eccc-4bd3-a0d9-da5c1b578780&page=queryresults
[0m00:48:29.404318 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 00:48:27.734392 => 00:48:29.403957
[0m00:48:29.413325 [debug] [Thread-1 (]: Database Error in model listings_staging (models/staging/listings_staging.sql)
  Syntax error: Expected ")" but got identifier "price" at [17:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m00:48:29.414716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6344cba50>]}
[0m00:48:29.416150 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model autotrader_staging.listings_staging ...... [[31mERROR[0m in 1.71s]
[0m00:48:29.417719 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m00:48:29.418888 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m00:48:29.420069 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m00:48:29.421407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m00:48:29.422251 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m00:48:29.430025 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m00:48:29.437014 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 00:48:29.423071 => 00:48:29.436576
[0m00:48:29.438070 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m00:48:29.451369 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m00:48:29.459246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:29.463647 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      select 
distinct
listings_raw.suburb as suburb,
listings_raw.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
`autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw` listings_raw
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on listings_raw.suburb = australian_suburbs.suburb
and listings_raw.state = australian_suburbs.state
    );
  
[0m00:48:33.319505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:23e95272-bc2d-4d67-82ad-cea1c5bb9e02&page=queryresults
[0m00:48:33.335758 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 00:48:29.438864 => 00:48:33.335545
[0m00:48:33.337098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b5bb19d-997d-495f-bfc2-3fcd530d29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd634326e10>]}
[0m00:48:33.338203 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (7.0 rows, 801.2 KiB processed)[0m in 3.92s]
[0m00:48:33.339718 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m00:48:33.342278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:33.343020 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m00:48:33.343721 [info ] [MainThread]: 
[0m00:48:33.344522 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 16.93 seconds (16.93s).
[0m00:48:33.345681 [debug] [MainThread]: Command end result
[0m00:48:33.367063 [info ] [MainThread]: 
[0m00:48:33.368272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:48:33.369177 [info ] [MainThread]: 
[0m00:48:33.370016 [error] [MainThread]: [33mDatabase Error in model listings_staging (models/staging/listings_staging.sql)[0m
[0m00:48:33.371100 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "price" at [17:5]
[0m00:48:33.372201 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m00:48:33.373391 [info ] [MainThread]: 
[0m00:48:33.374699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:48:33.375971 [debug] [MainThread]: Command `dbt run` failed at 00:48:33.375818 after 20.11 seconds
[0m00:48:33.376931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63518e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636849210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63699c410>]}
[0m00:48:33.377771 [debug] [MainThread]: Flushing usage events
[0m00:55:29.084776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ea744f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ea7468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ea1dd2d0>]}


============================== 00:55:29.089443 | c8de0e6b-4e74-47d1-911e-91024e5b7e11 ==============================
[0m00:55:29.089443 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:55:29.090901 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m00:55:29.526199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e9ca0790>]}
[0m00:55:29.542207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e9daeed0>]}
[0m00:55:29.543629 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:55:29.607459 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:55:31.853862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:31.854865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:31.862387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e804e6d0>]}
[0m00:55:31.884999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e8113e90>]}
[0m00:55:31.886321 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:55:31.887622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ed36bd50>]}
[0m00:55:31.889882 [info ] [MainThread]: 
[0m00:55:31.891362 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:31.893161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m00:55:31.894023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:33.371689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now create_autotrader-toyota-dashboard_autotrader_staging)
[0m00:55:33.373426 [debug] [ThreadPool]: Creating schema "database: "autotrader-toyota-dashboard"
schema: "autotrader_staging"
"
[0m00:55:33.383617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:33.387922 [debug] [ThreadPool]: On create_autotrader-toyota-dashboard_autotrader_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "connection_name": "create_autotrader-toyota-dashboard_autotrader_staging"} */
create schema if not exists `autotrader-toyota-dashboard`.`autotrader_staging`
  
[0m00:55:39.411612 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c7e9572d-4331-4a14-9b77-6d92861a293b&page=queryresults
[0m00:55:39.415418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m00:55:39.416784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:40.849005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m00:55:40.850244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:41.721383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m00:55:41.722919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:43.052547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ead41210>]}
[0m00:55:43.054418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:43.055596 [info ] [MainThread]: 
[0m00:55:43.071300 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m00:55:43.073097 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m00:55:43.074664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_staging)
[0m00:55:43.075687 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m00:55:43.083864 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m00:55:43.092926 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 00:55:43.076484 => 00:55:43.092330
[0m00:55:43.094028 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m00:55:43.127426 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m00:55:43.134738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:43.138445 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    price is not null 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) != 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    car_model = upper(car_model),
    type = upper(type),
    suburb = upper(suburb),
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    price = replace(replace(price, '$', ''), ',', ''),
    odometer = replace(replace(odometer, 'km', ''), ',', ''),
    year,
    car_model = case
    when car_model like '%LAND CRUISER%' then regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2')
    else replace(car_model, type, '')
    end,
    type = case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end,
    suburb = ltrim(replace(replace(suburb, '(', ''), ')', '')),
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m00:55:44.058588 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "price" at [17:5]')
[0m00:55:44.823376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:060a6e8f-cbe7-41f9-bd6b-d6919af09d1c&page=queryresults
[0m00:55:44.825248 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 00:55:43.094741 => 00:55:44.824961
[0m00:55:44.830751 [debug] [Thread-1 (]: Database Error in model listings_staging (models/staging/listings_staging.sql)
  Syntax error: Expected ")" but got identifier "price" at [17:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m00:55:44.831957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e81abd90>]}
[0m00:55:44.833377 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model autotrader_staging.listings_staging ...... [[31mERROR[0m in 1.76s]
[0m00:55:44.834721 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m00:55:44.835888 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m00:55:44.837015 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m00:55:44.838669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m00:55:44.839554 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m00:55:44.846023 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m00:55:44.854520 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 00:55:44.840242 => 00:55:44.854074
[0m00:55:44.855464 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m00:55:44.869142 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m00:55:44.876837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:44.881105 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      select 
distinct
listings_raw.suburb as suburb,
listings_raw.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
`autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw` listings_raw
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on listings_raw.suburb = australian_suburbs.suburb
and listings_raw.state = australian_suburbs.state
    );
  
[0m00:55:48.636074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6120e6be-8266-4878-b389-f612208730bc&page=queryresults
[0m00:55:48.653207 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 00:55:44.856108 => 00:55:48.652952
[0m00:55:48.654905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de0e6b-4e74-47d1-911e-91024e5b7e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ea431bd0>]}
[0m00:55:48.656176 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (7.0 rows, 801.2 KiB processed)[0m in 3.82s]
[0m00:55:48.657606 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m00:55:48.660149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:48.660924 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m00:55:48.661699 [info ] [MainThread]: 
[0m00:55:48.662627 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 16.77 seconds (16.77s).
[0m00:55:48.663921 [debug] [MainThread]: Command end result
[0m00:55:48.686390 [info ] [MainThread]: 
[0m00:55:48.687638 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:55:48.688759 [info ] [MainThread]: 
[0m00:55:48.689807 [error] [MainThread]: [33mDatabase Error in model listings_staging (models/staging/listings_staging.sql)[0m
[0m00:55:48.690947 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "price" at [17:5]
[0m00:55:48.691898 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m00:55:48.692772 [info ] [MainThread]: 
[0m00:55:48.693771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:55:48.694966 [debug] [MainThread]: Command `dbt run` failed at 00:55:48.694834 after 19.63 seconds
[0m00:55:48.695877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e9d9f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ee2e8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ee31b850>]}
[0m00:55:48.696726 [debug] [MainThread]: Flushing usage events
[0m01:07:05.397428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7ba01ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7ba01b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7bcee910>]}


============================== 01:07:05.402523 | d6e556a5-b35c-4b81-b41b-dfb0632a840c ==============================
[0m01:07:05.402523 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:07:05.403885 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m01:07:05.903815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e796b1890>]}
[0m01:07:05.920813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7ba02c10>]}
[0m01:07:05.922075 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:07:05.988051 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:07:08.300413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:07:08.301982 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/listings_staging.sql
[0m01:07:08.328820 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m01:07:08.418557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e79795d10>]}
[0m01:07:08.441567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e794cac90>]}
[0m01:07:08.442673 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m01:07:08.443753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7e9343d0>]}
[0m01:07:08.445811 [info ] [MainThread]: 
[0m01:07:08.447274 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:07:08.449005 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m01:07:08.449786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:10.081325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m01:07:10.082612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:10.983423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m01:07:10.984889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:12.262817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m01:07:12.264093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:13.460775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e79872b10>]}
[0m01:07:13.462906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:13.464333 [info ] [MainThread]: 
[0m01:07:13.482877 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m01:07:13.484600 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m01:07:13.485911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listings_staging)
[0m01:07:13.486746 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m01:07:13.495175 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:07:13.501812 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 01:07:13.487467 => 01:07:13.501492
[0m01:07:13.502649 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m01:07:13.539311 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:07:13.547445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:13.551641 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) != 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    car_model = upper(car_model),
    type = upper(type),
    suburb = upper(suburb),
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    price = replace(replace(price, '$', ''), ',', ''),
    odometer = replace(replace(odometer, 'km', ''), ',', ''),
    year,
    car_model = case
    when car_model like '%LAND CRUISER%' then regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2')
    else replace(car_model, type, '')
    end,
    type = case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end,
    suburb = ltrim(replace(replace(suburb, '(', ''), ')', '')),
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m01:07:15.378707 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: car_model at [46:5]')
[0m01:07:16.427083 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:08581402-d789-4844-a323-505f36a5d966&page=queryresults
[0m01:07:16.429117 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 01:07:13.503260 => 01:07:16.428693
[0m01:07:16.436935 [debug] [Thread-1 (]: Database Error in model listings_staging (models/staging/listings_staging.sql)
  Unrecognized name: car_model at [46:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:07:16.438152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e795fa050>]}
[0m01:07:16.439321 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model autotrader_staging.listings_staging ...... [[31mERROR[0m in 2.95s]
[0m01:07:16.440449 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m01:07:16.441561 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m01:07:16.442675 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m01:07:16.444048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m01:07:16.444973 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m01:07:16.452054 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:07:16.460127 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 01:07:16.445653 => 01:07:16.459719
[0m01:07:16.461078 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m01:07:16.464530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:17.342526 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:07:17.350944 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      select 
distinct
listings_raw.suburb as suburb,
listings_raw.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
`autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw` listings_raw
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on listings_raw.suburb = australian_suburbs.suburb
and listings_raw.state = australian_suburbs.state
    );
  
[0m01:07:19.814320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:7369b9c0-9149-4923-8526-95cda1f51bad&page=queryresults
[0m01:07:19.832474 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 01:07:16.461712 => 01:07:19.832238
[0m01:07:19.833918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6e556a5-b35c-4b81-b41b-dfb0632a840c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e79776990>]}
[0m01:07:19.835011 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (7.0 rows, 801.2 KiB processed)[0m in 3.39s]
[0m01:07:19.836479 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m01:07:19.839058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:19.839742 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m01:07:19.840481 [info ] [MainThread]: 
[0m01:07:19.841364 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.39 seconds (11.39s).
[0m01:07:19.842620 [debug] [MainThread]: Command end result
[0m01:07:19.871927 [info ] [MainThread]: 
[0m01:07:19.873147 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:07:19.874111 [info ] [MainThread]: 
[0m01:07:19.875002 [error] [MainThread]: [33mDatabase Error in model listings_staging (models/staging/listings_staging.sql)[0m
[0m01:07:19.875925 [error] [MainThread]:   Unrecognized name: car_model at [46:5]
[0m01:07:19.876846 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:07:19.877713 [info ] [MainThread]: 
[0m01:07:19.878580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:07:19.879946 [debug] [MainThread]: Command `dbt run` failed at 01:07:19.879680 after 14.50 seconds
[0m01:07:19.881020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7b356750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7bb91bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7bd13810>]}
[0m01:07:19.881896 [debug] [MainThread]: Flushing usage events
[0m01:12:52.575318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b557e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b29d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b592650>]}


============================== 01:12:52.580222 | 6e39e62e-b973-4c29-8a37-7271db97edf8 ==============================
[0m01:12:52.580222 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:12:52.581492 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'version_check': 'True'}
[0m01:12:53.022782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ab0cc50>]}
[0m01:12:53.039849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b29ffd0>]}
[0m01:12:53.041308 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:12:53.106495 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:12:55.441266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:12:55.442759 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/listings_staging.sql
[0m01:12:55.468466 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m01:12:55.556859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778e65fd0>]}
[0m01:12:55.580825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778cad610>]}
[0m01:12:55.581958 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m01:12:55.583049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77e1d8050>]}
[0m01:12:55.585164 [info ] [MainThread]: 
[0m01:12:55.586531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:12:55.588158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m01:12:55.588929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:57.053723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m01:12:57.055146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:58.366626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m01:12:58.367970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:59.776238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m01:12:59.777303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:00.596118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77cb3c290>]}
[0m01:13:00.597860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:13:00.598926 [info ] [MainThread]: 
[0m01:13:00.615600 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m01:13:00.617095 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m01:13:00.618411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listings_staging)
[0m01:13:00.619282 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m01:13:00.628371 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:13:00.635128 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 01:13:00.619974 => 01:13:00.634805
[0m01:13:00.636138 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m01:13:00.673892 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:13:00.681644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:00.685905 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) != 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    car_model = upper(car_model),
    type = upper(type),
    suburb = upper(suburb),
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    price = replace(replace(price, '$', ''), ',', ''),
    odometer = replace(replace(odometer, 'km', ''), ',', ''),
    year,
    case
    when car_model like '%LAND CRUISER%' then regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    suburb = ltrim(replace(replace(suburb, '(', ''), ')', '')),
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m01:13:02.102594 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: car_model at [47:10]')
[0m01:13:04.702450 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:5a4f2dd6-c432-46d8-85fc-344e3722adae&page=queryresults
[0m01:13:04.704410 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 01:13:00.636897 => 01:13:04.704046
[0m01:13:04.710254 [debug] [Thread-1 (]: Database Error in model listings_staging (models/staging/listings_staging.sql)
  Unrecognized name: car_model at [47:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:13:04.711429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778cda010>]}
[0m01:13:04.712824 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model autotrader_staging.listings_staging ...... [[31mERROR[0m in 4.09s]
[0m01:13:04.714098 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m01:13:04.715167 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m01:13:04.716340 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m01:13:04.717822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m01:13:04.718609 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m01:13:04.725655 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:13:04.733517 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 01:13:04.719295 => 01:13:04.733139
[0m01:13:04.734545 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m01:13:04.738473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:05.669574 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:13:05.677802 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      select 
distinct
listings_raw.suburb as suburb,
listings_raw.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
`autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw` listings_raw
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on listings_raw.suburb = australian_suburbs.suburb
and listings_raw.state = australian_suburbs.state
    );
  
[0m01:13:09.118504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:b86fdbde-1398-4123-ba76-04fe2df07e6a&page=queryresults
[0m01:13:09.136650 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 01:13:04.735575 => 01:13:09.136418
[0m01:13:09.138134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e39e62e-b973-4c29-8a37-7271db97edf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778cad610>]}
[0m01:13:09.139302 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (7.0 rows, 801.2 KiB processed)[0m in 4.42s]
[0m01:13:09.140842 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m01:13:09.143334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:09.144102 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m01:13:09.144879 [info ] [MainThread]: 
[0m01:13:09.145748 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.56 seconds (13.56s).
[0m01:13:09.147142 [debug] [MainThread]: Command end result
[0m01:13:09.175614 [info ] [MainThread]: 
[0m01:13:09.177395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:13:09.178855 [info ] [MainThread]: 
[0m01:13:09.180059 [error] [MainThread]: [33mDatabase Error in model listings_staging (models/staging/listings_staging.sql)[0m
[0m01:13:09.181059 [error] [MainThread]:   Unrecognized name: car_model at [47:10]
[0m01:13:09.181940 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:13:09.182853 [info ] [MainThread]: 
[0m01:13:09.183944 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:13:09.185136 [debug] [MainThread]: Command `dbt run` failed at 01:13:09.185002 after 16.63 seconds
[0m01:13:09.185997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b5a3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77ac1a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b557f10>]}
[0m01:13:09.186839 [debug] [MainThread]: Flushing usage events
[0m01:18:06.689878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25586c4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2559053f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2558c35990>]}


============================== 01:18:06.694575 | 663f1b89-58e4-4bfa-91ae-d13e11a5dbd7 ==============================
[0m01:18:06.694575 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:18:06.695843 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False'}
[0m01:18:07.133983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2556bea710>]}
[0m01:18:07.150596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2556a0e110>]}
[0m01:18:07.151835 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:18:07.216243 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:18:09.443800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:09.445312 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/listings_staging.sql
[0m01:18:09.470407 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m01:18:09.560112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2556aa0650>]}
[0m01:18:09.583486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25568300d0>]}
[0m01:18:09.584716 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m01:18:09.585851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255bca41d0>]}
[0m01:18:09.588043 [info ] [MainThread]: 
[0m01:18:09.589434 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:18:09.591111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m01:18:09.592093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:11.223679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m01:18:11.225007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:12.671392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m01:18:12.672555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:13.515070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m01:18:13.516494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:15.010558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25568dd450>]}
[0m01:18:15.012463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:15.013639 [info ] [MainThread]: 
[0m01:18:15.028936 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m01:18:15.031011 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m01:18:15.032874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_staging)
[0m01:18:15.033781 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m01:18:15.042102 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:18:15.049955 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 01:18:15.034480 => 01:18:15.049452
[0m01:18:15.050994 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m01:18:15.088434 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m01:18:15.095297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:15.099717 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) != 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m01:18:16.967499 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad int64 value: ')
[0m01:18:19.907460 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8aba40c3-b869-48be-bd26-1865c6afc82c&page=queryresults
[0m01:18:19.909082 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 01:18:15.051688 => 01:18:19.908818
[0m01:18:19.913964 [debug] [Thread-1 (]: Database Error in model listings_staging (models/staging/listings_staging.sql)
  Bad int64 value: 
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:18:19.914907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2556affbd0>]}
[0m01:18:19.916171 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model autotrader_staging.listings_staging ...... [[31mERROR[0m in 4.88s]
[0m01:18:19.917358 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m01:18:19.918358 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m01:18:19.919379 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m01:18:19.920819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m01:18:19.921809 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m01:18:19.930544 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:18:19.938716 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 01:18:19.922634 => 01:18:19.938059
[0m01:18:19.940160 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m01:18:19.944078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:20.860163 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m01:18:20.868556 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      select 
distinct
listings_raw.suburb as suburb,
listings_raw.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
`autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw` listings_raw
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on listings_raw.suburb = australian_suburbs.suburb
and listings_raw.state = australian_suburbs.state
    );
  
[0m01:18:23.203043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a0cfb5d6-af12-47b0-96a8-d848988a2b59&page=queryresults
[0m01:18:23.223031 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 01:18:19.941071 => 01:18:23.222772
[0m01:18:23.224774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663f1b89-58e4-4bfa-91ae-d13e11a5dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2556826190>]}
[0m01:18:23.226123 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (7.0 rows, 801.2 KiB processed)[0m in 3.30s]
[0m01:18:23.227759 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m01:18:23.230536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:23.231344 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m01:18:23.232103 [info ] [MainThread]: 
[0m01:18:23.232901 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.64 seconds (13.64s).
[0m01:18:23.234162 [debug] [MainThread]: Command end result
[0m01:18:23.268971 [info ] [MainThread]: 
[0m01:18:23.270203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:18:23.271181 [info ] [MainThread]: 
[0m01:18:23.272163 [error] [MainThread]: [33mDatabase Error in model listings_staging (models/staging/listings_staging.sql)[0m
[0m01:18:23.273231 [error] [MainThread]:   Bad int64 value: 
[0m01:18:23.274220 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/listings_staging.sql
[0m01:18:23.275153 [info ] [MainThread]: 
[0m01:18:23.276158 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:18:23.277454 [debug] [MainThread]: Command `dbt run` failed at 01:18:23.277296 after 16.60 seconds
[0m01:18:23.278413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2559051ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2558bd6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2558bcf610>]}
[0m01:18:23.279259 [debug] [MainThread]: Flushing usage events
[0m02:33:42.545566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaf68d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aafba5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0014890>]}


============================== 02:33:42.551411 | b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35 ==============================
[0m02:33:42.551411 [info ] [MainThread]: Running with dbt=1.5.9
[0m02:33:42.552755 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True'}
[0m02:33:43.087319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aadbd19d0>]}
[0m02:33:43.103864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aadbcf350>]}
[0m02:33:43.105353 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:33:43.169307 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m02:33:45.469500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:33:45.470861 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/locations_staging.sql
[0m02:33:45.471801 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/listings_staging.sql
[0m02:33:45.498905 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m02:33:45.512514 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m02:33:45.610588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aad91cf10>]}
[0m02:33:45.639187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aad807a10>]}
[0m02:33:45.640256 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m02:33:45.641519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab2c74290>]}
[0m02:33:45.643676 [info ] [MainThread]: 
[0m02:33:45.645116 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:33:45.647061 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m02:33:45.647872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:47.257259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now create_autotrader-toyota-dashboard_autotrader_staging)
[0m02:33:47.259292 [debug] [ThreadPool]: Creating schema "database: "autotrader-toyota-dashboard"
schema: "autotrader_staging"
"
[0m02:33:47.271268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:47.275765 [debug] [ThreadPool]: On create_autotrader-toyota-dashboard_autotrader_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "connection_name": "create_autotrader-toyota-dashboard_autotrader_staging"} */
create schema if not exists `autotrader-toyota-dashboard`.`autotrader_staging`
  
[0m02:33:51.833207 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a88a8ab5-7571-4b6d-b8e4-4ce95ffe3eae&page=queryresults
[0m02:33:51.838198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m02:33:51.839312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:52.706548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m02:33:52.707634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:54.134533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m02:33:54.135720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:55.435226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aadbcee50>]}
[0m02:33:55.437352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:33:55.438585 [info ] [MainThread]: 
[0m02:33:55.457053 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m02:33:55.458324 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m02:33:55.459603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_staging)
[0m02:33:55.460609 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m02:33:55.470866 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m02:33:55.478181 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 02:33:55.461745 => 02:33:55.477684
[0m02:33:55.479263 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m02:33:55.513360 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m02:33:55.521527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:33:55.525646 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null
    and price != 'For Auction' 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) = 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then replace(regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2'), '\\1\\2', 'LANDCRUISER')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m02:33:59.219137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4e50cdf4-d0bf-49cb-8e6e-53f84b1f6488&page=queryresults
[0m02:33:59.234950 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 02:33:55.479951 => 02:33:59.234730
[0m02:33:59.236303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aad963190>]}
[0m02:33:59.237351 [info ] [Thread-1 (]: 1 of 2 OK created sql table model autotrader_staging.listings_staging .......... [[32mCREATE TABLE (13.4k rows, 1.2 MiB processed)[0m in 3.78s]
[0m02:33:59.238672 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m02:33:59.239835 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m02:33:59.240637 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m02:33:59.241826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m02:33:59.242561 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m02:33:59.246489 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m02:33:59.255627 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 02:33:59.243147 => 02:33:59.255019
[0m02:33:59.257051 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m02:33:59.274397 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m02:33:59.281751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:33:59.285816 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      with uppercase_suburbs as 
(select 
upper(suburb) as suburb,
state 
from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
where suburb is not null)

select 
distinct
uppercase_suburbs.suburb as suburb,
uppercase_suburbs.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
uppercase_suburbs
join `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs` australian_suburbs
on uppercase_suburbs.suburb = australian_suburbs.suburb
and uppercase_suburbs.state = australian_suburbs.state
    );
  
[0m02:34:02.713817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a465ad04-d96d-45da-8264-c8de2f23bf66&page=queryresults
[0m02:34:02.717127 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 02:33:59.257781 => 02:34:02.716838
[0m02:34:02.718794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa6c5f-c8e2-4495-b3a8-4fd9915c6f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aadaa4e50>]}
[0m02:34:02.720007 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (608.0 rows, 801.2 KiB processed)[0m in 3.48s]
[0m02:34:02.721417 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m02:34:02.724164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:02.724952 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m02:34:02.725743 [info ] [MainThread]: 
[0m02:34:02.726764 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 17.08 seconds (17.08s).
[0m02:34:02.728812 [debug] [MainThread]: Command end result
[0m02:34:02.752781 [info ] [MainThread]: 
[0m02:34:02.754086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:34:02.755017 [info ] [MainThread]: 
[0m02:34:02.756022 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:34:02.757443 [debug] [MainThread]: Command `dbt run` succeeded at 02:34:02.757289 after 20.23 seconds
[0m02:34:02.758457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aafba4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aafe5d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0014ad0>]}
[0m02:34:02.759451 [debug] [MainThread]: Flushing usage events
[0m02:35:43.637146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52cf09b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52d336650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc530b26110>]}


============================== 02:35:43.641733 | 7442e353-e9a0-45aa-8114-7da50dbfcb4f ==============================
[0m02:35:43.641733 [info ] [MainThread]: Running with dbt=1.5.9
[0m02:35:43.643107 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m02:35:44.098590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52c8b0c50>]}
[0m02:35:44.114552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52c8a3950>]}
[0m02:35:44.115867 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:35:44.182988 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m02:35:46.446805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:46.447713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:46.454803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52accefd0>]}
[0m02:35:46.476924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52ad060d0>]}
[0m02:35:46.478078 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m02:35:46.479289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52ff7c050>]}
[0m02:35:46.481602 [info ] [MainThread]: 
[0m02:35:46.483173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:35:46.485149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_warehouse'
[0m02:35:46.485926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:48.035126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m02:35:48.036567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.235578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m02:35:49.236845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:50.097278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7442e353-e9a0-45aa-8114-7da50dbfcb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52ad061d0>]}
[0m02:35:50.099062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:50.100156 [info ] [MainThread]: 
[0m02:35:50.118901 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:35:50.120407 [info ] [Thread-1 (]: 1 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [RUN]
[0m02:35:50.122075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d)
[0m02:35:50.123001 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:35:50.141836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.963714 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m02:35:50.975751 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (compile): 02:35:50.123921 => 02:35:50.975265
[0m02:35:50.976877 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:35:50.996448 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m02:35:51.009568 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DATE'
            and
            relation_column_type not in ('DATE')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:35:59.428417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:686dfe01-e97a-4f06-a4f9-2093154fe2ba&page=queryresults
[0m02:35:59.431348 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (execute): 02:35:50.977638 => 02:35:59.431076
[0m02:35:59.433224 [info ] [Thread-1 (]: 1 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [[32mPASS[0m in 9.31s]
[0m02:35:59.434924 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:35:59.436374 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:35:59.437412 [info ] [Thread-1 (]: 2 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [RUN]
[0m02:35:59.438816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753)
[0m02:35:59.439855 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:35:59.447066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:00.288140 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m02:36:00.295919 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (compile): 02:35:59.440732 => 02:36:00.295549
[0m02:36:00.296953 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:36:00.309182 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m02:36:00.317048 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ODOMETER'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:36:01.641959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:002bf882-4e66-471e-8fa5-9ef20a2e484d&page=queryresults
[0m02:36:01.643548 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (execute): 02:36:00.297733 => 02:36:01.643259
[0m02:36:01.644949 [info ] [Thread-1 (]: 2 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [[32mPASS[0m in 2.21s]
[0m02:36:01.646385 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:36:01.647773 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:36:01.648832 [info ] [Thread-1 (]: 3 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [RUN]
[0m02:36:01.650130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7)
[0m02:36:01.650969 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:36:01.657047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.509947 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m02:36:02.526668 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (compile): 02:36:01.651628 => 02:36:02.526243
[0m02:36:02.527794 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:36:02.531953 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m02:36:02.539720 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:36:03.664610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:876f05cf-bd58-409c-898d-01ed3c38fd4c&page=queryresults
[0m02:36:03.666233 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (execute): 02:36:02.528642 => 02:36:03.665963
[0m02:36:03.667667 [info ] [Thread-1 (]: 3 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [[32mPASS[0m in 2.02s]
[0m02:36:03.669003 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:36:03.670144 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:36:03.671249 [info ] [Thread-1 (]: 4 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [RUN]
[0m02:36:03.672589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3)
[0m02:36:03.673452 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:36:03.681258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:04.529128 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m02:36:04.538052 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (compile): 02:36:03.674101 => 02:36:04.537705
[0m02:36:04.538991 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:36:04.542601 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m02:36:04.549660 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'YEAR'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:36:05.728440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2635a8be-2690-474b-872b-33eca6751ee5&page=queryresults
[0m02:36:05.730091 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (execute): 02:36:04.539712 => 02:36:05.729790
[0m02:36:05.731602 [info ] [Thread-1 (]: 4 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [[32mPASS[0m in 2.06s]
[0m02:36:05.732917 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:36:05.734238 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:36:05.735240 [info ] [Thread-1 (]: 5 of 7 START test dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [RUN]
[0m02:36:05.736911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece)
[0m02:36:05.738014 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:36:05.750573 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m02:36:05.759378 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (compile): 02:36:05.738819 => 02:36:05.758968
[0m02:36:05.760427 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:36:05.771014 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m02:36:05.778652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:05.782748 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state, latitude, longitude
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    group by suburb, state, latitude, longitude
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:36:07.833190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4769f950-6fb5-498b-8387-9e104487e1ed&page=queryresults
[0m02:36:07.835034 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (execute): 02:36:05.761145 => 02:36:07.834699
[0m02:36:07.836873 [info ] [Thread-1 (]: 5 of 7 PASS dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [[32mPASS[0m in 2.10s]
[0m02:36:07.838395 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:36:07.839574 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b
[0m02:36:07.840538 [info ] [Thread-1 (]: 6 of 7 START test not_null_listings_staging_ ................................... [RUN]
[0m02:36:07.841928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece, now test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b)
[0m02:36:07.842833 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b
[0m02:36:07.854530 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b"
[0m02:36:07.863091 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b (compile): 02:36:07.843675 => 02:36:07.862636
[0m02:36:07.864121 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b
[0m02:36:07.867858 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b"
[0m02:36:07.875734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:07.879808 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where  is null



      
    ) dbt_internal_test
[0m02:36:08.687965 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]')
[0m02:36:09.266672 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:e97c4eaa-35ec-40c8-87d1-f0b783ab1a1c&page=queryresults
[0m02:36:09.268420 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b (execute): 02:36:07.864832 => 02:36:09.268137
[0m02:36:09.275278 [debug] [Thread-1 (]: Database Error in test not_null_listings_staging_ (models/staging/schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/not_null_listings_staging_.sql
[0m02:36:09.276616 [error] [Thread-1 (]: 6 of 7 ERROR not_null_listings_staging_ ........................................ [[31mERROR[0m in 1.43s]
[0m02:36:09.277976 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b
[0m02:36:09.279063 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861
[0m02:36:09.280103 [info ] [Thread-1 (]: 7 of 7 START test not_null_locations_staging_ .................................. [RUN]
[0m02:36:09.281465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_.3bffc9621b, now test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861)
[0m02:36:09.282584 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861
[0m02:36:09.288605 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861"
[0m02:36:09.304420 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861 (compile): 02:36:09.283361 => 02:36:09.303997
[0m02:36:09.305323 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861
[0m02:36:09.308951 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861"
[0m02:36:09.317092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:09.321310 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
where  is null



      
    ) dbt_internal_test
[0m02:36:10.219266 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]')
[0m02:36:11.014157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:b9b1e90a-4d58-41b6-b4f9-1433d68a1677&page=queryresults
[0m02:36:11.015999 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861 (execute): 02:36:09.306030 => 02:36:11.015701
[0m02:36:11.019845 [debug] [Thread-1 (]: Database Error in test not_null_locations_staging_ (models/staging/schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/not_null_locations_staging_.sql
[0m02:36:11.021028 [error] [Thread-1 (]: 7 of 7 ERROR not_null_locations_staging_ ....................................... [[31mERROR[0m in 1.74s]
[0m02:36:11.022392 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861
[0m02:36:11.025013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:11.025965 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.not_null_locations_staging_.3193589861' was properly closed.
[0m02:36:11.026781 [info ] [MainThread]: 
[0m02:36:11.027754 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 24.54 seconds (24.54s).
[0m02:36:11.030285 [debug] [MainThread]: Command end result
[0m02:36:11.056443 [info ] [MainThread]: 
[0m02:36:11.057704 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:36:11.058653 [info ] [MainThread]: 
[0m02:36:11.059506 [error] [MainThread]: [33mDatabase Error in test not_null_listings_staging_ (models/staging/schema.yml)[0m
[0m02:36:11.060360 [error] [MainThread]:   Syntax error: SELECT list must not be empty at [14:1]
[0m02:36:11.061191 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/not_null_listings_staging_.sql
[0m02:36:11.062018 [info ] [MainThread]: 
[0m02:36:11.062848 [error] [MainThread]: [33mDatabase Error in test not_null_locations_staging_ (models/staging/schema.yml)[0m
[0m02:36:11.063646 [error] [MainThread]:   Syntax error: SELECT list must not be empty at [14:1]
[0m02:36:11.064420 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/not_null_locations_staging_.sql
[0m02:36:11.065351 [info ] [MainThread]: 
[0m02:36:11.066382 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m02:36:11.067529 [debug] [MainThread]: Command `dbt test` failed at 02:36:11.067398 after 27.45 seconds
[0m02:36:11.068442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52d1dd210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52accf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52d491cd0>]}
[0m02:36:11.069269 [debug] [MainThread]: Flushing usage events
[0m02:54:53.850395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5665990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5666cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5666250>]}


============================== 02:54:53.855301 | 1b4508c3-c072-461a-9157-05d855eb914e ==============================
[0m02:54:53.855301 [info ] [MainThread]: Running with dbt=1.5.9
[0m02:54:53.856668 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True'}
[0m02:54:54.305075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5973a10>]}
[0m02:54:54.321282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d57ac290>]}
[0m02:54:54.322703 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:54:54.392814 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m02:54:56.658248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:56.660125 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/schema.yml
[0m02:54:56.686339 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m02:54:56.701239 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m02:54:56.810858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d33b0490>]}
[0m02:54:56.836365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d33adc90>]}
[0m02:54:56.837462 [info ] [MainThread]: Found 7 models, 19 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m02:54:56.838544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d85c41d0>]}
[0m02:54:56.840910 [info ] [MainThread]: 
[0m02:54:56.842318 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:54:56.844304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_warehouse'
[0m02:54:56.845210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:58.549865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m02:54:58.551265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:59.417343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m02:54:59.419063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:00.796767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4508c3-c072-461a-9157-05d855eb914e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d339bad0>]}
[0m02:55:00.798600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:00.799823 [info ] [MainThread]: 
[0m02:55:00.819043 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:55:00.820281 [info ] [Thread-1 (]: 1 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [RUN]
[0m02:55:00.821854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d)
[0m02:55:00.822828 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:55:00.833796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:01.730615 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m02:55:01.739028 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (compile): 02:55:00.823601 => 02:55:01.738646
[0m02:55:01.740066 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:55:01.759295 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m02:55:01.767270 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DATE'
            and
            relation_column_type not in ('DATE')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:55:02.984956 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:b66896f4-54e7-45b4-ae94-7a0d0e7f6fe7&page=queryresults
[0m02:55:02.987444 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (execute): 02:55:01.740804 => 02:55:02.987193
[0m02:55:02.988908 [info ] [Thread-1 (]: 1 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [[32mPASS[0m in 2.17s]
[0m02:55:02.990223 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m02:55:02.991315 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:55:02.992194 [info ] [Thread-1 (]: 2 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [RUN]
[0m02:55:02.993498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753)
[0m02:55:02.994302 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:55:03.000310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:03.947804 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m02:55:03.955641 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (compile): 02:55:02.994999 => 02:55:03.955296
[0m02:55:03.956595 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:55:03.960314 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m02:55:03.967216 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ODOMETER'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:55:05.059704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:199f8d8b-a8b8-4efa-a2a9-5bd62f72a8a9&page=queryresults
[0m02:55:05.061601 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (execute): 02:55:03.957354 => 02:55:05.061252
[0m02:55:05.063205 [info ] [Thread-1 (]: 2 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [[32mPASS[0m in 2.07s]
[0m02:55:05.064907 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m02:55:05.066100 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:55:05.067133 [info ] [Thread-1 (]: 3 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [RUN]
[0m02:55:05.068644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7)
[0m02:55:05.069567 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:55:05.076975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:05.937164 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m02:55:05.945998 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (compile): 02:55:05.070344 => 02:55:05.945666
[0m02:55:05.947010 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:55:05.950620 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m02:55:05.957677 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:55:07.009794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:7a0e28c4-2559-47de-ae4e-a35bdd5c8741&page=queryresults
[0m02:55:07.011742 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (execute): 02:55:05.947709 => 02:55:07.011448
[0m02:55:07.013360 [info ] [Thread-1 (]: 3 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [[32mPASS[0m in 1.94s]
[0m02:55:07.014905 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m02:55:07.016263 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:55:07.017342 [info ] [Thread-1 (]: 4 of 7 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [RUN]
[0m02:55:07.018781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3)
[0m02:55:07.019563 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:55:07.025363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:08.131272 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m02:55:08.140142 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (compile): 02:55:07.020245 => 02:55:08.139752
[0m02:55:08.141175 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:55:08.144784 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m02:55:08.151662 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'YEAR'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:55:09.175637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:82c2e9d1-d7e1-44cd-974e-e8c05cb48295&page=queryresults
[0m02:55:09.177411 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (execute): 02:55:08.141880 => 02:55:09.177125
[0m02:55:09.179016 [info ] [Thread-1 (]: 4 of 7 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [[32mPASS[0m in 2.16s]
[0m02:55:09.180725 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m02:55:09.181892 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc
[0m02:55:09.182918 [info ] [Thread-1 (]: 5 of 7 START test dbt_utils_not_null_proportion_listings_staging_1_0 ........... [RUN]
[0m02:55:09.184352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3, now test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc)
[0m02:55:09.185336 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc
[0m02:55:09.191538 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc"
[0m02:55:09.200163 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc (compile): 02:55:09.186088 => 02:55:09.199645
[0m02:55:09.201612 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc
[0m02:55:09.212018 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc"
[0m02:55:09.219954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:09.225635 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      







with validation as (
  select
    
    sum(case when None is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion
  from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
  
),
validation_errors as (
  select
    
    not_null_proportion
  from validation
  where not_null_proportion < 1.0 or not_null_proportion > 1
)
select
  *
from validation_errors


      
    ) dbt_internal_test
[0m02:55:10.249096 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: None at [18:19]')
[0m02:55:10.902924 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:9a925e14-073a-4a2f-a518-12e95ca80534&page=queryresults
[0m02:55:10.905080 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc (execute): 02:55:09.202493 => 02:55:10.904762
[0m02:55:10.910658 [debug] [Thread-1 (]: Database Error in test dbt_utils_not_null_proportion_listings_staging_1_0 (models/staging/schema.yml)
  Unrecognized name: None at [18:19]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/dbt_utils_not_null_proportion_listings_staging_1_0.sql
[0m02:55:10.911961 [error] [Thread-1 (]: 5 of 7 ERROR dbt_utils_not_null_proportion_listings_staging_1_0 ................ [[31mERROR[0m in 1.73s]
[0m02:55:10.913256 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc
[0m02:55:10.914340 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589
[0m02:55:10.915462 [info ] [Thread-1 (]: 6 of 7 START test dbt_utils_not_null_proportion_locations_staging_1_0 .......... [RUN]
[0m02:55:10.916924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_listings_staging_1_0.2290c52ffc, now test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589)
[0m02:55:10.917845 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589
[0m02:55:10.927147 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589"
[0m02:55:10.936204 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589 (compile): 02:55:10.918653 => 02:55:10.935716
[0m02:55:10.937271 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589
[0m02:55:10.941156 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589"
[0m02:55:10.949589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:10.953817 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      







with validation as (
  select
    
    sum(case when None is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion
  from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
  
),
validation_errors as (
  select
    
    not_null_proportion
  from validation
  where not_null_proportion < 1.0 or not_null_proportion > 1
)
select
  *
from validation_errors


      
    ) dbt_internal_test
[0m02:55:11.957230 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: None at [18:19]')
[0m02:55:12.776349 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dbe1365f-5a6c-4caa-9f52-7f9c8ed9ed97&page=queryresults
[0m02:55:12.778102 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589 (execute): 02:55:10.938084 => 02:55:12.777794
[0m02:55:12.782037 [debug] [Thread-1 (]: Database Error in test dbt_utils_not_null_proportion_locations_staging_1_0 (models/staging/schema.yml)
  Unrecognized name: None at [18:19]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/dbt_utils_not_null_proportion_locations_staging_1_0.sql
[0m02:55:12.783116 [error] [Thread-1 (]: 6 of 7 ERROR dbt_utils_not_null_proportion_locations_staging_1_0 ............... [[31mERROR[0m in 1.87s]
[0m02:55:12.784245 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589
[0m02:55:12.785351 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:55:12.786343 [info ] [Thread-1 (]: 7 of 7 START test dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [RUN]
[0m02:55:12.787850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_not_null_proportion_locations_staging_1_0.dd5fb7b589, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece)
[0m02:55:12.788784 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:55:12.797034 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m02:55:12.806377 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (compile): 02:55:12.789540 => 02:55:12.805956
[0m02:55:12.807349 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:55:12.811033 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m02:55:12.818312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:12.821881 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state, latitude, longitude
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    group by suburb, state, latitude, longitude
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:55:14.590296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:663da51d-f134-420b-a20e-a8a9801a96ae&page=queryresults
[0m02:55:14.592306 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (execute): 02:55:12.808032 => 02:55:14.591990
[0m02:55:14.593901 [info ] [Thread-1 (]: 7 of 7 PASS dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [[32mPASS[0m in 1.81s]
[0m02:55:14.595448 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m02:55:14.598442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:14.599379 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece' was properly closed.
[0m02:55:14.600343 [info ] [MainThread]: 
[0m02:55:14.601543 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 17.76 seconds (17.76s).
[0m02:55:14.604251 [debug] [MainThread]: Command end result
[0m02:55:14.632396 [info ] [MainThread]: 
[0m02:55:14.633697 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:55:14.634804 [info ] [MainThread]: 
[0m02:55:14.636014 [error] [MainThread]: [33mDatabase Error in test dbt_utils_not_null_proportion_listings_staging_1_0 (models/staging/schema.yml)[0m
[0m02:55:14.637182 [error] [MainThread]:   Unrecognized name: None at [18:19]
[0m02:55:14.638584 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/dbt_utils_not_null_proportion_listings_staging_1_0.sql
[0m02:55:14.639616 [info ] [MainThread]: 
[0m02:55:14.640567 [error] [MainThread]: [33mDatabase Error in test dbt_utils_not_null_proportion_locations_staging_1_0 (models/staging/schema.yml)[0m
[0m02:55:14.641608 [error] [MainThread]:   Unrecognized name: None at [18:19]
[0m02:55:14.642586 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/schema.yml/dbt_utils_not_null_proportion_locations_staging_1_0.sql
[0m02:55:14.643605 [info ] [MainThread]: 
[0m02:55:14.644760 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m02:55:14.645986 [debug] [MainThread]: Command `dbt test` failed at 02:55:14.645851 after 20.81 seconds
[0m02:55:14.646824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5654750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5971e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d5937d50>]}
[0m02:55:14.647622 [debug] [MainThread]: Flushing usage events
[0m03:09:57.161006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d32898a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d32750e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3276ae10>]}


============================== 03:09:57.166055 | 1d0e324f-f594-402e-824f-6075a48f6e7c ==============================
[0m03:09:57.166055 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:09:57.167515 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m03:09:57.612813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d30429610>]}
[0m03:09:57.629094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d303fe690>]}
[0m03:09:57.630760 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:09:57.694412 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:10:00.075951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:10:00.078504 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/schema.yml
[0m03:10:00.108231 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m03:10:00.124482 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m03:10:00.260126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d300e8f10>]}
[0m03:10:00.287970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3042b2d0>]}
[0m03:10:00.289354 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:10:00.290577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d354dfd10>]}
[0m03:10:00.293966 [info ] [MainThread]: 
[0m03:10:00.295702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:10:00.298010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_warehouse'
[0m03:10:00.299152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:02.083856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:10:02.085116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:02.941181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:10:02.942918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:04.166040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d0e324f-f594-402e-824f-6075a48f6e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d304236d0>]}
[0m03:10:04.168297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:04.169470 [info ] [MainThread]: 
[0m03:10:04.186859 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m03:10:04.188207 [info ] [Thread-1 (]: 1 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [RUN]
[0m03:10:04.189790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d)
[0m03:10:04.190946 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m03:10:04.201315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:05.347704 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m03:10:05.356309 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (compile): 03:10:04.191783 => 03:10:05.355846
[0m03:10:05.357421 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m03:10:05.376937 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"
[0m03:10:05.385343 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DATE'
            and
            relation_column_type not in ('DATE')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:10:06.564515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c48345ee-7db4-488c-934e-b2f0e9b5745a&page=queryresults
[0m03:10:06.567229 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d (execute): 03:10:05.358140 => 03:10:06.566948
[0m03:10:06.568781 [info ] [Thread-1 (]: 1 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date  [[32mPASS[0m in 2.38s]
[0m03:10:06.570474 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d
[0m03:10:06.571655 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m03:10:06.572670 [info ] [Thread-1 (]: 2 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [RUN]
[0m03:10:06.574035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_date__date.8b2339727d, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753)
[0m03:10:06.574905 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m03:10:06.590487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:07.461948 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m03:10:07.470393 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (compile): 03:10:06.575724 => 03:10:07.470079
[0m03:10:07.471273 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m03:10:07.475072 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"
[0m03:10:07.482120 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ODOMETER'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:10:08.526026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c71c6f1c-9743-40a2-9d4b-d94f31b9b5b3&page=queryresults
[0m03:10:08.527566 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753 (execute): 03:10:07.472000 => 03:10:08.527278
[0m03:10:08.528912 [info ] [Thread-1 (]: 2 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64  [[32mPASS[0m in 1.96s]
[0m03:10:08.530191 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753
[0m03:10:08.531223 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m03:10:08.532155 [info ] [Thread-1 (]: 3 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [RUN]
[0m03:10:08.533443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_odometer__int64.b995ec4753, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7)
[0m03:10:08.534210 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m03:10:08.540321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:09.471266 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m03:10:09.479819 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (compile): 03:10:08.534877 => 03:10:09.479449
[0m03:10:09.480657 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m03:10:09.484038 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"
[0m03:10:09.490601 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:10:10.797952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2bde9694-2df6-4535-829e-27ae2aa93b76&page=queryresults
[0m03:10:10.799775 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7 (execute): 03:10:09.481237 => 03:10:10.799500
[0m03:10:10.801338 [info ] [Thread-1 (]: 3 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64  [[32mPASS[0m in 2.27s]
[0m03:10:10.802924 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7
[0m03:10:10.804076 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m03:10:10.805056 [info ] [Thread-1 (]: 4 of 17 START test dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [RUN]
[0m03:10:10.806563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_price__int64.d2d443bdf7, now test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3)
[0m03:10:10.807623 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m03:10:10.814922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:11.719524 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m03:10:11.728079 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (compile): 03:10:10.808586 => 03:10:11.727748
[0m03:10:11.728959 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m03:10:11.738047 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"
[0m03:10:11.745566 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('DATE' as STRING) as relation_column,
            cast('DATE' as STRING) as relation_column_type
        union all
        
        select
            cast('PRICE' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('ODOMETER' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('YEAR' as STRING) as relation_column,
            cast('INT64' as STRING) as relation_column_type
        union all
        
        select
            cast('CAR_MODEL' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('TYPE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('SUBURB' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        union all
        
        select
            cast('STATE' as STRING) as relation_column,
            cast('STRING' as STRING) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'YEAR'
            and
            relation_column_type not in ('INT64')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:10:12.905218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c0213a90-f860-4988-8039-2f3f97a9dcbb&page=queryresults
[0m03:10:12.906974 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3 (execute): 03:10:11.729580 => 03:10:12.906694
[0m03:10:12.908667 [info ] [Thread-1 (]: 4 of 17 PASS dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64  [[32mPASS[0m in 2.10s]
[0m03:10:12.910098 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3
[0m03:10:12.911346 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m03:10:12.912330 [info ] [Thread-1 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [RUN]
[0m03:10:12.913724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_expectations_expect_column_values_to_be_of_type_listings_staging_year__int64.d95ceae5e3, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece)
[0m03:10:12.914616 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m03:10:12.923391 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m03:10:12.932237 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (compile): 03:10:12.915375 => 03:10:12.931775
[0m03:10:12.933133 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m03:10:12.936824 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"
[0m03:10:12.944827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:12.948576 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state, latitude, longitude
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    group by suburb, state, latitude, longitude
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m03:10:15.065519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6c696fc9-8148-4345-b0a5-eee7368b3b6d&page=queryresults
[0m03:10:15.067333 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece (execute): 03:10:12.933717 => 03:10:15.067034
[0m03:10:15.068890 [info ] [Thread-1 (]: 5 of 17 PASS dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude  [[32mPASS[0m in 2.16s]
[0m03:10:15.070454 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece
[0m03:10:15.071598 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24
[0m03:10:15.072581 [info ] [Thread-1 (]: 6 of 17 START test not_null_listings_staging_car_model ......................... [RUN]
[0m03:10:15.073972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_locations_staging_suburb__state__latitude__longitude.12fd0a2ece, now test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24)
[0m03:10:15.074783 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24
[0m03:10:15.083580 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24"
[0m03:10:15.092361 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24 (compile): 03:10:15.075469 => 03:10:15.091892
[0m03:10:15.093467 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24
[0m03:10:15.097210 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24"
[0m03:10:15.105320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:15.109303 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select car_model
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where car_model is null



      
    ) dbt_internal_test
[0m03:10:17.849757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:3390955f-677f-4599-ad0d-089e12330f91&page=queryresults
[0m03:10:17.851623 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24 (execute): 03:10:15.094209 => 03:10:17.851278
[0m03:10:17.853400 [info ] [Thread-1 (]: 6 of 17 PASS not_null_listings_staging_car_model ............................... [[32mPASS[0m in 2.78s]
[0m03:10:17.854940 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24
[0m03:10:17.856177 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c
[0m03:10:17.857136 [info ] [Thread-1 (]: 7 of 17 START test not_null_listings_staging_date .............................. [RUN]
[0m03:10:17.858715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_car_model.3954a28a24, now test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c)
[0m03:10:17.859704 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c
[0m03:10:17.868535 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c"
[0m03:10:17.878280 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c (compile): 03:10:17.860486 => 03:10:17.877849
[0m03:10:17.879447 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c
[0m03:10:17.883421 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c"
[0m03:10:17.891855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:17.896153 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where date is null



      
    ) dbt_internal_test
[0m03:10:19.900196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:cbb15d9f-1fe8-4240-b2c1-e783d0271450&page=queryresults
[0m03:10:19.902201 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c (execute): 03:10:17.880263 => 03:10:19.901858
[0m03:10:19.903729 [info ] [Thread-1 (]: 7 of 17 PASS not_null_listings_staging_date .................................... [[32mPASS[0m in 2.05s]
[0m03:10:19.905283 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c
[0m03:10:19.906399 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32
[0m03:10:19.907368 [info ] [Thread-1 (]: 8 of 17 START test not_null_listings_staging_odometer .......................... [RUN]
[0m03:10:19.908747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_date.d49638702c, now test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32)
[0m03:10:19.909703 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32
[0m03:10:19.923890 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32"
[0m03:10:19.932704 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32 (compile): 03:10:19.910541 => 03:10:19.932258
[0m03:10:19.933715 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32
[0m03:10:19.937356 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32"
[0m03:10:19.945065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:19.949515 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where odometer is null



      
    ) dbt_internal_test
[0m03:10:21.820893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:709a1280-1d02-452f-873d-5a5a2a07d037&page=queryresults
[0m03:10:21.823026 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32 (execute): 03:10:19.934434 => 03:10:21.822644
[0m03:10:21.824734 [info ] [Thread-1 (]: 8 of 17 PASS not_null_listings_staging_odometer ................................ [[32mPASS[0m in 1.92s]
[0m03:10:21.826204 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32
[0m03:10:21.827413 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d
[0m03:10:21.828420 [info ] [Thread-1 (]: 9 of 17 START test not_null_listings_staging_price ............................. [RUN]
[0m03:10:21.829970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_odometer.177fd57b32, now test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d)
[0m03:10:21.830888 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d
[0m03:10:21.840347 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d"
[0m03:10:21.849171 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d (compile): 03:10:21.831747 => 03:10:21.848710
[0m03:10:21.850401 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d
[0m03:10:21.854734 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d"
[0m03:10:21.862339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:21.866802 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where price is null



      
    ) dbt_internal_test
[0m03:10:23.691407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:05cfb4ef-7c55-411e-b5bf-492bc0856f6b&page=queryresults
[0m03:10:23.693194 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d (execute): 03:10:21.851627 => 03:10:23.692888
[0m03:10:23.694877 [info ] [Thread-1 (]: 9 of 17 PASS not_null_listings_staging_price ................................... [[32mPASS[0m in 1.87s]
[0m03:10:23.696478 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d
[0m03:10:23.697562 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5
[0m03:10:23.698454 [info ] [Thread-1 (]: 10 of 17 START test not_null_listings_staging_state ............................ [RUN]
[0m03:10:23.699911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_price.16e2884f2d, now test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5)
[0m03:10:23.700892 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5
[0m03:10:23.707829 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5"
[0m03:10:23.716857 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5 (compile): 03:10:23.702298 => 03:10:23.716341
[0m03:10:23.718187 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5
[0m03:10:23.722450 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5"
[0m03:10:23.729744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:23.734490 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where state is null



      
    ) dbt_internal_test
[0m03:10:25.574909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:cdb67529-734f-4bbe-a9f2-6e0bdffdd6d4&page=queryresults
[0m03:10:25.576903 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5 (execute): 03:10:23.719309 => 03:10:25.576642
[0m03:10:25.578569 [info ] [Thread-1 (]: 10 of 17 PASS not_null_listings_staging_state .................................. [[32mPASS[0m in 1.88s]
[0m03:10:25.580123 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5
[0m03:10:25.581168 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3
[0m03:10:25.582116 [info ] [Thread-1 (]: 11 of 17 START test not_null_listings_staging_suburb ........................... [RUN]
[0m03:10:25.583694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_state.78cd3931e5, now test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3)
[0m03:10:25.584634 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3
[0m03:10:25.590897 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3"
[0m03:10:25.600178 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3 (compile): 03:10:25.585463 => 03:10:25.599701
[0m03:10:25.601407 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3
[0m03:10:25.605183 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3"
[0m03:10:25.620305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:25.624631 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select suburb
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where suburb is null



      
    ) dbt_internal_test
[0m03:10:27.391289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:f223cc9b-fece-4c10-aa97-6b588b2e21e4&page=queryresults
[0m03:10:27.393711 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3 (execute): 03:10:25.602176 => 03:10:27.393320
[0m03:10:27.395378 [info ] [Thread-1 (]: 11 of 17 PASS not_null_listings_staging_suburb ................................. [[32mPASS[0m in 1.81s]
[0m03:10:27.396961 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3
[0m03:10:27.398100 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134
[0m03:10:27.399079 [info ] [Thread-1 (]: 12 of 17 START test not_null_listings_staging_type ............................. [RUN]
[0m03:10:27.400738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_suburb.4b58b979d3, now test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134)
[0m03:10:27.401616 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134
[0m03:10:27.417402 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134"
[0m03:10:27.426028 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134 (compile): 03:10:27.402461 => 03:10:27.425449
[0m03:10:27.427577 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134
[0m03:10:27.431687 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134"
[0m03:10:27.439962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:27.444286 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where type is null



      
    ) dbt_internal_test
[0m03:10:29.394801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:bd4b1ecc-d730-4ded-afc2-d29dd4669051&page=queryresults
[0m03:10:29.396852 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134 (execute): 03:10:27.428464 => 03:10:29.396529
[0m03:10:29.398570 [info ] [Thread-1 (]: 12 of 17 PASS not_null_listings_staging_type ................................... [[32mPASS[0m in 2.00s]
[0m03:10:29.400128 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134
[0m03:10:29.401360 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1
[0m03:10:29.402318 [info ] [Thread-1 (]: 13 of 17 START test not_null_listings_staging_year ............................. [RUN]
[0m03:10:29.403765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_type.f882511134, now test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1)
[0m03:10:29.404676 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1
[0m03:10:29.415665 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1"
[0m03:10:29.424986 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1 (compile): 03:10:29.405465 => 03:10:29.424570
[0m03:10:29.426164 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1
[0m03:10:29.430615 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1"
[0m03:10:29.446092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:29.450239 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
where year is null



      
    ) dbt_internal_test
[0m03:10:31.385443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dab8a61a-86bd-43f8-b118-af89bc266e37&page=queryresults
[0m03:10:31.387772 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1 (execute): 03:10:29.427456 => 03:10:31.387492
[0m03:10:31.389476 [info ] [Thread-1 (]: 13 of 17 PASS not_null_listings_staging_year ................................... [[32mPASS[0m in 1.99s]
[0m03:10:31.390978 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1
[0m03:10:31.392456 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318
[0m03:10:31.393329 [info ] [Thread-1 (]: 14 of 17 START test not_null_locations_staging_latitude ........................ [RUN]
[0m03:10:31.394679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_staging_year.b27ee630b1, now test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318)
[0m03:10:31.395565 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318
[0m03:10:31.401540 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318"
[0m03:10:31.409175 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318 (compile): 03:10:31.396274 => 03:10:31.408785
[0m03:10:31.410137 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318
[0m03:10:31.413812 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318"
[0m03:10:31.422504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:31.426481 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
where latitude is null



      
    ) dbt_internal_test
[0m03:10:33.351483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:fd0e80d0-908a-4278-9773-e20427ddd3f0&page=queryresults
[0m03:10:33.353536 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318 (execute): 03:10:31.410778 => 03:10:33.353211
[0m03:10:33.355121 [info ] [Thread-1 (]: 14 of 17 PASS not_null_locations_staging_latitude .............................. [[32mPASS[0m in 1.96s]
[0m03:10:33.356654 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318
[0m03:10:33.357847 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed
[0m03:10:33.358776 [info ] [Thread-1 (]: 15 of 17 START test not_null_locations_staging_longitude ....................... [RUN]
[0m03:10:33.360152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_locations_staging_latitude.e8ea90f318, now test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed)
[0m03:10:33.361024 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed
[0m03:10:33.367224 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed"
[0m03:10:33.377319 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed (compile): 03:10:33.361754 => 03:10:33.376863
[0m03:10:33.378418 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed
[0m03:10:33.388578 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed"
[0m03:10:33.398141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:33.402962 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
where longitude is null



      
    ) dbt_internal_test
[0m03:10:35.145456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:e8eedde4-fcd5-4bdf-8273-70d229229fa4&page=queryresults
[0m03:10:35.147356 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed (execute): 03:10:33.379168 => 03:10:35.147050
[0m03:10:35.148963 [info ] [Thread-1 (]: 15 of 17 PASS not_null_locations_staging_longitude ............................. [[32mPASS[0m in 1.79s]
[0m03:10:35.150646 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed
[0m03:10:35.151762 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a
[0m03:10:35.152743 [info ] [Thread-1 (]: 16 of 17 START test not_null_locations_staging_state ........................... [RUN]
[0m03:10:35.154323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_locations_staging_longitude.4ed0f2a0ed, now test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a)
[0m03:10:35.155266 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a
[0m03:10:35.164287 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a"
[0m03:10:35.172342 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a (compile): 03:10:35.156076 => 03:10:35.171862
[0m03:10:35.173314 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a
[0m03:10:35.177577 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a"
[0m03:10:35.185715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:35.189811 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
where state is null



      
    ) dbt_internal_test
[0m03:10:36.945770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d1cd2d4a-cec0-4b2b-8253-83fed2024414&page=queryresults
[0m03:10:36.947834 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a (execute): 03:10:35.173975 => 03:10:36.947465
[0m03:10:36.949528 [info ] [Thread-1 (]: 16 of 17 PASS not_null_locations_staging_state ................................. [[32mPASS[0m in 1.80s]
[0m03:10:36.951076 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a
[0m03:10:36.952337 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc
[0m03:10:36.953387 [info ] [Thread-1 (]: 17 of 17 START test not_null_locations_staging_suburb .......................... [RUN]
[0m03:10:36.954805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_locations_staging_state.017b60d33a, now test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc)
[0m03:10:36.955755 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc
[0m03:10:36.964834 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc"
[0m03:10:36.973090 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc (compile): 03:10:36.956512 => 03:10:36.972743
[0m03:10:36.974321 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc
[0m03:10:36.978597 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc"
[0m03:10:36.986788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:36.990970 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select suburb
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
where suburb is null



      
    ) dbt_internal_test
[0m03:10:38.804076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:7ce0654a-35ed-4512-b28e-d8f8078a32fa&page=queryresults
[0m03:10:38.805788 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc (execute): 03:10:36.975068 => 03:10:38.805477
[0m03:10:38.807247 [info ] [Thread-1 (]: 17 of 17 PASS not_null_locations_staging_suburb ................................ [[32mPASS[0m in 1.85s]
[0m03:10:38.808763 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc
[0m03:10:38.811685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:38.812575 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.not_null_locations_staging_suburb.84ab3cfbcc' was properly closed.
[0m03:10:38.813435 [info ] [MainThread]: 
[0m03:10:38.814472 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 38.52 seconds (38.52s).
[0m03:10:38.822222 [debug] [MainThread]: Command end result
[0m03:10:38.848661 [info ] [MainThread]: 
[0m03:10:38.849972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:38.850987 [info ] [MainThread]: 
[0m03:10:38.851922 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m03:10:38.853270 [debug] [MainThread]: Command `dbt test` succeeded at 03:10:38.853137 after 41.71 seconds
[0m03:10:38.854153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3241a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3241aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3648f810>]}
[0m03:10:38.855050 [debug] [MainThread]: Flushing usage events
[0m03:15:03.213413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53348f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5334ad29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53348f3e90>]}


============================== 03:15:03.218098 | 0f8dff11-7505-4d84-8e03-2b8a40f8ad47 ==============================
[0m03:15:03.218098 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:15:03.219534 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False'}
[0m03:15:03.669715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53327af550>]}
[0m03:15:03.685897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53348f2250>]}
[0m03:15:03.687357 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:15:03.752542 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:15:06.011607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:15:06.012604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:15:06.020775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533490c9d0>]}
[0m03:15:06.049719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5332627b50>]}
[0m03:15:06.051104 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:15:06.052267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5337850290>]}
[0m03:15:06.054667 [info ] [MainThread]: 
[0m03:15:06.056198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:15:06.057983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m03:15:06.058830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:08.905583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now create_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:15:08.907308 [debug] [ThreadPool]: Creating schema "database: "autotrader-toyota-dashboard"
schema: "autotrader_warehouse"
"
[0m03:15:08.918765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:08.922766 [debug] [ThreadPool]: On create_autotrader-toyota-dashboard_autotrader_warehouse: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "connection_name": "create_autotrader-toyota-dashboard_autotrader_warehouse"} */
create schema if not exists `autotrader-toyota-dashboard`.`autotrader_warehouse`
  
[0m03:15:14.383336 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:972c8b30-272d-4770-a130-5066bcebb48e&page=queryresults
[0m03:15:14.386945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:15:14.387968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:15.393831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:15:15.402810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:16.781422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:15:16.782758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:17.637741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53325c5b10>]}
[0m03:15:17.639668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:17.640872 [info ] [MainThread]: 
[0m03:15:17.656823 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m03:15:17.658482 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m03:15:17.660300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m03:15:17.661388 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m03:15:17.673444 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m03:15:17.683926 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 03:15:17.662120 => 03:15:17.683474
[0m03:15:17.685012 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m03:15:17.742632 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m03:15:17.753182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:17.757308 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


    );
  
[0m03:15:18.754638 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


    );
  
[0m03:15:18.756194 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.car_dim was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 0738eeec-f9cb-4c0f-a397-01f9554308ee

[0m03:15:18.757453 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 03:15:17.685750 => 03:15:18.757185
[0m03:15:18.762838 [debug] [Thread-1 (]: Runtime Error in model car_dim (models/warehouse/car_dim.sql)
  404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.car_dim was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 0738eeec-f9cb-4c0f-a397-01f9554308ee
  
[0m03:15:18.764040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53326ad750>]}
[0m03:15:18.765352 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 1.10s]
[0m03:15:18.766801 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m03:15:18.767852 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m03:15:18.768978 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m03:15:18.770455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m03:15:18.771200 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m03:15:18.787931 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m03:15:18.795571 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 03:15:18.771869 => 03:15:18.795119
[0m03:15:18.796733 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m03:15:18.802149 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m03:15:18.808658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:18.812893 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`


    );
  
[0m03:15:19.788462 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`


    );
  
[0m03:15:19.789806 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.date_dim was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 307095ed-d5e5-4dd0-ad00-8eb2474cb1d9

[0m03:15:19.791125 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 03:15:18.797530 => 03:15:19.790857
[0m03:15:19.794887 [debug] [Thread-1 (]: Runtime Error in model date_dim (models/warehouse/date_dim.sql)
  404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.date_dim was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 307095ed-d5e5-4dd0-ad00-8eb2474cb1d9
  
[0m03:15:19.795941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533263c290>]}
[0m03:15:19.797251 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model autotrader_warehouse.date_dim ...... [[31mERROR[0m in 1.03s]
[0m03:15:19.798740 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m03:15:19.799803 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m03:15:19.800877 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m03:15:19.802338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m03:15:19.803236 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m03:15:19.810780 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m03:15:19.818598 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 03:15:19.804034 => 03:15:19.818156
[0m03:15:19.819646 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m03:15:19.825254 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m03:15:19.831731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:19.836064 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


    );
  
[0m03:15:20.900061 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    
    

    OPTIONS()
    as (
      

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


    );
  
[0m03:15:20.901705 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.location_dim was not found in location asia-southeast1

Location: asia-southeast1
Job ID: 9e9c06f5-2913-4670-9494-696800ab0e30

[0m03:15:20.902957 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 03:15:19.820456 => 03:15:20.902694
[0m03:15:20.906701 [debug] [Thread-1 (]: Runtime Error in model location_dim (models/warehouse/location_dim.sql)
  404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.location_dim was not found in location asia-southeast1
  
  Location: asia-southeast1
  Job ID: 9e9c06f5-2913-4670-9494-696800ab0e30
  
[0m03:15:20.907702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f8dff11-7505-4d84-8e03-2b8a40f8ad47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53323ca950>]}
[0m03:15:20.908921 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model autotrader_warehouse.location_dim .. [[31mERROR[0m in 1.11s]
[0m03:15:20.910356 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m03:15:20.912152 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m03:15:20.913234 [info ] [Thread-1 (]: 4 of 4 SKIP relation autotrader_warehouse.listing_fact ......................... [[33mSKIP[0m]
[0m03:15:20.914422 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m03:15:20.916634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:20.917290 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.location_dim' was properly closed.
[0m03:15:20.918026 [info ] [MainThread]: 
[0m03:15:20.918942 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 14.86 seconds (14.86s).
[0m03:15:20.920133 [debug] [MainThread]: Command end result
[0m03:15:20.943196 [info ] [MainThread]: 
[0m03:15:20.944477 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:15:20.945483 [info ] [MainThread]: 
[0m03:15:20.946396 [error] [MainThread]: [33mRuntime Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m03:15:20.947243 [error] [MainThread]:   404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.car_dim was not found in location asia-southeast1
[0m03:15:20.948073 [error] [MainThread]:   
[0m03:15:20.948869 [error] [MainThread]:   Location: asia-southeast1
[0m03:15:20.949699 [error] [MainThread]:   Job ID: 0738eeec-f9cb-4c0f-a397-01f9554308ee
[0m03:15:20.950569 [error] [MainThread]:   
[0m03:15:20.951407 [info ] [MainThread]: 
[0m03:15:20.952275 [error] [MainThread]: [33mRuntime Error in model date_dim (models/warehouse/date_dim.sql)[0m
[0m03:15:20.953229 [error] [MainThread]:   404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.date_dim was not found in location asia-southeast1
[0m03:15:20.954271 [error] [MainThread]:   
[0m03:15:20.955513 [error] [MainThread]:   Location: asia-southeast1
[0m03:15:20.956803 [error] [MainThread]:   Job ID: 307095ed-d5e5-4dd0-ad00-8eb2474cb1d9
[0m03:15:20.957779 [error] [MainThread]:   
[0m03:15:20.958771 [info ] [MainThread]: 
[0m03:15:20.959626 [error] [MainThread]: [33mRuntime Error in model location_dim (models/warehouse/location_dim.sql)[0m
[0m03:15:20.960532 [error] [MainThread]:   404 Not found: Table autotrader-toyota-dashboard:autotrader_warehouse.location_dim was not found in location asia-southeast1
[0m03:15:20.961616 [error] [MainThread]:   
[0m03:15:20.962449 [error] [MainThread]:   Location: asia-southeast1
[0m03:15:20.963286 [error] [MainThread]:   Job ID: 9e9c06f5-2913-4670-9494-696800ab0e30
[0m03:15:20.964146 [error] [MainThread]:   
[0m03:15:20.964972 [info ] [MainThread]: 
[0m03:15:20.965853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:15:20.967154 [debug] [MainThread]: Command `dbt run` failed at 03:15:20.966987 after 17.77 seconds
[0m03:15:20.968323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53346b5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5335dcc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5338800410>]}
[0m03:15:20.969342 [debug] [MainThread]: Flushing usage events
[0m03:33:43.684813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54aa0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54aa2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54a43410>]}


============================== 03:33:43.690238 | 632e6c97-f889-47f3-8a32-68c46d6255a8 ==============================
[0m03:33:43.690238 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:33:43.691515 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m03:33:44.188108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5261ff90>]}
[0m03:33:44.206265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5260ac50>]}
[0m03:33:44.208029 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:33:44.281419 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:33:46.981446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:33:46.982421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:33:46.990728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54783c90>]}
[0m03:33:47.017560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5269bd90>]}
[0m03:33:47.018830 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:33:47.020115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c57733950>]}
[0m03:33:47.022505 [info ] [MainThread]: 
[0m03:33:47.024195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:33:47.026506 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m03:33:47.027697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:33:48.685167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:33:48.686361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:49.709218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:33:49.710876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:50.757731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:33:50.759733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:51.987626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54aa0dd0>]}
[0m03:33:51.989338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:33:51.990566 [info ] [MainThread]: 
[0m03:33:52.006069 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m03:33:52.007973 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m03:33:52.009557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m03:33:52.010522 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m03:33:52.025716 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m03:33:52.034890 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 03:33:52.011315 => 03:33:52.034370
[0m03:33:52.035973 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m03:33:52.073730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:33:52.916482 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m03:33:52.925012 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.year = listings_staging.year
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.car_model = listings_staging.car_model
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:33:53.292274 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [35:10]')
[0m03:33:53.691791 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6c2a791a-6590-4c66-a94c-ea902b9dc684&page=queryresults
[0m03:33:53.693556 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 03:33:52.036694 => 03:33:53.693262
[0m03:33:53.698881 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Syntax error: Unexpected ")" at [35:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:33:53.700103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c52521050>]}
[0m03:33:53.701349 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 1.69s]
[0m03:33:53.702586 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m03:33:53.703608 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m03:33:53.704608 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m03:33:53.705902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m03:33:53.706842 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m03:33:53.713558 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m03:33:53.721324 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 03:33:53.707671 => 03:33:53.720978
[0m03:33:53.722290 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m03:33:53.738116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:33:54.675712 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m03:33:54.683892 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:33:54.935006 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [27:10]')
[0m03:33:55.400047 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4d41301d-c942-4fec-bd90-86eaa624e9f9&page=queryresults
[0m03:33:55.401742 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 03:33:53.723140 => 03:33:55.401462
[0m03:33:55.405158 [debug] [Thread-1 (]: Database Error in model date_dim (models/warehouse/date_dim.sql)
  Syntax error: Unexpected ")" at [27:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:33:55.406160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5213b110>]}
[0m03:33:55.407272 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model autotrader_warehouse.date_dim ...... [[31mERROR[0m in 1.70s]
[0m03:33:55.408438 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m03:33:55.409539 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m03:33:55.410632 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m03:33:55.412088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m03:33:55.412982 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m03:33:55.422354 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m03:33:55.431126 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 03:33:55.413756 => 03:33:55.430301
[0m03:33:55.432548 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m03:33:55.437286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:33:56.278352 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m03:33:56.286526 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.suburb = locations_staging.suburb
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:33:56.546212 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [34:10]')
[0m03:33:56.942471 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:475142d1-1b7c-4aae-953b-5166afd97a67&page=queryresults
[0m03:33:56.944400 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 03:33:55.433398 => 03:33:56.944061
[0m03:33:56.948093 [debug] [Thread-1 (]: Database Error in model location_dim (models/warehouse/location_dim.sql)
  Syntax error: Unexpected ")" at [34:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:33:56.949048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632e6c97-f889-47f3-8a32-68c46d6255a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c526af250>]}
[0m03:33:56.950208 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model autotrader_warehouse.location_dim .. [[31mERROR[0m in 1.54s]
[0m03:33:56.951509 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m03:33:56.953334 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m03:33:56.954384 [info ] [Thread-1 (]: 4 of 4 SKIP relation autotrader_warehouse.listing_fact ......................... [[33mSKIP[0m]
[0m03:33:56.955535 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m03:33:56.958163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:33:56.959381 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.location_dim' was properly closed.
[0m03:33:56.960513 [info ] [MainThread]: 
[0m03:33:56.961586 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m03:33:56.962957 [debug] [MainThread]: Command end result
[0m03:33:56.986955 [info ] [MainThread]: 
[0m03:33:56.988525 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:33:56.989616 [info ] [MainThread]: 
[0m03:33:56.990766 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m03:33:56.991873 [error] [MainThread]:   Syntax error: Unexpected ")" at [35:10]
[0m03:33:56.992813 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:33:56.993713 [info ] [MainThread]: 
[0m03:33:56.994694 [error] [MainThread]: [33mDatabase Error in model date_dim (models/warehouse/date_dim.sql)[0m
[0m03:33:56.995720 [error] [MainThread]:   Syntax error: Unexpected ")" at [27:10]
[0m03:33:56.996668 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:33:56.997629 [info ] [MainThread]: 
[0m03:33:56.998661 [error] [MainThread]: [33mDatabase Error in model location_dim (models/warehouse/location_dim.sql)[0m
[0m03:33:56.999661 [error] [MainThread]:   Syntax error: Unexpected ")" at [34:10]
[0m03:33:57.000825 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:33:57.002064 [info ] [MainThread]: 
[0m03:33:57.003280 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:33:57.005551 [debug] [MainThread]: Command `dbt run` failed at 03:33:57.005220 after 13.34 seconds
[0m03:33:57.006876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c54b1e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c547f22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c587007d0>]}
[0m03:33:57.008341 [debug] [MainThread]: Flushing usage events
[0m03:40:12.571857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dda1b18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8c3bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd896e2d0>]}


============================== 03:40:12.576652 | 1c497bf5-941a-4799-b0e7-5dae8084c714 ==============================
[0m03:40:12.576652 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:40:12.577969 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m03:40:13.028207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7081f10>]}
[0m03:40:13.044700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd896c690>]}
[0m03:40:13.046573 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:40:13.112439 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:40:15.480836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:40:15.482134 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m03:40:15.507964 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m03:40:15.526486 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m03:40:15.593138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd680bf50>]}
[0m03:40:15.617196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd646e0d0>]}
[0m03:40:15.618386 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:40:15.619479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddb8cc1d0>]}
[0m03:40:15.621710 [info ] [MainThread]: 
[0m03:40:15.623079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:40:15.624889 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m03:40:15.625789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:40:17.251266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:40:17.252618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:18.610091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:40:18.611310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:19.455949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:40:19.458026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:20.353529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8c8bf10>]}
[0m03:40:20.355286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:40:20.356634 [info ] [MainThread]: 
[0m03:40:20.372681 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m03:40:20.373891 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m03:40:20.375261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.car_dim)
[0m03:40:20.376160 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m03:40:20.387249 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m03:40:20.394073 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 03:40:20.377054 => 03:40:20.393673
[0m03:40:20.395587 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m03:40:20.431914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:21.402775 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m03:40:21.409856 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + coalesce((select max(car_key) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`), 0) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.year = listings_staging.year
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.car_model = listings_staging.car_model
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:40:21.656602 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [35:10]')
[0m03:40:22.287070 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:f2d4b00a-c5c4-437f-8cc6-a6f1783d5c6a&page=queryresults
[0m03:40:22.288844 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 03:40:20.396480 => 03:40:22.288485
[0m03:40:22.294999 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Syntax error: Unexpected ")" at [35:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:40:22.296120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd656dc50>]}
[0m03:40:22.297366 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 1.92s]
[0m03:40:22.298581 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m03:40:22.299574 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m03:40:22.300616 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m03:40:22.302150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m03:40:22.303509 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m03:40:22.309029 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m03:40:22.316641 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 03:40:22.304385 => 03:40:22.316120
[0m03:40:22.317655 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m03:40:22.321842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:23.247749 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m03:40:23.256407 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:40:23.541352 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [27:10]')
[0m03:40:24.255827 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:da1a1538-9ccc-41c8-bd3b-24e89a9da542&page=queryresults
[0m03:40:24.257821 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 03:40:22.318326 => 03:40:24.257487
[0m03:40:24.261894 [debug] [Thread-1 (]: Database Error in model date_dim (models/warehouse/date_dim.sql)
  Syntax error: Unexpected ")" at [27:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:40:24.262927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd654a010>]}
[0m03:40:24.264187 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model autotrader_warehouse.date_dim ...... [[31mERROR[0m in 1.96s]
[0m03:40:24.265606 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m03:40:24.266773 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m03:40:24.267925 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m03:40:24.269431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m03:40:24.270431 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m03:40:24.286080 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m03:40:24.293937 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 03:40:24.271224 => 03:40:24.293504
[0m03:40:24.294917 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m03:40:24.299715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:40:25.134791 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m03:40:25.143506 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.suburb = locations_staging.suburb
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:40:25.413058 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [34:10]')
[0m03:40:26.596503 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:43a06160-5d39-41b2-981f-898449c89628&page=queryresults
[0m03:40:26.598469 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 03:40:24.295694 => 03:40:26.598120
[0m03:40:26.603274 [debug] [Thread-1 (]: Database Error in model location_dim (models/warehouse/location_dim.sql)
  Syntax error: Unexpected ")" at [34:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:40:26.604228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c497bf5-941a-4799-b0e7-5dae8084c714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd62d7ad0>]}
[0m03:40:26.605406 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model autotrader_warehouse.location_dim .. [[31mERROR[0m in 2.34s]
[0m03:40:26.606525 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m03:40:26.608700 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m03:40:26.609619 [info ] [Thread-1 (]: 4 of 4 SKIP relation autotrader_warehouse.listing_fact ......................... [[33mSKIP[0m]
[0m03:40:26.610892 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m03:40:26.614337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:40:26.615505 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.location_dim' was properly closed.
[0m03:40:26.616361 [info ] [MainThread]: 
[0m03:40:26.617283 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 10.99 seconds (10.99s).
[0m03:40:26.618535 [debug] [MainThread]: Command end result
[0m03:40:26.646166 [info ] [MainThread]: 
[0m03:40:26.647473 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:40:26.648492 [info ] [MainThread]: 
[0m03:40:26.649523 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m03:40:26.650480 [error] [MainThread]:   Syntax error: Unexpected ")" at [35:10]
[0m03:40:26.651352 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:40:26.652250 [info ] [MainThread]: 
[0m03:40:26.653133 [error] [MainThread]: [33mDatabase Error in model date_dim (models/warehouse/date_dim.sql)[0m
[0m03:40:26.654014 [error] [MainThread]:   Syntax error: Unexpected ")" at [27:10]
[0m03:40:26.654893 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:40:26.655744 [info ] [MainThread]: 
[0m03:40:26.656665 [error] [MainThread]: [33mDatabase Error in model location_dim (models/warehouse/location_dim.sql)[0m
[0m03:40:26.657507 [error] [MainThread]:   Syntax error: Unexpected ")" at [34:10]
[0m03:40:26.658384 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:40:26.659374 [info ] [MainThread]: 
[0m03:40:26.660625 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:40:26.662220 [debug] [MainThread]: Command `dbt run` failed at 03:40:26.661970 after 14.11 seconds
[0m03:40:26.663396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8b37090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8974210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8c88e10>]}
[0m03:40:26.664766 [debug] [MainThread]: Flushing usage events
[0m03:46:59.042121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b3ea9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b419f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b3bc4850>]}


============================== 03:46:59.047179 | 2e4adc02-8421-4273-8f99-70728c006743 ==============================
[0m03:46:59.047179 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:46:59.048383 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False'}
[0m03:46:59.491913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b3bacb90>]}
[0m03:46:59.508006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b1a36bd0>]}
[0m03:46:59.509292 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:46:59.572569 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:47:01.964850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:47:01.966337 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m03:47:01.991801 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m03:47:02.009954 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m03:47:02.079925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b189b810>]}
[0m03:47:02.104847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b199b010>]}
[0m03:47:02.105956 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:47:02.107118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b6b5f990>]}
[0m03:47:02.109528 [info ] [MainThread]: 
[0m03:47:02.111066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:47:02.112850 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m03:47:02.113692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:03.715609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:47:03.716863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:04.521903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:47:04.523576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:06.004895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:47:06.006214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:06.841763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b1a61c90>]}
[0m03:47:06.843316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:47:06.844483 [info ] [MainThread]: 
[0m03:47:06.859828 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m03:47:06.861757 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m03:47:06.863557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m03:47:06.864503 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m03:47:06.876547 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m03:47:06.883995 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 03:47:06.865540 => 03:47:06.883586
[0m03:47:06.884943 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m03:47:06.921182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:07.914552 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m03:47:07.921167 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.year = listings_staging.year
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.car_model = listings_staging.car_model
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m03:47:08.891942 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: `autotrader-toyota-dashboard` at [24:11]')
[0m03:47:10.694690 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:77d02269-1452-4d8c-ad94-71df76c556d0&page=queryresults
[0m03:47:10.696529 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 03:47:06.885564 => 03:47:10.696177
[0m03:47:10.702303 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Unrecognized name: `autotrader-toyota-dashboard` at [24:11]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:47:10.703408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b1937e10>]}
[0m03:47:10.704608 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 3.84s]
[0m03:47:10.705837 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m03:47:10.706920 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m03:47:10.708069 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m03:47:10.709609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m03:47:10.710582 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m03:47:10.716162 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m03:47:10.723530 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 03:47:10.711317 => 03:47:10.723068
[0m03:47:10.724503 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m03:47:10.728568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:11.558942 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m03:47:11.566812 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:47:11.897276 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [27:10]')
[0m03:47:12.898031 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:69b7a37d-3531-473f-846b-deec033f1b88&page=queryresults
[0m03:47:12.899800 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 03:47:10.725092 => 03:47:12.899436
[0m03:47:12.903868 [debug] [Thread-1 (]: Database Error in model date_dim (models/warehouse/date_dim.sql)
  Syntax error: Unexpected ")" at [27:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:47:12.904848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b1417d50>]}
[0m03:47:12.906003 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model autotrader_warehouse.date_dim ...... [[31mERROR[0m in 2.20s]
[0m03:47:12.907295 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m03:47:12.908386 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m03:47:12.909509 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m03:47:12.910939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m03:47:12.911844 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m03:47:12.927465 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m03:47:12.935719 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 03:47:12.912536 => 03:47:12.935301
[0m03:47:12.936588 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m03:47:12.940747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:13.795035 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m03:47:13.803226 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.suburb = locations_staging.suburb
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m03:47:14.058014 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [34:10]')
[0m03:47:14.581754 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:909b17f3-06d1-42f1-b395-90255d2f4ea7&page=queryresults
[0m03:47:14.583719 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 03:47:12.937189 => 03:47:14.583434
[0m03:47:14.588067 [debug] [Thread-1 (]: Database Error in model location_dim (models/warehouse/location_dim.sql)
  Syntax error: Unexpected ")" at [34:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:47:14.589100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e4adc02-8421-4273-8f99-70728c006743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b1a58990>]}
[0m03:47:14.590335 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model autotrader_warehouse.location_dim .. [[31mERROR[0m in 1.68s]
[0m03:47:14.591587 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m03:47:14.593420 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m03:47:14.594675 [info ] [Thread-1 (]: 4 of 4 SKIP relation autotrader_warehouse.listing_fact ......................... [[33mSKIP[0m]
[0m03:47:14.596124 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m03:47:14.599124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:14.600747 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.location_dim' was properly closed.
[0m03:47:14.601846 [info ] [MainThread]: 
[0m03:47:14.602865 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 12.49 seconds (12.49s).
[0m03:47:14.604056 [debug] [MainThread]: Command end result
[0m03:47:14.626199 [info ] [MainThread]: 
[0m03:47:14.627707 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:47:14.628869 [info ] [MainThread]: 
[0m03:47:14.630049 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m03:47:14.631449 [error] [MainThread]:   Unrecognized name: `autotrader-toyota-dashboard` at [24:11]
[0m03:47:14.632930 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:47:14.634085 [info ] [MainThread]: 
[0m03:47:14.635017 [error] [MainThread]: [33mDatabase Error in model date_dim (models/warehouse/date_dim.sql)[0m
[0m03:47:14.635975 [error] [MainThread]:   Syntax error: Unexpected ")" at [27:10]
[0m03:47:14.637017 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/date_dim.sql
[0m03:47:14.638109 [info ] [MainThread]: 
[0m03:47:14.639142 [error] [MainThread]: [33mDatabase Error in model location_dim (models/warehouse/location_dim.sql)[0m
[0m03:47:14.640115 [error] [MainThread]:   Syntax error: Unexpected ")" at [34:10]
[0m03:47:14.641035 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m03:47:14.642036 [info ] [MainThread]: 
[0m03:47:14.642922 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m03:47:14.644036 [debug] [MainThread]: Command `dbt run` failed at 03:47:14.643902 after 15.62 seconds
[0m03:47:14.644890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b4008790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b3d6add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76b3705710>]}
[0m03:47:14.645696 [debug] [MainThread]: Flushing usage events
[0m03:50:24.507778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66216410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec660a31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66022650>]}


============================== 03:50:24.513014 | d5e9eb38-1a62-419e-8586-8142598e33ee ==============================
[0m03:50:24.513014 [info ] [MainThread]: Running with dbt=1.5.9
[0m03:50:24.514335 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default'}
[0m03:50:24.967265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63d8fb90>]}
[0m03:50:24.984848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63d99810>]}
[0m03:50:24.986890 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:50:25.094877 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m03:50:28.150896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:50:28.151757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:50:28.159091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63b4f010>]}
[0m03:50:28.182191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63c0ffd0>]}
[0m03:50:28.183344 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m03:50:28.184530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec68e67850>]}
[0m03:50:28.186670 [info ] [MainThread]: 
[0m03:50:28.188208 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:50:28.189825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m03:50:28.190648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:29.581478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m03:50:29.582795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:50:30.403760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m03:50:30.405387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:50:31.806388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m03:50:31.807577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:50:32.610734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec68e67c10>]}
[0m03:50:32.612610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:50:32.613661 [info ] [MainThread]: 
[0m03:50:32.628345 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m03:50:32.629554 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m03:50:32.630830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m03:50:32.631662 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m03:50:32.645535 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m03:50:32.653185 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 03:50:32.632348 => 03:50:32.652786
[0m03:50:32.654350 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m03:50:32.689415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:50:33.580543 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m03:50:33.589039 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    where `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.year = listings_staging.year
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.car_model = listings_staging.car_model
    and `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m03:50:34.571640 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: `autotrader-toyota-dashboard` at [24:11]')
[0m03:50:36.215397 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:e7025df2-86f0-4496-82c1-7608d6dd561d&page=queryresults
[0m03:50:36.217803 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 03:50:32.655092 => 03:50:36.217388
[0m03:50:36.224207 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Unrecognized name: `autotrader-toyota-dashboard` at [24:11]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:50:36.225427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e9eb38-1a62-419e-8586-8142598e33ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63bb1490>]}
[0m03:50:36.226780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 3.59s]
[0m03:50:36.228067 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m03:50:36.230927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:50:36.231984 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m03:50:36.232762 [info ] [MainThread]: 
[0m03:50:36.233744 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m03:50:36.234914 [debug] [MainThread]: Command end result
[0m03:50:36.264594 [info ] [MainThread]: 
[0m03:50:36.265983 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:50:36.267175 [info ] [MainThread]: 
[0m03:50:36.268359 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m03:50:36.269335 [error] [MainThread]:   Unrecognized name: `autotrader-toyota-dashboard` at [24:11]
[0m03:50:36.270243 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m03:50:36.271117 [info ] [MainThread]: 
[0m03:50:36.272029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:50:36.273279 [debug] [MainThread]: Command `dbt run` failed at 03:50:36.273136 after 11.80 seconds
[0m03:50:36.274215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6608acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec69e34290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec65dc4350>]}
[0m03:50:36.275124 [debug] [MainThread]: Flushing usage events
[0m04:10:37.664521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd25ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd634750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd7091d0>]}


============================== 04:10:37.669357 | 735f237d-7743-4111-af71-1b79cfb8d3d8 ==============================
[0m04:10:37.669357 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:10:37.670647 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False'}
[0m04:10:38.121313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb28e010>]}
[0m04:10:38.137754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb28e010>]}
[0m04:10:38.139035 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:10:38.204552 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:10:40.474546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:10:40.475873 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m04:10:40.499699 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m04:10:40.517907 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m04:10:40.582463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb181fd0>]}
[0m04:10:40.605802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb2746d0>]}
[0m04:10:40.606836 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:10:40.607960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4300328190>]}
[0m04:10:40.610199 [info ] [MainThread]: 
[0m04:10:40.611568 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:10:40.613174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:10:40.613927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:42.222913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:10:42.224255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:43.048257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:10:43.050065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:44.231786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:10:44.233003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:45.113950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb2740d0>]}
[0m04:10:45.115581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:10:45.116592 [info ] [MainThread]: 
[0m04:10:45.132022 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:10:45.133671 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:10:45.135018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.car_dim)
[0m04:10:45.136039 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:10:45.147080 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:10:45.154217 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:10:45.136973 => 04:10:45.153805
[0m04:10:45.155383 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:10:45.191619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:10:46.089934 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:10:46.096809 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m04:10:46.444453 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [35:10]')
[0m04:10:46.899341 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:01aa67da-512f-488a-9602-5139e7fbec46&page=queryresults
[0m04:10:46.901152 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:10:45.156275 => 04:10:46.900857
[0m04:10:46.907044 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Syntax error: Unexpected ")" at [35:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m04:10:46.908181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735f237d-7743-4111-af71-1b79cfb8d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fae382d0>]}
[0m04:10:46.909423 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 1.77s]
[0m04:10:46.910861 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:10:46.913788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:10:46.914620 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:10:46.915336 [info ] [MainThread]: 
[0m04:10:46.916598 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m04:10:46.918135 [debug] [MainThread]: Command end result
[0m04:10:46.952074 [info ] [MainThread]: 
[0m04:10:46.953917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:10:46.955087 [info ] [MainThread]: 
[0m04:10:46.956079 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m04:10:46.957045 [error] [MainThread]:   Syntax error: Unexpected ")" at [35:10]
[0m04:10:46.958005 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m04:10:46.958941 [info ] [MainThread]: 
[0m04:10:46.960017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:10:46.961341 [debug] [MainThread]: Command `dbt run` failed at 04:10:46.961183 after 9.32 seconds
[0m04:10:46.962447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd25a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fb09ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fd6d4d90>]}
[0m04:10:46.963529 [debug] [MainThread]: Flushing usage events
[0m04:11:52.881813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07dfa0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07df8be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07df89210>]}


============================== 04:11:52.886872 | dc52bc33-93ed-4325-90c9-291c47e9cdbf ==============================
[0m04:11:52.886872 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:11:52.888166 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True'}
[0m04:11:53.331922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07be010d0>]}
[0m04:11:53.348384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07be0fe90>]}
[0m04:11:53.350113 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:11:53.413500 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:11:55.625581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:11:55.626474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:11:55.634121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07bbaec50>]}
[0m04:11:55.657369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07bc73c90>]}
[0m04:11:55.658554 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:11:55.659754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb080ebf950>]}
[0m04:11:55.661893 [info ] [MainThread]: 
[0m04:11:55.663449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:11:55.665063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:11:55.665840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:57.002161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:11:57.003572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:57.868709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:11:57.870095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:11:58.749344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:11:58.751316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:12:00.027551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e26c890>]}
[0m04:12:00.029463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:12:00.030441 [info ] [MainThread]: 
[0m04:12:00.045467 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:12:00.046996 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:12:00.048371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m04:12:00.049231 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:12:00.063091 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:12:00.069786 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:12:00.049906 => 04:12:00.069471
[0m04:12:00.070812 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:12:00.106177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:12:01.005634 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:12:01.013715 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m04:12:03.245948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:5cae9ad6-70c0-4ce1-ac2c-6d133ade7339&page=queryresults
[0m04:12:03.261907 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:12:00.071436 => 04:12:03.261681
[0m04:12:03.263525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc52bc33-93ed-4325-90c9-291c47e9cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07be08990>]}
[0m04:12:03.264614 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (13.4k rows, 411.8 KiB processed)[0m in 3.22s]
[0m04:12:03.266278 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:12:03.268633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:12:03.269313 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:12:03.270026 [info ] [MainThread]: 
[0m04:12:03.270946 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m04:12:03.272318 [debug] [MainThread]: Command end result
[0m04:12:03.304004 [info ] [MainThread]: 
[0m04:12:03.305335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:12:03.306324 [info ] [MainThread]: 
[0m04:12:03.307297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:12:03.309122 [debug] [MainThread]: Command `dbt run` succeeded at 04:12:03.308738 after 10.45 seconds
[0m04:12:03.310361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e13f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e28bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb081db42d0>]}
[0m04:12:03.311774 [debug] [MainThread]: Flushing usage events
[0m04:21:13.668483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b80e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b69e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b7f8d90>]}


============================== 04:21:13.673147 | 659d8ae2-5ce0-4934-a038-a13d67a2fcb7 ==============================
[0m04:21:13.673147 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:21:13.674486 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m04:21:14.119310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f794ddd90>]}
[0m04:21:14.135804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f794dd5d0>]}
[0m04:21:14.136987 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:21:14.199705 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:21:16.493950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:21:16.495344 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m04:21:16.519578 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m04:21:16.537926 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m04:21:16.603500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7934df10>]}
[0m04:21:16.626499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f792fed10>]}
[0m04:21:16.627770 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:21:16.628934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7e76c190>]}
[0m04:21:16.631046 [info ] [MainThread]: 
[0m04:21:16.632444 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:21:16.634030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:21:16.634768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:17.991131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:21:17.992401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:21:19.233840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:21:19.235168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:21:20.052043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:21:20.053622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:21:20.936148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f796b3250>]}
[0m04:21:20.937973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:21:20.939361 [info ] [MainThread]: 
[0m04:21:20.955254 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:21:20.956366 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:21:20.957986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m04:21:20.959226 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:21:20.970975 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:21:20.978331 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:21:20.959971 => 04:21:20.977850
[0m04:21:20.979373 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:21:21.015972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:21:21.908889 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:21:21.916543 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
dense_rank() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m04:21:22.849684 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY is required for analytic function dense_rank at [14:19]')
[0m04:21:24.585152 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ef37f82a-7f64-47e3-805c-089295a11570&page=queryresults
[0m04:21:24.587025 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:21:20.980113 => 04:21:24.586740
[0m04:21:24.592766 [debug] [Thread-1 (]: Database Error in model car_dim (models/warehouse/car_dim.sql)
  Window ORDER BY is required for analytic function dense_rank at [14:19]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m04:21:24.593863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '659d8ae2-5ce0-4934-a038-a13d67a2fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f793f30d0>]}
[0m04:21:24.595307 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model autotrader_warehouse.car_dim ....... [[31mERROR[0m in 3.64s]
[0m04:21:24.596632 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:21:24.599777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:21:24.601022 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:21:24.601915 [info ] [MainThread]: 
[0m04:21:24.602928 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m04:21:24.604139 [debug] [MainThread]: Command end result
[0m04:21:24.632558 [info ] [MainThread]: 
[0m04:21:24.633851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:21:24.634822 [info ] [MainThread]: 
[0m04:21:24.635771 [error] [MainThread]: [33mDatabase Error in model car_dim (models/warehouse/car_dim.sql)[0m
[0m04:21:24.636695 [error] [MainThread]:   Window ORDER BY is required for analytic function dense_rank at [14:19]
[0m04:21:24.637567 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/car_dim.sql
[0m04:21:24.638425 [info ] [MainThread]: 
[0m04:21:24.639367 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:21:24.640484 [debug] [MainThread]: Command `dbt run` failed at 04:21:24.640351 after 10.99 seconds
[0m04:21:24.641400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7bb1b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b80d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7bc85bd0>]}
[0m04:21:24.642327 [debug] [MainThread]: Flushing usage events
[0m04:25:00.237247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c92248d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c9224bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c99c2e50>]}


============================== 04:25:00.241839 | 86ca89af-277e-46b7-b1a3-c745d17cff8e ==============================
[0m04:25:00.241839 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:25:00.243133 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False'}
[0m04:25:00.689456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c7568310>]}
[0m04:25:00.706503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c96c5850>]}
[0m04:25:00.707859 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:25:00.767283 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:25:02.927690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:25:02.929034 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m04:25:02.952876 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m04:25:02.971740 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m04:25:03.040464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c7549d10>]}
[0m04:25:03.063070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c73afdd0>]}
[0m04:25:03.064256 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:25:03.065374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cc60fa90>]}
[0m04:25:03.067412 [info ] [MainThread]: 
[0m04:25:03.068776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:25:03.070314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:25:03.071159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:04.472268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:25:04.473760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:05.340488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:25:05.342239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:06.841712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:25:06.843188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:07.742900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c7582250>]}
[0m04:25:07.744666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:07.745783 [info ] [MainThread]: 
[0m04:25:07.762138 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:25:07.763352 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:25:07.764793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m04:25:07.765635 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:25:07.776905 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:25:07.784115 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:25:07.766437 => 04:25:07.783731
[0m04:25:07.785000 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:25:07.820555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:25:08.714592 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:25:08.722036 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.car_model = DBT_INTERNAL_DEST.car_model
                ) and (
                    DBT_INTERNAL_SOURCE.type = DBT_INTERNAL_DEST.type
                )

    
    when matched then update set
        `car_key` = DBT_INTERNAL_SOURCE.`car_key`,`year` = DBT_INTERNAL_SOURCE.`year`,`car_model` = DBT_INTERNAL_SOURCE.`car_model`,`type` = DBT_INTERNAL_SOURCE.`type`
    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m04:25:11.720012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:7ba69e9b-526b-4fcd-a1ec-0445f53f6587&page=queryresults
[0m04:25:11.735840 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:25:07.785798 => 04:25:11.735623
[0m04:25:11.737140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ca89af-277e-46b7-b1a3-c745d17cff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c7428450>]}
[0m04:25:11.738206 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (13.4k rows, 411.8 KiB processed)[0m in 3.97s]
[0m04:25:11.739570 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:25:11.741949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:11.742602 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:25:11.743266 [info ] [MainThread]: 
[0m04:25:11.744140 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m04:25:11.745281 [debug] [MainThread]: Command end result
[0m04:25:11.772802 [info ] [MainThread]: 
[0m04:25:11.774131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:25:11.775301 [info ] [MainThread]: 
[0m04:25:11.776466 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:25:11.777733 [debug] [MainThread]: Command `dbt run` succeeded at 04:25:11.777583 after 11.56 seconds
[0m04:25:11.778603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd500390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd43c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56cd58c810>]}
[0m04:25:11.779435 [debug] [MainThread]: Flushing usage events
[0m04:51:08.637151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f4e10d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f4e04050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f49f77d0>]}


============================== 04:51:08.642111 | 28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1 ==============================
[0m04:51:08.642111 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:51:08.643293 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default'}
[0m04:51:09.093453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f29d5450>]}
[0m04:51:09.110132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f4584b50>]}
[0m04:51:09.112075 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:51:09.171607 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:51:11.489619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:51:11.491093 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m04:51:11.515916 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m04:51:11.534082 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m04:51:11.602275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f29a1d10>]}
[0m04:51:11.625267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f280fd10>]}
[0m04:51:11.626381 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:51:11.627597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f7a6fa90>]}
[0m04:51:11.629720 [info ] [MainThread]: 
[0m04:51:11.631081 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:51:11.632672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:51:11.633441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:13.192939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:51:13.194250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:14.453479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:51:14.454787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:15.306492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:51:15.308155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:16.099145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f7a6fe50>]}
[0m04:51:16.100780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:51:16.101979 [info ] [MainThread]: 
[0m04:51:16.117812 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:51:16.119042 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:51:16.120499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m04:51:16.121361 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:51:16.132692 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:51:16.139526 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:51:16.122040 => 04:51:16.139224
[0m04:51:16.140536 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:51:16.176002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:17.043760 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:51:17.050828 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m04:51:19.680319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:3b89788a-9a08-47cd-b9c3-af479eaa005a&page=queryresults
[0m04:51:19.695745 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:51:16.141360 => 04:51:19.695526
[0m04:51:19.697131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28ee5912-b3f0-4ef2-9a7e-cc73f8be4eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f2850250>]}
[0m04:51:19.698202 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (13.4k rows, 411.8 KiB processed)[0m in 3.58s]
[0m04:51:19.699675 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:51:19.702333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:19.703197 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:51:19.703956 [info ] [MainThread]: 
[0m04:51:19.704844 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m04:51:19.706091 [debug] [MainThread]: Command end result
[0m04:51:19.734612 [info ] [MainThread]: 
[0m04:51:19.735915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:19.736939 [info ] [MainThread]: 
[0m04:51:19.737914 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:51:19.739129 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:19.738992 after 11.12 seconds
[0m04:51:19.739973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f4c59690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f4ce7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f498f850>]}
[0m04:51:19.740870 [debug] [MainThread]: Flushing usage events
[0m04:51:24.984297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22921fd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2292397a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22924cf5d0>]}


============================== 04:51:24.989363 | ba0da209-faa7-46e9-93d0-3ccff69d3de3 ==============================
[0m04:51:24.989363 [info ] [MainThread]: Running with dbt=1.5.9
[0m04:51:24.990597 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False'}
[0m04:51:25.433440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22900abfd0>]}
[0m04:51:25.449515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229221a750>]}
[0m04:51:25.450779 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m04:51:25.512638 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m04:51:27.817674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:27.818775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:27.826423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228ffe0310>]}
[0m04:51:27.850118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228ff2fdd0>]}
[0m04:51:27.851363 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m04:51:27.852519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2295183850>]}
[0m04:51:27.854724 [info ] [MainThread]: 
[0m04:51:27.856223 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:51:27.857874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m04:51:27.858688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:28.981226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m04:51:28.982546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:30.350910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m04:51:30.352427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:31.162539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m04:51:31.164008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:32.062183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22921fe6d0>]}
[0m04:51:32.063775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:51:32.064973 [info ] [MainThread]: 
[0m04:51:32.081037 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m04:51:32.082496 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m04:51:32.083942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m04:51:32.084877 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m04:51:32.098996 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m04:51:32.105962 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 04:51:32.085623 => 04:51:32.105618
[0m04:51:32.107223 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m04:51:32.142601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:33.038845 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m04:51:33.046485 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
year,
car_model,
type
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = listings_staging.year
    and car_dim.car_model = listings_staging.car_model
    and car_dim.type = listings_staging.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m04:51:35.338197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dd1067a9-10cd-428f-93bd-0ede58182554&page=queryresults
[0m04:51:35.354577 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 04:51:32.108073 => 04:51:35.354361
[0m04:51:35.355971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba0da209-faa7-46e9-93d0-3ccff69d3de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22900cc710>]}
[0m04:51:35.357116 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (0.0 rows, 928.6 KiB processed)[0m in 3.27s]
[0m04:51:35.358658 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m04:51:35.361044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:35.361769 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m04:51:35.362552 [info ] [MainThread]: 
[0m04:51:35.363512 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m04:51:35.364813 [debug] [MainThread]: Command end result
[0m04:51:35.398319 [info ] [MainThread]: 
[0m04:51:35.399627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:35.400634 [info ] [MainThread]: 
[0m04:51:35.401726 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:51:35.403040 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:35.402894 after 10.44 seconds
[0m04:51:35.403965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22924fd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2292084ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2292337090>]}
[0m04:51:35.404907 [debug] [MainThread]: Flushing usage events
[0m05:58:51.715324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3623106510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3621912c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36232b96d0>]}


============================== 05:58:51.720798 | ced1a252-11a4-4aff-affe-11b135b1b38f ==============================
[0m05:58:51.720798 [info ] [MainThread]: Running with dbt=1.5.9
[0m05:58:51.722124 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m05:58:52.193959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361f8e4410>]}
[0m05:58:52.210947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36206f37d0>]}
[0m05:58:52.212815 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m05:58:52.276087 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m05:58:54.715346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:58:54.716794 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m05:58:54.741077 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m05:58:54.758995 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m05:58:54.824384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361f61fc10>]}
[0m05:58:54.847898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361f6fd7d0>]}
[0m05:58:54.849131 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m05:58:54.850204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3624980190>]}
[0m05:58:54.852244 [info ] [MainThread]: 
[0m05:58:54.853599 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:58:54.855173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m05:58:54.855998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:58:56.362718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m05:58:56.364035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:58:57.626952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m05:58:57.628280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:58:58.556783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m05:58:58.558556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:58:59.575154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3621e99650>]}
[0m05:58:59.576795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:58:59.577916 [info ] [MainThread]: 
[0m05:58:59.593860 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m05:58:59.595681 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m05:58:59.597238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.car_dim)
[0m05:58:59.598112 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m05:58:59.608831 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m05:58:59.616031 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 05:58:59.598790 => 05:58:59.615665
[0m05:58:59.616977 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m05:58:59.654068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:00.590492 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m05:59:00.599883 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_combinations as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_combinations distinct_comb


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_comb.year
    and car_dim.car_model = distinct_comb.car_model
    and car_dim.type = distinct_comb.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m05:59:03.292021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:18f4c1a8-0ba6-46f8-843e-519042f9271f&page=queryresults
[0m05:59:03.307663 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 05:58:59.617796 => 05:59:03.307444
[0m05:59:03.309086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ced1a252-11a4-4aff-affe-11b135b1b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361f7752d0>]}
[0m05:59:03.310249 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (2.7k rows, 411.8 KiB processed)[0m in 3.71s]
[0m05:59:03.311650 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m05:59:03.314179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:03.314911 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.car_dim' was properly closed.
[0m05:59:03.315670 [info ] [MainThread]: 
[0m05:59:03.316542 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m05:59:03.317825 [debug] [MainThread]: Command end result
[0m05:59:03.346797 [info ] [MainThread]: 
[0m05:59:03.348129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:59:03.349225 [info ] [MainThread]: 
[0m05:59:03.350628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:59:03.352402 [debug] [MainThread]: Command `dbt run` succeeded at 05:59:03.352232 after 11.66 seconds
[0m05:59:03.353533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3621a3e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36218ffa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36222c2c50>]}
[0m05:59:03.354527 [debug] [MainThread]: Flushing usage events
[0m05:59:56.963458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99b939b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99a304b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99a07da50>]}


============================== 05:59:56.968473 | 4e16651e-a6d5-4862-a981-78132dffed5d ==============================
[0m05:59:56.968473 [info ] [MainThread]: Running with dbt=1.5.9
[0m05:59:56.969845 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:59:57.413120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99a0c87d0>]}
[0m05:59:57.429264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc997f2dfd0>]}
[0m05:59:57.430646 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m05:59:57.494831 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m05:59:59.771908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:59:59.772975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:59:59.781076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99a0b2150>]}
[0m05:59:59.807516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc997d9fd50>]}
[0m05:59:59.808712 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m05:59:59.809962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99cfeb950>]}
[0m05:59:59.812941 [info ] [MainThread]: 
[0m05:59:59.815377 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:59:59.817831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m05:59:59.818829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:01.318934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:00:01.320353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:02.132899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:00:02.134711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:03.020887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e16651e-a6d5-4862-a981-78132dffed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc997d97610>]}
[0m06:00:03.022383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:03.023583 [info ] [MainThread]: 
[0m06:00:03.043061 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:00:03.044403 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [RUN]
[0m06:00:03.046170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2)
[0m06:00:03.048378 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:00:03.073077 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m06:00:03.088341 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (compile): 06:00:03.049564 => 06:00:03.087902
[0m06:00:03.089735 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:00:03.112971 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m06:00:03.127660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:03.133003 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        year, car_model, type
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    group by year, car_model, type
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:00:06.789760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ef7e028c-6438-4293-80bb-bfccccb5b5ed&page=queryresults
[0m06:00:06.792687 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (execute): 06:00:03.090740 => 06:00:06.792375
[0m06:00:06.794428 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [[32mPASS[0m in 3.75s]
[0m06:00:06.795895 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:00:06.797150 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m06:00:06.798124 [info ] [Thread-1 (]: 2 of 3 START test not_null_car_dim_car_key ..................................... [RUN]
[0m06:00:06.799649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2, now test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339)
[0m06:00:06.800556 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m06:00:06.809369 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m06:00:06.817241 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (compile): 06:00:06.801364 => 06:00:06.816831
[0m06:00:06.818286 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m06:00:06.822420 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m06:00:06.830447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:06.834957 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select car_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
where car_key is null



      
    ) dbt_internal_test
[0m06:00:09.922095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:3eff84b0-6969-4cc6-a96b-489b0cac7059&page=queryresults
[0m06:00:09.923942 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (execute): 06:00:06.819038 => 06:00:09.923637
[0m06:00:09.925562 [info ] [Thread-1 (]: 2 of 3 PASS not_null_car_dim_car_key ........................................... [[32mPASS[0m in 3.13s]
[0m06:00:09.927202 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m06:00:09.928476 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m06:00:09.929456 [info ] [Thread-1 (]: 3 of 3 START test unique_car_dim_car_key ....................................... [RUN]
[0m06:00:09.930919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339, now test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4)
[0m06:00:09.931854 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m06:00:09.951331 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m06:00:09.968077 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (compile): 06:00:09.932653 => 06:00:09.967658
[0m06:00:09.969199 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m06:00:09.973110 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m06:00:09.980871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:09.985428 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select car_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
  where car_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:00:12.029096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c06c025f-0254-4adc-adcb-b61b85fbb7f0&page=queryresults
[0m06:00:12.030708 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (execute): 06:00:09.969983 => 06:00:12.030449
[0m06:00:12.032175 [info ] [Thread-1 (]: 3 of 3 PASS unique_car_dim_car_key ............................................. [[32mPASS[0m in 2.10s]
[0m06:00:12.033549 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m06:00:12.036182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:12.036934 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4' was properly closed.
[0m06:00:12.037722 [info ] [MainThread]: 
[0m06:00:12.038723 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 12.22 seconds (12.22s).
[0m06:00:12.040752 [debug] [MainThread]: Command end result
[0m06:00:12.063025 [info ] [MainThread]: 
[0m06:00:12.064463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:12.065562 [info ] [MainThread]: 
[0m06:00:12.066630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:00:12.067856 [debug] [MainThread]: Command `dbt test` succeeded at 06:00:12.067718 after 15.12 seconds
[0m06:00:12.068721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99a0c9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99dee0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc999e5d810>]}
[0m06:00:12.069619 [debug] [MainThread]: Flushing usage events
[0m06:22:53.349791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79d01b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79d00710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79bc4110>]}


============================== 06:22:53.354779 | 53586405-06c4-4976-b86c-671f0dcf6cca ==============================
[0m06:22:53.354779 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:22:53.356293 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m06:22:53.809018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79d61f90>]}
[0m06:22:53.825405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79603a50>]}
[0m06:22:53.826602 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:22:53.890055 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:22:56.163829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m06:22:56.165280 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:22:56.166225 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/date_dim.sql
[0m06:22:56.167212 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/car_dim.sql
[0m06:22:56.168061 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/location_dim.sql
[0m06:22:56.192057 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:22:56.211598 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:22:56.214630 [debug] [MainThread]: 1603: static parser failed on warehouse/date_dim.sql
[0m06:22:56.220802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/date_dim.sql
[0m06:22:56.223193 [debug] [MainThread]: 1603: static parser failed on warehouse/car_dim.sql
[0m06:22:56.230142 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/car_dim.sql
[0m06:22:56.232410 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m06:22:56.237987 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m06:22:56.333232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b776682d0>]}
[0m06:22:56.356657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b776bf490>]}
[0m06:22:56.357830 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:22:56.359020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7cb1c1d0>]}
[0m06:22:56.361687 [info ] [MainThread]: 
[0m06:22:56.363258 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:22:56.365308 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m06:22:56.366228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:58.048797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:22:58.050125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:58.906857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:22:58.908602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:59.781531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53586405-06c4-4976-b86c-671f0dcf6cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b77633250>]}
[0m06:22:59.783065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:22:59.784148 [info ] [MainThread]: 
[0m06:22:59.802704 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:22:59.803933 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [RUN]
[0m06:22:59.805377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2)
[0m06:22:59.806193 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:22:59.819685 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m06:22:59.830037 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (compile): 06:22:59.806848 => 06:22:59.829436
[0m06:22:59.831222 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:22:59.856832 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m06:22:59.866235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:59.870331 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        year, car_model, type
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    group by year, car_model, type
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:23:01.897103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:352eee6a-52c2-4ad9-ad0c-8cb094ce149c&page=queryresults
[0m06:23:01.899674 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (execute): 06:22:59.831954 => 06:23:01.899394
[0m06:23:01.901626 [info ] [Thread-1 (]: 1 of 10 PASS dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [[32mPASS[0m in 2.10s]
[0m06:23:01.903093 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m06:23:01.904232 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m06:23:01.905383 [info ] [Thread-1 (]: 2 of 10 START test dbt_utils_unique_combination_of_columns_date_dim_date_key__date  [RUN]
[0m06:23:01.907153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd)
[0m06:23:01.908376 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m06:23:01.915438 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m06:23:01.924640 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (compile): 06:23:01.909310 => 06:23:01.924175
[0m06:23:01.925700 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m06:23:01.929514 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m06:23:01.936887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:01.941157 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, date
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
    group by date_key, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:23:03.980102 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:38b551af-f119-4561-9e7e-297a14e58d8f&page=queryresults
[0m06:23:03.981809 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (execute): 06:23:01.926431 => 06:23:03.981527
[0m06:23:03.983250 [info ] [Thread-1 (]: 2 of 10 PASS dbt_utils_unique_combination_of_columns_date_dim_date_key__date ... [[32mPASS[0m in 2.08s]
[0m06:23:03.984760 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m06:23:03.985953 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:23:03.986890 [info ] [Thread-1 (]: 3 of 10 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m06:23:03.988071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m06:23:03.988829 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:23:03.998970 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m06:23:04.007599 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 06:23:03.989512 => 06:23:04.007125
[0m06:23:04.008699 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:23:04.012357 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m06:23:04.022507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:04.026741 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:23:04.970388 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table autotrader-toyota-dashboard.autotrader_warehouse.listing_fact does not have a schema.')
[0m06:23:06.233387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:69b1ec62-e68e-4389-a3df-a431340216c8&page=queryresults
[0m06:23:06.235359 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 06:23:04.009468 => 06:23:06.235027
[0m06:23:06.244014 [debug] [Thread-1 (]: Database Error in test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer (models/warehouse/schema.yml)
  Table autotrader-toyota-dashboard.autotrader_warehouse.listing_fact does not have a schema.
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_75380346b9f4e88a702deaa78925be15.sql
[0m06:23:06.245558 [error] [Thread-1 (]: 3 of 10 ERROR dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[31mERROR[0m in 2.26s]
[0m06:23:06.247075 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:23:06.248141 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m06:23:06.249080 [info ] [Thread-1 (]: 4 of 10 START test dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation  [RUN]
[0m06:23:06.250599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc)
[0m06:23:06.251463 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m06:23:06.259200 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"
[0m06:23:06.266749 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc (compile): 06:23:06.252109 => 06:23:06.266360
[0m06:23:06.267794 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m06:23:06.271732 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"
[0m06:23:06.287548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:06.291759 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state, geolocation
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    group by suburb, state, geolocation
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:23:07.048325 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m06:23:07.325822 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Grouping by expressions of type GEOGRAPHY is not allowed at [18:29]')
[0m06:23:08.358458 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:83add74c-e9e1-40a4-8f06-163befaf01a0&page=queryresults
[0m06:23:08.360328 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc (execute): 06:23:06.268549 => 06:23:08.360034
[0m06:23:08.364274 [debug] [Thread-1 (]: Database Error in test dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation (models/warehouse/schema.yml)
  Grouping by expressions of type GEOGRAPHY is not allowed at [18:29]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_b1dc50caccdb479faed998a489ff8c50.sql
[0m06:23:08.365777 [error] [Thread-1 (]: 4 of 10 ERROR dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation  [[31mERROR[0m in 2.12s]
[0m06:23:08.367289 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m06:23:08.368391 [info ] [MainThread]: 
[0m06:23:08.369515 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m06:23:08.370477 [info ] [MainThread]: 
[0m06:23:08.371571 [error] [MainThread]: [33mDatabase Error in test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer (models/warehouse/schema.yml)[0m
[0m06:23:08.372606 [error] [MainThread]:   Table autotrader-toyota-dashboard.autotrader_warehouse.listing_fact does not have a schema.
[0m06:23:08.373512 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_75380346b9f4e88a702deaa78925be15.sql
[0m06:23:08.374628 [info ] [MainThread]: 
[0m06:23:08.375620 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m06:23:08.376620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:08.377268 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc' was properly closed.
[0m06:23:08.378030 [info ] [MainThread]: 
[0m06:23:08.379078 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 12.02 seconds (12.02s).
[0m06:23:08.380309 [error] [MainThread]: Encountered an error:

[0m06:23:08.392465 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 781, in test
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 279, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m06:23:08.393960 [debug] [MainThread]: Command `dbt test` failed at 06:23:08.393812 after 15.06 seconds
[0m06:23:08.394886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79ebce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79ebcf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b79bc5c90>]}
[0m06:23:08.395704 [debug] [MainThread]: Flushing usage events
[0m06:23:17.989093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22bd38e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22bbfcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22bbdb710>]}


============================== 06:23:17.993866 | 19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4 ==============================
[0m06:23:17.993866 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:23:17.995182 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m06:23:18.448982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa229791cd0>]}
[0m06:23:18.465847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22bbfc890>]}
[0m06:23:18.467288 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:23:18.538043 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:23:20.857210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:23:20.858175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:23:20.865728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22b43f690>]}
[0m06:23:20.890644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2297f3b90>]}
[0m06:23:20.891771 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:23:20.892874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e88f910>]}
[0m06:23:20.895053 [info ] [MainThread]: 
[0m06:23:20.896554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:23:20.898296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:23:20.899182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:22.004174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:23:22.005593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:22.802945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:23:22.805030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:24.036425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:23:24.037825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:24.912928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22b8bc550>]}
[0m06:23:24.914560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:23:24.915770 [info ] [MainThread]: 
[0m06:23:24.931893 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:23:24.933157 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:23:24.934430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.car_dim)
[0m06:23:24.935217 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:23:24.949357 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:23:24.956810 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:23:24.935853 => 06:23:24.956391
[0m06:23:24.957767 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:23:24.994423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:25.913670 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:23:25.921143 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:23:28.164744 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8df4eca5-794a-4f49-a5b0-efe0ccd54075&page=queryresults
[0m06:23:28.180676 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:23:24.958492 => 06:23:28.180391
[0m06:23:28.182006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2297a36d0>]}
[0m06:23:28.183446 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (2.7k rows, 411.8 KiB processed)[0m in 3.25s]
[0m06:23:28.184917 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:23:28.186000 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:23:28.186869 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:23:28.188097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:23:28.188878 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:23:28.193694 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:23:28.201647 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:23:28.189574 => 06:23:28.201190
[0m06:23:28.202692 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:23:28.216077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:29.071971 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:23:29.080113 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:23:31.742001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dba68df9-2ecd-4234-ad88-c1f428b4f853&page=queryresults
[0m06:23:31.745101 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:23:28.203437 => 06:23:31.744844
[0m06:23:31.746522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22967e5d0>]}
[0m06:23:31.747682 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (1.0 rows, 105.1 KiB processed)[0m in 3.56s]
[0m06:23:31.749456 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:23:31.750706 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:23:31.751812 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:23:31.753348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:23:31.754222 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:23:31.759805 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:23:31.767833 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:23:31.754959 => 06:23:31.767454
[0m06:23:31.768937 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:23:31.774107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:32.660399 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:23:32.668006 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
*
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:23:33.589360 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: geolocation at [34:45]')
[0m06:23:34.895265 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a268fc92-eb76-4258-bf30-4811ffd72037&page=queryresults
[0m06:23:34.897112 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:23:31.769655 => 06:23:34.896824
[0m06:23:34.903908 [debug] [Thread-1 (]: Database Error in model location_dim (models/warehouse/location_dim.sql)
  Unrecognized name: geolocation at [34:45]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m06:23:34.905066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19d0acb1-9297-4ca3-a1a3-ae7560ab8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2297d0e90>]}
[0m06:23:34.906450 [error] [Thread-1 (]: 3 of 4 ERROR creating sql incremental model autotrader_warehouse.location_dim .. [[31mERROR[0m in 3.15s]
[0m06:23:34.907727 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:23:34.909556 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:23:34.910668 [info ] [Thread-1 (]: 4 of 4 SKIP relation autotrader_warehouse.listing_fact ......................... [[33mSKIP[0m]
[0m06:23:34.911711 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:23:34.914058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:34.914926 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.location_dim' was properly closed.
[0m06:23:34.915893 [info ] [MainThread]: 
[0m06:23:34.916852 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m06:23:34.918484 [debug] [MainThread]: Command end result
[0m06:23:34.943552 [info ] [MainThread]: 
[0m06:23:34.945042 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:23:34.946019 [info ] [MainThread]: 
[0m06:23:34.946972 [error] [MainThread]: [33mDatabase Error in model location_dim (models/warehouse/location_dim.sql)[0m
[0m06:23:34.947911 [error] [MainThread]:   Unrecognized name: geolocation at [34:45]
[0m06:23:34.948773 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/location_dim.sql
[0m06:23:34.949722 [info ] [MainThread]: 
[0m06:23:34.951000 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m06:23:34.952660 [debug] [MainThread]: Command `dbt run` failed at 06:23:34.952473 after 16.98 seconds
[0m06:23:34.953869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22bb9fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22b8adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22b327d90>]}
[0m06:23:34.954829 [debug] [MainThread]: Flushing usage events
[0m06:26:22.306895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c341350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c3a91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c0ded90>]}


============================== 06:26:22.311552 | fca606b4-7882-4232-9a1a-465ea61bd62f ==============================
[0m06:26:22.311552 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:26:22.313008 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m06:26:22.748076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114a0a5710>]}
[0m06:26:22.764319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c0d77d0>]}
[0m06:26:22.765754 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:26:22.828929 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:26:25.139113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:26:25.140770 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/location_dim.sql
[0m06:26:25.165069 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m06:26:25.185282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m06:26:25.255488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149f03850>]}
[0m06:26:25.279296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149ee9790>]}
[0m06:26:25.280589 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:26:25.281759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114f14c050>]}
[0m06:26:25.283963 [info ] [MainThread]: 
[0m06:26:25.285484 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:26:25.287188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:26:25.287991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:26.589507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:26:26.590760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:27.475919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:26:27.477345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:28.276046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:26:28.278111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:29.477037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149ed5c50>]}
[0m06:26:29.478914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:26:29.480131 [info ] [MainThread]: 
[0m06:26:29.496408 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:26:29.497677 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:26:29.499022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m06:26:29.499873 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:26:29.511150 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:26:29.517948 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:26:29.500852 => 06:26:29.517630
[0m06:26:29.518757 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:26:29.554068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:30.480755 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:26:30.487317 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:26:33.080545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:1dcbc6a9-e22e-4429-87a0-1dc4eb57fd2a&page=queryresults
[0m06:26:33.096488 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:26:29.519344 => 06:26:33.096272
[0m06:26:33.097854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149ebee50>]}
[0m06:26:33.099031 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (2.7k rows, 411.8 KiB processed)[0m in 3.60s]
[0m06:26:33.100588 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:26:33.101600 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:26:33.102509 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:26:33.103717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:26:33.104534 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:26:33.108977 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:26:33.117125 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:26:33.105142 => 06:26:33.116704
[0m06:26:33.118029 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:26:33.122448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:34.016470 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:26:34.024425 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:26:36.584741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ec22906a-e093-4903-8881-1861b3976cf1&page=queryresults
[0m06:26:36.587944 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:26:33.118663 => 06:26:36.587685
[0m06:26:36.589502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149e7a210>]}
[0m06:26:36.591003 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (1.0 rows, 105.1 KiB processed)[0m in 3.49s]
[0m06:26:36.592641 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:26:36.600849 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:26:36.601957 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:26:36.603521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:26:36.604571 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:26:36.609650 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:26:36.616870 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:26:36.605387 => 06:26:36.616333
[0m06:26:36.618407 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:26:36.622852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:37.496436 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:26:37.503612 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:26:40.308851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:b359bc3e-b6a0-4c8f-9957-0e01bb8cfddc&page=queryresults
[0m06:26:40.311876 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:26:36.619190 => 06:26:40.311633
[0m06:26:40.313278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149b02b90>]}
[0m06:26:40.314405 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (608.0 rows, 19.1 KiB processed)[0m in 3.71s]
[0m06:26:40.315947 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:26:40.317776 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:26:40.318920 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:26:40.320335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:26:40.321282 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:26:40.327571 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:26:40.335136 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:26:40.322064 => 06:26:40.334800
[0m06:26:40.336122 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:26:40.340887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:41.218075 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:26:41.225693 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price,
listings_staging.odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_raw.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        ()
    values
        ()


    
[0m06:26:41.453072 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [45:10]')
[0m06:26:42.469525 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:95029a23-82cc-4f2b-8352-f1210160870e&page=queryresults
[0m06:26:42.471298 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:26:40.336842 => 06:26:42.470995
[0m06:26:42.477577 [debug] [Thread-1 (]: Database Error in model listing_fact (models/warehouse/listing_fact.sql)
  Syntax error: Unexpected ")" at [45:10]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:26:42.478725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fca606b4-7882-4232-9a1a-465ea61bd62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1149c5b990>]}
[0m06:26:42.480030 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model autotrader_warehouse.listing_fact .. [[31mERROR[0m in 2.16s]
[0m06:26:42.481296 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:26:42.484273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:26:42.485418 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:26:42.486417 [info ] [MainThread]: 
[0m06:26:42.487457 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 17.20 seconds (17.20s).
[0m06:26:42.489336 [debug] [MainThread]: Command end result
[0m06:26:42.518730 [info ] [MainThread]: 
[0m06:26:42.519960 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:26:42.521089 [info ] [MainThread]: 
[0m06:26:42.522059 [error] [MainThread]: [33mDatabase Error in model listing_fact (models/warehouse/listing_fact.sql)[0m
[0m06:26:42.523183 [error] [MainThread]:   Syntax error: Unexpected ")" at [45:10]
[0m06:26:42.524126 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:26:42.525394 [info ] [MainThread]: 
[0m06:26:42.526575 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:26:42.527827 [debug] [MainThread]: Command `dbt run` failed at 06:26:42.527687 after 20.24 seconds
[0m06:26:42.528715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c21a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c3a9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114c3a8310>]}
[0m06:26:42.529566 [debug] [MainThread]: Flushing usage events
[0m06:31:36.021090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe014085e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe014327910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe013eeb490>]}


============================== 06:31:36.025683 | dbabc3bf-90d6-4a39-9576-4b54b37499dd ==============================
[0m06:31:36.025683 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:31:36.026908 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m06:31:36.466484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011ef5550>]}
[0m06:31:36.482911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011ecad10>]}
[0m06:31:36.484572 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:31:36.547581 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:31:38.906460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:31:38.908008 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:31:38.934837 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:31:38.956117 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:31:39.030051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011dc5d90>]}
[0m06:31:39.056529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011dc5d90>]}
[0m06:31:39.057924 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:31:39.059164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe016fabd10>]}
[0m06:31:39.061623 [info ] [MainThread]: 
[0m06:31:39.063235 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:31:39.065514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:31:39.066663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:31:40.622710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:31:40.623996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:42.047054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:31:42.048163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:42.882860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:31:42.884846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:43.839265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0138db510>]}
[0m06:31:43.840842 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:31:43.841866 [info ] [MainThread]: 
[0m06:31:43.856474 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:31:43.858048 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:31:43.859418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.car_dim)
[0m06:31:43.860201 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:31:43.871051 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:31:43.878648 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:31:43.861138 => 06:31:43.878186
[0m06:31:43.880146 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:31:43.915327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:44.822683 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:31:44.831634 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:31:47.440252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8f02d04b-3c79-4e2e-aa92-4044d85b81f9&page=queryresults
[0m06:31:47.456303 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:31:43.880938 => 06:31:47.456074
[0m06:31:47.457842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011c96a90>]}
[0m06:31:47.458913 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (0.0 rows, 522.0 KiB processed)[0m in 3.60s]
[0m06:31:47.460533 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:31:47.461649 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:31:47.462614 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:31:47.463863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:31:47.464588 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:31:47.469144 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:31:47.477790 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:31:47.465261 => 06:31:47.477367
[0m06:31:47.478828 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:31:47.483204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:48.337499 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:31:48.344722 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:31:50.655555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ec7c334d-24d4-46d8-aa74-bfad44216341&page=queryresults
[0m06:31:50.658669 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:31:47.479654 => 06:31:50.658400
[0m06:31:50.660277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011f00050>]}
[0m06:31:50.661526 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (0.0 rows, 105.1 KiB processed)[0m in 3.20s]
[0m06:31:50.663139 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:31:50.671706 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:31:50.672855 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:31:50.674543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:31:50.675723 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:31:50.680697 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:31:50.688329 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:31:50.676470 => 06:31:50.687904
[0m06:31:50.689386 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:31:50.694044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:51.579682 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:31:51.588003 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:31:54.126743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8f883423-ffe3-40bd-a163-d01d895fb698&page=queryresults
[0m06:31:54.129830 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:31:50.690070 => 06:31:54.129585
[0m06:31:54.131205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011a5e190>]}
[0m06:31:54.132309 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (0.0 rows, 33.4 KiB processed)[0m in 3.46s]
[0m06:31:54.134190 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:31:54.136173 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:31:54.137147 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:31:54.138534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:31:54.139474 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:31:54.146042 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:31:54.153097 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:31:54.140359 => 06:31:54.152639
[0m06:31:54.154178 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:31:54.159175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:55.060751 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:31:55.068079 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_raw.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:31:55.977814 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: listings_raw at [25:5]')
[0m06:31:58.030551 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:923ca868-424b-426f-a434-70cef7e10873&page=queryresults
[0m06:31:58.032441 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:31:54.155291 => 06:31:58.032110
[0m06:31:58.038859 [debug] [Thread-1 (]: Database Error in model listing_fact (models/warehouse/listing_fact.sql)
  Unrecognized name: listings_raw at [25:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:31:58.040022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabc3bf-90d6-4a39-9576-4b54b37499dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011af84d0>]}
[0m06:31:58.041387 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model autotrader_warehouse.listing_fact .. [[31mERROR[0m in 3.90s]
[0m06:31:58.042705 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:31:58.045980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:31:58.046842 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:31:58.048012 [info ] [MainThread]: 
[0m06:31:58.048991 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 18.99 seconds (18.99s).
[0m06:31:58.051229 [debug] [MainThread]: Command end result
[0m06:31:58.080148 [info ] [MainThread]: 
[0m06:31:58.081403 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:31:58.082402 [info ] [MainThread]: 
[0m06:31:58.083321 [error] [MainThread]: [33mDatabase Error in model listing_fact (models/warehouse/listing_fact.sql)[0m
[0m06:31:58.084191 [error] [MainThread]:   Unrecognized name: listings_raw at [25:5]
[0m06:31:58.084999 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:31:58.085833 [info ] [MainThread]: 
[0m06:31:58.086776 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:31:58.087921 [debug] [MainThread]: Command `dbt run` failed at 06:31:58.087751 after 22.08 seconds
[0m06:31:58.088857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe013f3b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe013eeb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe014205490>]}
[0m06:31:58.089863 [debug] [MainThread]: Flushing usage events
[0m06:32:47.479193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3648bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c364b9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c367b0250>]}


============================== 06:32:47.484205 | 1cbe293d-c41f-48fb-9fbd-796158073255 ==============================
[0m06:32:47.484205 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:32:47.485450 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True'}
[0m06:32:47.924174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3434f010>]}
[0m06:32:47.940410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c35efdbd0>]}
[0m06:32:47.941701 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:32:48.007638 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:32:50.276248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:32:50.278051 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:32:50.302338 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:32:50.321635 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:32:50.383966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3437af90>]}
[0m06:32:50.408105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c34174a10>]}
[0m06:32:50.409295 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:32:50.410398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c39457990>]}
[0m06:32:50.412652 [info ] [MainThread]: 
[0m06:32:50.414076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:32:50.415781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:32:50.416578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:51.909747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:32:51.911144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:52.718324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:32:52.720033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:53.651139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:32:53.653013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:54.844453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3435ae50>]}
[0m06:32:54.846160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:32:54.847236 [info ] [MainThread]: 
[0m06:32:54.862963 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:32:54.864190 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:32:54.865520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m06:32:54.866351 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:32:54.877250 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:32:54.884382 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:32:54.867335 => 06:32:54.884026
[0m06:32:54.885680 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:32:54.921299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:55.875021 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:32:55.882045 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:32:58.123511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:882b46c4-9800-4835-af7f-ca14d066a5a4&page=queryresults
[0m06:32:58.139569 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:32:54.886623 => 06:32:58.139353
[0m06:32:58.141060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3437bc10>]}
[0m06:32:58.142258 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (0.0 rows, 522.0 KiB processed)[0m in 3.28s]
[0m06:32:58.143673 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:32:58.144620 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:32:58.145463 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:32:58.146637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:32:58.147340 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:32:58.151744 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:32:58.159475 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:32:58.147911 => 06:32:58.159047
[0m06:32:58.160418 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:32:58.164581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:59.013357 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:32:59.020488 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:33:01.537477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a1a9f6e5-b74e-4038-b44d-100139a59494&page=queryresults
[0m06:33:01.540583 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:32:58.161048 => 06:33:01.540309
[0m06:33:01.541946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c340e5490>]}
[0m06:33:01.543018 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (0.0 rows, 105.1 KiB processed)[0m in 3.40s]
[0m06:33:01.544511 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:33:01.556733 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:33:01.557976 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:33:01.559728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:33:01.560757 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:33:01.565933 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:33:01.573605 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:33:01.561543 => 06:33:01.573110
[0m06:33:01.574500 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:33:01.578660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:02.487061 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:33:02.495491 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:33:04.799125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:bdb8dcf6-6ee5-4be3-aa83-a1d67c108b48&page=queryresults
[0m06:33:04.802163 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:33:01.575122 => 06:33:04.801915
[0m06:33:04.803661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c33f59950>]}
[0m06:33:04.804886 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (0.0 rows, 33.4 KiB processed)[0m in 3.24s]
[0m06:33:04.806330 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:33:04.808128 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:33:04.809111 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:33:04.810541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:33:04.811385 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:33:04.817035 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:33:04.825444 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:33:04.812071 => 06:33:04.825011
[0m06:33:04.826442 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:33:04.830539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:06.074540 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:33:06.082180 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:33:08.665845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:893036e7-0eba-4aac-8b60-c18e651f889b&page=queryresults
[0m06:33:08.669136 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:33:04.827094 => 06:33:08.668886
[0m06:33:08.670927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbe293d-c41f-48fb-9fbd-796158073255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c34263890>]}
[0m06:33:08.672051 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.5k rows, 1.0 MiB processed)[0m in 3.86s]
[0m06:33:08.673654 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:33:08.676281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:08.677106 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:33:08.677989 [info ] [MainThread]: 
[0m06:33:08.679115 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 18.26 seconds (18.26s).
[0m06:33:08.681281 [debug] [MainThread]: Command end result
[0m06:33:08.710562 [info ] [MainThread]: 
[0m06:33:08.712010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:08.713108 [info ] [MainThread]: 
[0m06:33:08.714135 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:33:08.715401 [debug] [MainThread]: Command `dbt run` succeeded at 06:33:08.715264 after 21.25 seconds
[0m06:33:08.716406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c37640390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c365e1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3a417710>]}
[0m06:33:08.717261 [debug] [MainThread]: Flushing usage events
[0m06:40:06.151878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb867ba8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868abba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8685247d0>]}


============================== 06:40:06.156777 | 8461826c-3ec8-4d4d-8ea5-8e570896eed4 ==============================
[0m06:40:06.156777 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:40:06.157904 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True'}
[0m06:40:06.604982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8660a3f90>]}
[0m06:40:06.621450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8660a0a50>]}
[0m06:40:06.622572 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:40:06.685571 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:40:08.988236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:40:08.989556 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:40:09.015877 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:40:09.035859 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:40:09.098141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb865e9fc50>]}
[0m06:40:09.123081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb865e9f990>]}
[0m06:40:09.124216 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:40:09.125418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb867bf7990>]}
[0m06:40:09.127689 [info ] [MainThread]: 
[0m06:40:09.129108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:40:09.130972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:40:09.131786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:10.838236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:40:10.839380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:11.661546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:40:11.663820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:12.494861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:40:12.496649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:13.757016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8684eb950>]}
[0m06:40:13.758725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:13.759821 [info ] [MainThread]: 
[0m06:40:13.775551 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:40:13.776949 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:40:13.778619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m06:40:13.779454 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:40:13.790095 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:40:13.796710 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:40:13.780460 => 06:40:13.796384
[0m06:40:13.797573 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:40:13.833289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:14.709288 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:40:14.717226 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:40:17.017124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d2eeedeb-eaba-4d5f-91fb-f21737b94b65&page=queryresults
[0m06:40:17.033106 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:40:13.798199 => 06:40:17.032861
[0m06:40:17.035117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8660bbad0>]}
[0m06:40:17.036142 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (0.0 rows, 522.0 KiB processed)[0m in 3.26s]
[0m06:40:17.037599 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:40:17.038750 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:40:17.039662 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:40:17.040940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:40:17.041684 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:40:17.046377 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:40:17.054962 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:40:17.042328 => 06:40:17.054475
[0m06:40:17.056288 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:40:17.061458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:18.140926 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:40:18.149679 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:40:20.474377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a46608ff-c20b-4209-b013-0a4635e4d3f0&page=queryresults
[0m06:40:20.477624 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:40:17.057088 => 06:40:20.477379
[0m06:40:20.479104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb865ecebd0>]}
[0m06:40:20.480457 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (0.0 rows, 105.1 KiB processed)[0m in 3.44s]
[0m06:40:20.482028 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:40:20.490608 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:40:20.491828 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:40:20.493471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:40:20.494513 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:40:20.499743 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:40:20.507472 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:40:20.495379 => 06:40:20.507059
[0m06:40:20.508398 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:40:20.512843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:21.325813 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:40:21.334048 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:40:23.738882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:06a06c7d-beb9-4c24-b7fb-b264865d322a&page=queryresults
[0m06:40:23.742011 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:40:20.509197 => 06:40:23.741741
[0m06:40:23.743820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb865cb8390>]}
[0m06:40:23.744968 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (0.0 rows, 33.4 KiB processed)[0m in 3.25s]
[0m06:40:23.746720 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:40:23.748658 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:40:23.749632 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:40:23.751025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:40:23.751869 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:40:23.757951 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:40:23.764675 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:40:23.752553 => 06:40:23.764305
[0m06:40:23.765681 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:40:23.770386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:26.127203 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:40:26.134906 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
DISTINCT
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:40:28.366870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2aebc681-6baf-499a-8e04-a2c6d104b6ec&page=queryresults
[0m06:40:28.370199 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:40:23.766446 => 06:40:28.369934
[0m06:40:28.371725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8461826c-3ec8-4d4d-8ea5-8e570896eed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb865c37c10>]}
[0m06:40:28.372860 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.0k rows, 1.0 MiB processed)[0m in 4.62s]
[0m06:40:28.374497 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:40:28.377531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:28.378338 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:40:28.379151 [info ] [MainThread]: 
[0m06:40:28.380125 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 19.25 seconds (19.25s).
[0m06:40:28.382460 [debug] [MainThread]: Command end result
[0m06:40:28.411640 [info ] [MainThread]: 
[0m06:40:28.413012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:28.414113 [info ] [MainThread]: 
[0m06:40:28.415194 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:40:28.416513 [debug] [MainThread]: Command `dbt run` succeeded at 06:40:28.416376 after 22.28 seconds
[0m06:40:28.417389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86c11f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868219c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86821b250>]}
[0m06:40:28.418272 [debug] [MainThread]: Flushing usage events
[0m06:46:56.291492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5377ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe575bdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe53ad5850>]}


============================== 06:46:56.296236 | 1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8 ==============================
[0m06:46:56.296236 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:46:56.297500 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m06:46:56.733134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe53b04910>]}
[0m06:46:56.749750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe536be290>]}
[0m06:46:56.751133 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:46:56.813247 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:46:59.037845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:46:59.039347 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:46:59.063363 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:46:59.082184 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:46:59.143804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe513e4a10>]}
[0m06:46:59.168795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5166e290>]}
[0m06:46:59.170099 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:46:59.171184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe56797950>]}
[0m06:46:59.173358 [info ] [MainThread]: 
[0m06:46:59.174752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:46:59.176578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:46:59.177591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:00.953235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:47:00.954528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:01.770539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:47:01.772743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:02.641095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:47:02.642807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:03.872569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe51638490>]}
[0m06:47:03.874568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:03.875960 [info ] [MainThread]: 
[0m06:47:03.892117 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:47:03.893336 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:47:03.894777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m06:47:03.895614 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:47:03.906385 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:47:03.913514 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:47:03.896486 => 06:47:03.913123
[0m06:47:03.914366 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:47:03.949157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:04.841336 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:47:04.848666 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:47:07.373791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:212d33ac-745e-4279-93c5-7cc089fb044d&page=queryresults
[0m06:47:07.389595 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:47:03.914957 => 06:47:07.389376
[0m06:47:07.391150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe51681d90>]}
[0m06:47:07.392382 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (2.7k rows, 411.8 KiB processed)[0m in 3.50s]
[0m06:47:07.393873 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:47:07.394892 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:47:07.395776 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:47:07.396986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:47:07.397840 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:47:07.402443 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:47:07.410819 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:47:07.398501 => 06:47:07.410378
[0m06:47:07.411718 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:47:07.415856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:08.301738 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:47:08.308536 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:47:10.613335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:08ef6286-6a51-4d99-bafe-e625cb6fdaf9&page=queryresults
[0m06:47:10.616577 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:47:07.412336 => 06:47:10.616313
[0m06:47:10.618236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe514b57d0>]}
[0m06:47:10.619718 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (1.0 rows, 105.1 KiB processed)[0m in 3.22s]
[0m06:47:10.621337 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:47:10.630088 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:47:10.631252 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:47:10.632852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:47:10.633836 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:47:10.638909 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:47:10.645415 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:47:10.634651 => 06:47:10.645080
[0m06:47:10.646499 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:47:10.651359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:11.589296 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:47:11.596954 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:47:13.898140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dd420792-e33e-4169-8a6d-9bc702512a13&page=queryresults
[0m06:47:13.901071 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:47:10.647557 => 06:47:13.900845
[0m06:47:13.902284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe516fbf90>]}
[0m06:47:13.903442 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (608.0 rows, 19.1 KiB processed)[0m in 3.27s]
[0m06:47:13.904731 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:47:13.906490 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:47:13.907459 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:47:13.908737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:47:13.909544 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:47:13.916621 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:47:13.923871 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:47:13.910233 => 06:47:13.923479
[0m06:47:13.924834 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:47:13.929453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:14.795688 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:47:14.803494 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
    and listing_fact.price = listings_staging.price
    and listings_fact.odometer = listings_staging.odometer

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:47:15.785335 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: listings_fact; Did you mean listing_fact? at [38:9]')
[0m06:47:16.638189 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8eb7d1a8-d605-4440-a237-baeb0ed91803&page=queryresults
[0m06:47:16.640193 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:47:13.925534 => 06:47:16.639909
[0m06:47:16.646098 [debug] [Thread-1 (]: Database Error in model listing_fact (models/warehouse/listing_fact.sql)
  Unrecognized name: listings_fact; Did you mean listing_fact? at [38:9]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:47:16.647393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aaa9a5c-42d3-44ef-85a5-e9fe6d9493e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe515c1bd0>]}
[0m06:47:16.648769 [error] [Thread-1 (]: 4 of 4 ERROR creating sql incremental model autotrader_warehouse.listing_fact .. [[31mERROR[0m in 2.74s]
[0m06:47:16.650190 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:47:16.653252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:16.654292 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:47:16.655143 [info ] [MainThread]: 
[0m06:47:16.656084 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 17.48 seconds (17.48s).
[0m06:47:16.657869 [debug] [MainThread]: Command end result
[0m06:47:16.689495 [info ] [MainThread]: 
[0m06:47:16.691128 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:47:16.692207 [info ] [MainThread]: 
[0m06:47:16.693123 [error] [MainThread]: [33mDatabase Error in model listing_fact (models/warehouse/listing_fact.sql)[0m
[0m06:47:16.694084 [error] [MainThread]:   Unrecognized name: listings_fact; Did you mean listing_fact? at [38:9]
[0m06:47:16.694991 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/listing_fact.sql
[0m06:47:16.695932 [info ] [MainThread]: 
[0m06:47:16.696938 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:47:16.698243 [debug] [MainThread]: Command `dbt run` failed at 06:47:16.698095 after 20.42 seconds
[0m06:47:16.699301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe53349a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe53337750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe53b14e50>]}
[0m06:47:16.700225 [debug] [MainThread]: Flushing usage events
[0m06:47:35.771421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4566ff93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4568a8d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4567333e90>]}


============================== 06:47:35.776188 | 62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518 ==============================
[0m06:47:35.776188 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:47:35.777443 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m06:47:36.209914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564eb9050>]}
[0m06:47:36.226390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564eb9250>]}
[0m06:47:36.227858 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:47:36.291309 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:47:38.518173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:47:38.519571 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:47:38.544613 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:47:38.564563 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:47:38.627990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564ed0850>]}
[0m06:47:38.651300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4566a631d0>]}
[0m06:47:38.652429 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:47:38.653484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4569fc3950>]}
[0m06:47:38.655751 [info ] [MainThread]: 
[0m06:47:38.657160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:47:38.658915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:47:38.659710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:39.847310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:47:39.848710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:40.710082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:47:40.712218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:41.598185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:47:41.600033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:42.861088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456593b510>]}
[0m06:47:42.863193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:42.864256 [info ] [MainThread]: 
[0m06:47:42.880545 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m06:47:42.881930 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m06:47:42.883598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.car_dim)
[0m06:47:42.884520 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m06:47:42.898242 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m06:47:42.906797 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 06:47:42.885783 => 06:47:42.906312
[0m06:47:42.908129 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m06:47:42.953269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:43.886410 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m06:47:43.894012 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m06:47:46.352486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:073bebc7-0034-415b-9457-59d1e5932f97&page=queryresults
[0m06:47:46.368427 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 06:47:42.909386 => 06:47:46.368190
[0m06:47:46.369834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564f2e890>]}
[0m06:47:46.371113 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (0.0 rows, 522.0 KiB processed)[0m in 3.49s]
[0m06:47:46.372606 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m06:47:46.373628 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m06:47:46.374579 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m06:47:46.375857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m06:47:46.376665 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m06:47:46.381443 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m06:47:46.389134 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 06:47:46.377308 => 06:47:46.388731
[0m06:47:46.390078 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m06:47:46.394326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:47.397418 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m06:47:47.405303 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m06:47:49.557056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d199880c-44ca-4d16-a9de-382f1b27172b&page=queryresults
[0m06:47:49.560194 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 06:47:46.390705 => 06:47:49.559946
[0m06:47:49.561568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564cda5d0>]}
[0m06:47:49.562696 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (0.0 rows, 105.1 KiB processed)[0m in 3.19s]
[0m06:47:49.564242 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m06:47:49.572669 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m06:47:49.573790 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m06:47:49.575404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m06:47:49.576234 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m06:47:49.581377 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m06:47:49.590371 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 06:47:49.576957 => 06:47:49.589949
[0m06:47:49.591455 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m06:47:49.596152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:50.471989 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m06:47:50.479995 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m06:47:52.750212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4a8c099b-5f95-408d-ab59-31ecb4b11799&page=queryresults
[0m06:47:52.753326 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 06:47:49.592319 => 06:47:52.753079
[0m06:47:52.754719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564d29a90>]}
[0m06:47:52.755846 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (0.0 rows, 33.4 KiB processed)[0m in 3.18s]
[0m06:47:52.757404 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m06:47:52.759206 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:47:52.760357 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:47:52.761723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m06:47:52.762652 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:47:52.768886 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:47:52.775927 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:47:52.763485 => 06:47:52.775543
[0m06:47:52.776844 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:47:52.780950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:53.853679 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:47:53.861243 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
    and listing_fact.price = listings_staging.price
    and listing_fact.odometer = listings_staging.odometer

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:47:56.432377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:fb9d1ffd-8d85-4f76-a372-2e259d1f4a75&page=queryresults
[0m06:47:56.435442 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:47:52.777562 => 06:47:56.435192
[0m06:47:56.437307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62aeba9d-f7ae-45fa-a1c3-f7f7ad3cd518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4564d25090>]}
[0m06:47:56.438552 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.5k rows, 1.0 MiB processed)[0m in 3.68s]
[0m06:47:56.440131 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:47:56.443082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:56.443925 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:47:56.444765 [info ] [MainThread]: 
[0m06:47:56.445850 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 17.79 seconds (17.79s).
[0m06:47:56.448342 [debug] [MainThread]: Command end result
[0m06:47:56.476860 [info ] [MainThread]: 
[0m06:47:56.478430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:56.479721 [info ] [MainThread]: 
[0m06:47:56.480839 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:47:56.482254 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:56.482112 after 20.73 seconds
[0m06:47:56.483562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4566b72650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456730f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456af83710>]}
[0m06:47:56.484461 [debug] [MainThread]: Flushing usage events
[0m06:48:43.334417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27079f48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2708844790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2707560050>]}


============================== 06:48:43.339212 | e7ea5aa8-4f8d-42d3-883a-9c9442395d7b ==============================
[0m06:48:43.339212 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:48:43.340567 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m06:48:43.792483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2705565710>]}
[0m06:48:43.808961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f270555e510>]}
[0m06:48:43.810520 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:48:43.873901 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:48:46.206002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:48:46.207234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:48:46.215829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f270537cb10>]}
[0m06:48:46.240277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2705580e10>]}
[0m06:48:46.241661 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:48:46.242913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f270a61b910>]}
[0m06:48:46.245370 [info ] [MainThread]: 
[0m06:48:46.246943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:48:46.249141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_warehouse'
[0m06:48:46.249964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:48:47.382554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:48:47.384282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:48:48.684098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:48:48.685405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:48:49.516099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ea5aa8-4f8d-42d3-883a-9c9442395d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2705565d90>]}
[0m06:48:49.517899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:48:49.519185 [info ] [MainThread]: 
[0m06:48:49.538527 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:48:49.540096 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m06:48:49.541489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m06:48:49.542356 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:48:49.562139 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m06:48:49.570923 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 06:48:49.542977 => 06:48:49.570510
[0m06:48:49.571970 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:48:49.591948 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m06:48:49.600918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:48:49.604843 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m06:48:51.716396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ee869d34-bc8c-4e58-853e-735f5c0a14ff&page=queryresults
[0m06:48:51.719257 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 06:48:49.572792 => 06:48:51.718952
[0m06:48:51.720981 [error] [Thread-1 (]: 1 of 1 FAIL 502 dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[31mFAIL 502[0m in 2.18s]
[0m06:48:51.722743 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m06:48:51.725788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:48:51.726631 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1' was properly closed.
[0m06:48:51.727539 [info ] [MainThread]: 
[0m06:48:51.728730 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m06:48:51.730262 [debug] [MainThread]: Command end result
[0m06:48:51.761094 [info ] [MainThread]: 
[0m06:48:51.762370 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:48:51.763416 [info ] [MainThread]: 
[0m06:48:51.764426 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer (models/warehouse/schema.yml)[0m
[0m06:48:51.765399 [error] [MainThread]:   Got 502 results, configured to fail if != 0
[0m06:48:51.766331 [info ] [MainThread]: 
[0m06:48:51.767309 [info ] [MainThread]:   compiled Code at target/compiled/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_75380346b9f4e88a702deaa78925be15.sql
[0m06:48:51.768216 [info ] [MainThread]: 
[0m06:48:51.769332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:48:51.770774 [debug] [MainThread]: Command `dbt test` failed at 06:48:51.770579 after 8.45 seconds
[0m06:48:51.771811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f270747b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f270b431f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27079f7350>]}
[0m06:48:51.772980 [debug] [MainThread]: Flushing usage events
[0m06:50:24.405418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc87d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fca47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc87db50>]}


============================== 06:50:24.410303 | a099833a-9bc8-4303-925b-9a9d5b14e6e5 ==============================
[0m06:50:24.410303 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:50:24.411646 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager'}
[0m06:50:24.869490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa71b910>]}
[0m06:50:24.887228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc704f10>]}
[0m06:50:24.888993 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:50:24.956147 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:50:27.224471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:27.225702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:27.233827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa4d7590>]}
[0m06:50:27.258481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa5abb90>]}
[0m06:50:27.259635 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:50:27.260854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc1f46d0>]}
[0m06:50:27.262971 [info ] [MainThread]: 
[0m06:50:27.264335 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:50:27.266059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:50:27.266865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:28.697329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:50:28.698665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:29.554363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:50:29.556035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:30.416347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:50:30.418052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:31.567348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa57b090>]}
[0m06:50:31.569372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:50:31.570721 [info ] [MainThread]: 
[0m06:50:31.586572 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:50:31.587832 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:50:31.589196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listing_fact)
[0m06:50:31.590054 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:50:31.604696 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:50:31.612902 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:50:31.590753 => 06:50:31.612462
[0m06:50:31.613866 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:50:31.649709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:32.562603 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:50:32.569714 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
    and listing_fact.price = listings_staging.price
    and listing_fact.odometer = listings_staging.odometer

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:50:34.833416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:04290503-06b3-44f7-b11b-0fdaff20bbd8&page=queryresults
[0m06:50:34.849852 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:50:31.614591 => 06:50:34.849621
[0m06:50:34.851233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a099833a-9bc8-4303-925b-9a9d5b14e6e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fa579e90>]}
[0m06:50:34.852250 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.5k rows, 1.0 MiB processed)[0m in 3.26s]
[0m06:50:34.853653 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:50:34.856096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:50:34.856838 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:50:34.857525 [info ] [MainThread]: 
[0m06:50:34.858419 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m06:50:34.859662 [debug] [MainThread]: Command end result
[0m06:50:34.889770 [info ] [MainThread]: 
[0m06:50:34.891270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:50:34.892317 [info ] [MainThread]: 
[0m06:50:34.893440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:50:34.894745 [debug] [MainThread]: Command `dbt run` succeeded at 06:50:34.894599 after 10.51 seconds
[0m06:50:34.895640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fcb837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd0b1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6100777790>]}
[0m06:50:34.896525 [debug] [MainThread]: Flushing usage events
[0m06:53:01.442432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb54273690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5818c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb55ab9d50>]}


============================== 06:53:01.447073 | 347fc757-02cc-41ea-bcb3-cc6655bcd1eb ==============================
[0m06:53:01.447073 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:53:01.448546 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m06:53:01.894039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb520faf90>]}
[0m06:53:01.910105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53af7b50>]}
[0m06:53:01.911340 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:53:01.972164 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:53:04.253241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:53:04.254460 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:53:04.279245 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:53:04.297632 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:53:04.358736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb51fb9fd0>]}
[0m06:53:04.382064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb52087f50>]}
[0m06:53:04.383171 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:53:04.384291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb571cf950>]}
[0m06:53:04.386412 [info ] [MainThread]: 
[0m06:53:04.387877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:53:04.389507 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:53:04.390288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:07.128813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:53:07.130132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:07.991355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:53:07.993434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:08.815318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:53:08.816970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:10.436049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb542a4310>]}
[0m06:53:10.437689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:10.438785 [info ] [MainThread]: 
[0m06:53:10.456508 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:53:10.458006 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:53:10.459444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listing_fact)
[0m06:53:10.460249 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:53:10.471694 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:53:10.478209 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:53:10.460920 => 06:53:10.477837
[0m06:53:10.479078 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:53:10.514406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:11.482117 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:53:11.490314 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
distinct
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key
    and listing_fact.price = listings_staging.price
    and listing_fact.odometer = listings_staging.odometer

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:53:14.335332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a229b464-9953-451c-aed9-8b28c11966b9&page=queryresults
[0m06:53:14.351416 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:53:10.479692 => 06:53:14.351168
[0m06:53:14.352868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347fc757-02cc-41ea-bcb3-cc6655bcd1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb51f69f10>]}
[0m06:53:14.353875 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.0k rows, 1.0 MiB processed)[0m in 3.89s]
[0m06:53:14.355263 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:53:14.357776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:14.358510 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:53:14.359192 [info ] [MainThread]: 
[0m06:53:14.360055 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m06:53:14.361249 [debug] [MainThread]: Command end result
[0m06:53:14.388218 [info ] [MainThread]: 
[0m06:53:14.389545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:53:14.390518 [info ] [MainThread]: 
[0m06:53:14.391529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:53:14.392759 [debug] [MainThread]: Command `dbt run` succeeded at 06:53:14.392619 after 12.97 seconds
[0m06:53:14.393642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53c10510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5416c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb57ffc810>]}
[0m06:53:14.394502 [debug] [MainThread]: Flushing usage events
[0m06:54:38.834736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb14790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb01950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2c98af50>]}


============================== 06:54:38.839422 | f19b3f8b-35a7-4662-8543-70614b03464d ==============================
[0m06:54:38.839422 [info ] [MainThread]: Running with dbt=1.5.9
[0m06:54:38.840601 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False'}
[0m06:54:39.292624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2a685590>]}
[0m06:54:39.309507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2a65a8d0>]}
[0m06:54:39.310591 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:54:39.375113 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m06:54:41.778965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:54:41.780270 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m06:54:41.804445 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m06:54:41.822931 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m06:54:41.884613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2a658d10>]}
[0m06:54:41.907581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2a4fc410>]}
[0m06:54:41.908972 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m06:54:41.910292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2f73b950>]}
[0m06:54:41.912680 [info ] [MainThread]: 
[0m06:54:41.914209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:54:41.915858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m06:54:41.916660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:43.367321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m06:54:43.368601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:44.256290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m06:54:44.258053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:45.090444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m06:54:45.092419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:46.486462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb001d0>]}
[0m06:54:46.488580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:46.489828 [info ] [MainThread]: 
[0m06:54:46.506488 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m06:54:46.507802 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m06:54:46.509287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listing_fact)
[0m06:54:46.510088 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m06:54:46.521716 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:54:46.528676 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 06:54:46.510724 => 06:54:46.528308
[0m06:54:46.529852 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m06:54:46.567696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:47.471143 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m06:54:47.479219 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
distinct
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m06:54:50.179203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6cc75ca4-18d1-4418-9ddf-c57abc8982b8&page=queryresults
[0m06:54:50.195413 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 06:54:46.530641 => 06:54:50.195174
[0m06:54:50.196800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f19b3f8b-35a7-4662-8543-70614b03464d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2a653f50>]}
[0m06:54:50.198237 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (14.0k rows, 1.0 MiB processed)[0m in 3.69s]
[0m06:54:50.199802 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m06:54:50.202268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:50.202990 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m06:54:50.203764 [info ] [MainThread]: 
[0m06:54:50.204621 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m06:54:50.206005 [debug] [MainThread]: Command end result
[0m06:54:50.241095 [info ] [MainThread]: 
[0m06:54:50.242435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:50.243439 [info ] [MainThread]: 
[0m06:54:50.244473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:54:50.245701 [debug] [MainThread]: Command `dbt run` succeeded at 06:54:50.245562 after 11.43 seconds
[0m06:54:50.246548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30568810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac306eb690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac306f8810>]}
[0m06:54:50.247361 [debug] [MainThread]: Flushing usage events
[0m07:01:35.930872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feece1f7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecddb6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecde383d0>]}


============================== 07:01:35.935501 | 87ee1ad8-a3b1-4658-8a5f-d996a8368ec7 ==============================
[0m07:01:35.935501 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:01:35.936611 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True'}
[0m07:01:36.413761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecbd61390>]}
[0m07:01:36.431788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecbb8ef90>]}
[0m07:01:36.433666 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:01:36.503076 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:01:39.258896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:01:39.260503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:01:39.270454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecdee3d10>]}
[0m07:01:39.301435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecbb9b2d0>]}
[0m07:01:39.302697 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:01:39.303843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed0e241d0>]}
[0m07:01:39.306967 [info ] [MainThread]: 
[0m07:01:39.309128 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:01:39.312713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_warehouse'
[0m07:01:39.313884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:52.698059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:01:52.700286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:04.692639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:02:04.694348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:17.268809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87ee1ad8-a3b1-4658-8a5f-d996a8368ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecbb99710>]}
[0m07:02:17.270835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:02:17.272131 [info ] [MainThread]: 
[0m07:02:17.288408 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:02:17.289513 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [RUN]
[0m07:02:17.290852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2)
[0m07:02:17.291691 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:02:17.310521 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m07:02:17.318711 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (compile): 07:02:17.292343 => 07:02:17.318270
[0m07:02:17.319674 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:02:17.340719 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m07:02:17.348793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:17.352456 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        year, car_model, type
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    group by year, car_model, type
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:02:30.700299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:861590eb-85fc-470e-a5e8-c401daf63cef&page=queryresults
[0m07:02:30.703109 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (execute): 07:02:17.320344 => 07:02:30.702835
[0m07:02:30.704780 [info ] [Thread-1 (]: 1 of 10 PASS dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [[32mPASS[0m in 13.41s]
[0m07:02:30.706569 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:02:30.707838 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:02:30.708870 [info ] [Thread-1 (]: 2 of 10 START test dbt_utils_unique_combination_of_columns_date_dim_date_key__date  [RUN]
[0m07:02:30.710251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd)
[0m07:02:30.711094 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:02:30.717561 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m07:02:30.726255 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (compile): 07:02:30.711770 => 07:02:30.725839
[0m07:02:30.727141 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:02:30.730951 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m07:02:30.737983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:30.741668 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, date
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
    group by date_key, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:02:43.827406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d62b1241-4720-463e-bc37-fd8ec3121256&page=queryresults
[0m07:02:43.829872 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (execute): 07:02:30.727830 => 07:02:43.829554
[0m07:02:43.831874 [info ] [Thread-1 (]: 2 of 10 PASS dbt_utils_unique_combination_of_columns_date_dim_date_key__date ... [[32mPASS[0m in 13.12s]
[0m07:02:43.833604 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:02:43.834800 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:02:43.835812 [info ] [Thread-1 (]: 3 of 10 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m07:02:43.837273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m07:02:43.838220 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:02:43.864816 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:02:43.872825 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 07:02:43.839013 => 07:02:43.872433
[0m07:02:43.873693 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:02:43.877451 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:02:43.884816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:43.888562 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:02:55.858353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:448311dd-7d8e-40d4-ba8e-b7c6c1c018d3&page=queryresults
[0m07:02:55.860138 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 07:02:43.874333 => 07:02:55.859838
[0m07:02:55.861823 [info ] [Thread-1 (]: 3 of 10 PASS dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[32mPASS[0m in 12.02s]
[0m07:02:55.863336 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:02:55.864476 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m07:02:55.865450 [info ] [Thread-1 (]: 4 of 10 START test dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation  [RUN]
[0m07:02:55.866844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc)
[0m07:02:55.867773 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m07:02:55.875899 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"
[0m07:02:55.884715 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc (compile): 07:02:55.868532 => 07:02:55.884157
[0m07:02:55.885858 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m07:02:55.889859 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"
[0m07:02:55.897154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:55.901182 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state, geolocation
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    group by suburb, state, geolocation
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:02:57.006743 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Grouping by expressions of type GEOGRAPHY is not allowed at [18:29]')
[0m07:02:58.234905 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:7f9de645-47ab-4f70-bf01-74fa22627298&page=queryresults
[0m07:02:58.237001 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc (execute): 07:02:55.886627 => 07:02:58.236671
[0m07:02:58.242999 [debug] [Thread-1 (]: Database Error in test dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation (models/warehouse/schema.yml)
  Grouping by expressions of type GEOGRAPHY is not allowed at [18:29]
  compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_b1dc50caccdb479faed998a489ff8c50.sql
[0m07:02:58.244245 [error] [Thread-1 (]: 4 of 10 ERROR dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation  [[31mERROR[0m in 2.38s]
[0m07:02:58.245458 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc
[0m07:02:58.246593 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:02:58.247755 [info ] [Thread-1 (]: 5 of 10 START test not_null_car_dim_car_key .................................... [RUN]
[0m07:02:58.249353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation.484504c3cc, now test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339)
[0m07:02:58.250409 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:02:58.258625 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m07:02:58.266536 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (compile): 07:02:58.251173 => 07:02:58.266178
[0m07:02:58.267386 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:02:58.270915 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m07:02:58.278683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:58.282580 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select car_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
where car_key is null



      
    ) dbt_internal_test
[0m07:03:11.138749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:15e11f87-a5d2-4176-b5dc-651336aa1d87&page=queryresults
[0m07:03:11.140602 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (execute): 07:02:58.267968 => 07:03:11.140334
[0m07:03:11.142190 [info ] [Thread-1 (]: 5 of 10 PASS not_null_car_dim_car_key .......................................... [[32mPASS[0m in 12.89s]
[0m07:03:11.143758 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:03:11.145349 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:03:11.146380 [info ] [Thread-1 (]: 6 of 10 START test not_null_date_dim_date_key .................................. [RUN]
[0m07:03:11.147817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339, now test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe)
[0m07:03:11.148801 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:03:11.167079 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"
[0m07:03:11.175660 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe (compile): 07:03:11.149633 => 07:03:11.175208
[0m07:03:11.176685 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:03:11.180431 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"
[0m07:03:11.188095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:11.192207 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
where date_key is null



      
    ) dbt_internal_test
[0m07:03:13.035118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:dfac86f9-8894-4954-910b-798cf1bfbc96&page=queryresults
[0m07:03:13.037012 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe (execute): 07:03:11.177413 => 07:03:13.036734
[0m07:03:13.038588 [info ] [Thread-1 (]: 6 of 10 PASS not_null_date_dim_date_key ........................................ [[32mPASS[0m in 1.89s]
[0m07:03:13.040334 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:03:13.041509 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:03:13.042496 [info ] [Thread-1 (]: 7 of 10 START test not_null_location_dim_location_key .......................... [RUN]
[0m07:03:13.043956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe, now test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76)
[0m07:03:13.044887 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:03:13.051406 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:03:13.059135 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (compile): 07:03:13.045733 => 07:03:13.058783
[0m07:03:13.060090 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:03:13.063968 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:03:13.072465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:13.076664 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
where location_key is null



      
    ) dbt_internal_test
[0m07:03:14.891587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6980fb65-9d8d-4cef-aa19-a235245c78e4&page=queryresults
[0m07:03:14.893426 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (execute): 07:03:13.060807 => 07:03:14.893159
[0m07:03:14.895017 [info ] [Thread-1 (]: 7 of 10 PASS not_null_location_dim_location_key ................................ [[32mPASS[0m in 1.85s]
[0m07:03:14.896668 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:03:14.897936 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:03:14.899181 [info ] [Thread-1 (]: 8 of 10 START test unique_car_dim_car_key ...................................... [RUN]
[0m07:03:14.900755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76, now test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4)
[0m07:03:14.901683 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:03:14.912083 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m07:03:14.920578 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (compile): 07:03:14.902450 => 07:03:14.920151
[0m07:03:14.921781 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:03:14.925331 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m07:03:14.933041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:14.936826 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select car_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
  where car_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:03:24.376568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:8d27e6d7-d7a8-4a1b-ade6-f2cf6b71283e&page=queryresults
[0m07:03:24.378350 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (execute): 07:03:14.922458 => 07:03:24.378064
[0m07:03:24.380050 [info ] [Thread-1 (]: 8 of 10 PASS unique_car_dim_car_key ............................................ [[32mPASS[0m in 9.48s]
[0m07:03:24.381607 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:03:24.383064 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:03:24.384004 [info ] [Thread-1 (]: 9 of 10 START test unique_date_dim_date_key .................................... [RUN]
[0m07:03:24.385491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4, now test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1)
[0m07:03:24.386462 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:03:24.392677 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"
[0m07:03:24.401193 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1 (compile): 07:03:24.387252 => 07:03:24.400776
[0m07:03:24.402659 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:03:24.406951 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"
[0m07:03:24.414572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:24.418590 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
  where date_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:03:26.354067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4d27ed0d-5e05-425d-880f-90e177eb29c7&page=queryresults
[0m07:03:26.355695 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1 (execute): 07:03:24.403561 => 07:03:26.355454
[0m07:03:26.357036 [info ] [Thread-1 (]: 9 of 10 PASS unique_date_dim_date_key .......................................... [[32mPASS[0m in 1.97s]
[0m07:03:26.358294 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:03:26.359377 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:03:26.360227 [info ] [Thread-1 (]: 10 of 10 START test unique_location_dim_location_key ........................... [RUN]
[0m07:03:26.361532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1, now test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91)
[0m07:03:26.362310 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:03:26.367608 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:03:26.376471 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (compile): 07:03:26.362969 => 07:03:26.375839
[0m07:03:26.377881 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:03:26.381921 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:03:26.389192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:26.393149 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
  where location_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:03:28.346113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:0a219666-e427-4366-82d5-7fc4b0078a72&page=queryresults
[0m07:03:28.347979 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (execute): 07:03:26.378712 => 07:03:28.347711
[0m07:03:28.349626 [info ] [Thread-1 (]: 10 of 10 PASS unique_location_dim_location_key ................................. [[32mPASS[0m in 1.99s]
[0m07:03:28.351080 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:03:28.354246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:03:28.355037 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91' was properly closed.
[0m07:03:28.355939 [info ] [MainThread]: 
[0m07:03:28.357027 [info ] [MainThread]: Finished running 10 tests in 0 hours 1 minutes and 49.05 seconds (109.05s).
[0m07:03:28.360803 [debug] [MainThread]: Command end result
[0m07:03:28.388675 [info ] [MainThread]: 
[0m07:03:28.390249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:03:28.391285 [info ] [MainThread]: 
[0m07:03:28.392210 [error] [MainThread]: [33mDatabase Error in test dbt_utils_unique_combination_of_columns_location_dim_suburb__state__geolocation (models/warehouse/schema.yml)[0m
[0m07:03:28.393129 [error] [MainThread]:   Grouping by expressions of type GEOGRAPHY is not allowed at [18:29]
[0m07:03:28.393970 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_b1dc50caccdb479faed998a489ff8c50.sql
[0m07:03:28.394879 [info ] [MainThread]: 
[0m07:03:28.395848 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m07:03:28.397129 [debug] [MainThread]: Command `dbt test` failed at 07:03:28.396981 after 112.48 seconds
[0m07:03:28.398052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feece095a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecd856bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feecdc904d0>]}
[0m07:03:28.398865 [debug] [MainThread]: Flushing usage events
[0m07:06:06.626206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe0f0ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe21c7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe142dc10>]}


============================== 07:06:06.631725 | fefd10f9-4f31-42b3-ad1c-2bfcf5319371 ==============================
[0m07:06:06.631725 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:06:06.633238 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True'}
[0m07:06:07.087689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdea97790>]}
[0m07:06:07.103850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdea96c10>]}
[0m07:06:07.105810 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:06:07.168090 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:06:09.627168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:06:09.629068 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/schema.yml
[0m07:06:09.655290 [debug] [MainThread]: 1603: static parser failed on warehouse/location_dim.sql
[0m07:06:09.675379 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/location_dim.sql
[0m07:06:09.748466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbde964990>]}
[0m07:06:09.772665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbde6c8510>]}
[0m07:06:09.773962 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:06:09.775083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbde7fc190>]}
[0m07:06:09.777484 [info ] [MainThread]: 
[0m07:06:09.778992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:06:09.781135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_staging'
[0m07:06:09.782001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:10.914638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:06:10.916439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:11.847160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:06:11.849325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:13.201086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefd10f9-4f31-42b3-ad1c-2bfcf5319371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbde8db710>]}
[0m07:06:13.203204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:06:13.204307 [info ] [MainThread]: 
[0m07:06:13.222761 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:06:13.224361 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_unique_combination_of_columns_location_dim_suburb__state  [RUN]
[0m07:06:13.225762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9)
[0m07:06:13.226804 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:06:13.238196 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"
[0m07:06:13.247439 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9 (compile): 07:06:13.227717 => 07:06:13.246947
[0m07:06:13.248485 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:06:13.269009 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"
[0m07:06:13.277495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:13.282481 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    group by suburb, state
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:06:15.765818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:6759df1c-c9f3-4a06-8166-1b718f48f110&page=queryresults
[0m07:06:15.768780 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9 (execute): 07:06:13.249221 => 07:06:15.768475
[0m07:06:15.770657 [error] [Thread-1 (]: 1 of 3 FAIL 37 dbt_utils_unique_combination_of_columns_location_dim_suburb__state  [[31mFAIL 37[0m in 2.55s]
[0m07:06:15.772700 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:06:15.773991 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:06:15.775049 [info ] [Thread-1 (]: 2 of 3 START test not_null_location_dim_location_key ........................... [RUN]
[0m07:06:15.776418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9, now test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76)
[0m07:06:15.777282 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:06:15.786577 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:06:15.795564 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (compile): 07:06:15.778106 => 07:06:15.795108
[0m07:06:15.801661 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:06:15.805509 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:06:15.813129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:15.817196 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
where location_key is null



      
    ) dbt_internal_test
[0m07:06:17.642043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:d0b31c9f-22fe-44a2-b05d-c8bef481f93a&page=queryresults
[0m07:06:17.644100 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (execute): 07:06:15.802458 => 07:06:17.643805
[0m07:06:17.645727 [info ] [Thread-1 (]: 2 of 3 PASS not_null_location_dim_location_key ................................. [[32mPASS[0m in 1.87s]
[0m07:06:17.647199 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:06:17.648430 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:06:17.649529 [info ] [Thread-1 (]: 3 of 3 START test unique_location_dim_location_key ............................. [RUN]
[0m07:06:17.650979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76, now test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91)
[0m07:06:17.651860 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:06:17.662907 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:06:17.671046 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (compile): 07:06:17.652616 => 07:06:17.670648
[0m07:06:17.672016 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:06:17.681485 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:06:17.689420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:17.693501 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
  where location_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:06:19.345032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:769f24c3-b80d-4b0c-a8cd-3f512829f57d&page=queryresults
[0m07:06:19.346864 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (execute): 07:06:17.672708 => 07:06:19.346530
[0m07:06:19.348575 [info ] [Thread-1 (]: 3 of 3 PASS unique_location_dim_location_key ................................... [[32mPASS[0m in 1.70s]
[0m07:06:19.350109 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:06:19.353202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:06:19.354110 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91' was properly closed.
[0m07:06:19.355001 [info ] [MainThread]: 
[0m07:06:19.356069 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m07:06:19.358166 [debug] [MainThread]: Command end result
[0m07:06:19.383680 [info ] [MainThread]: 
[0m07:06:19.384902 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:06:19.385835 [info ] [MainThread]: 
[0m07:06:19.386798 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_location_dim_suburb__state (models/warehouse/schema.yml)[0m
[0m07:06:19.387706 [error] [MainThread]:   Got 37 results, configured to fail if != 0
[0m07:06:19.388575 [info ] [MainThread]: 
[0m07:06:19.389579 [info ] [MainThread]:   compiled Code at target/compiled/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_c9646389e0422b5cee72c7abfd150470.sql
[0m07:06:19.390669 [info ] [MainThread]: 
[0m07:06:19.391847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:06:19.393220 [debug] [MainThread]: Command `dbt test` failed at 07:06:19.393033 after 12.79 seconds
[0m07:06:19.394194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe0a81dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe4ac0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe4a34390>]}
[0m07:06:19.395121 [debug] [MainThread]: Flushing usage events
[0m07:33:03.716330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9487f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba94465d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9455dcd0>]}


============================== 07:33:03.721432 | 1f36d0a5-0bef-4f81-bdb5-8752e414e297 ==============================
[0m07:33:03.721432 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:33:03.722780 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None'}
[0m07:33:04.178271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba923fbf50>]}
[0m07:33:04.194468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba93f24310>]}
[0m07:33:04.195949 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:33:04.259576 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:33:06.594782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:33:06.596247 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/locations_staging.sql
[0m07:33:06.624313 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m07:33:06.707260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9223e7d0>]}
[0m07:33:06.730412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba92200690>]}
[0m07:33:06.731574 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:33:06.732908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba974c7d50>]}
[0m07:33:06.735297 [info ] [MainThread]: 
[0m07:33:06.736751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:33:06.739170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:33:06.740120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:08.209294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:33:08.210723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:09.017604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:33:09.019742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:09.834997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:33:09.836773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:11.206734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba923e4810>]}
[0m07:33:11.208762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:33:11.209891 [info ] [MainThread]: 
[0m07:33:11.227076 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m07:33:11.228347 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m07:33:11.229686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listings_staging)
[0m07:33:11.230630 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m07:33:11.239505 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:33:11.246944 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 07:33:11.231731 => 07:33:11.246598
[0m07:33:11.248164 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m07:33:11.263787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:12.126514 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:33:12.133880 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null
    and price != 'For Auction' 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) = 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then replace(regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2'), '\\1\\2', 'LANDCRUISER')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m07:33:14.696362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:312ca9ef-f865-4221-ab14-8295b8f285d3&page=queryresults
[0m07:33:14.714736 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 07:33:11.248944 => 07:33:14.714479
[0m07:33:14.716121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba923e4510>]}
[0m07:33:14.717232 [info ] [Thread-1 (]: 1 of 2 OK created sql table model autotrader_staging.listings_staging .......... [[32mCREATE TABLE (13.4k rows, 1.2 MiB processed)[0m in 3.49s]
[0m07:33:14.718749 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m07:33:14.719801 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m07:33:14.720700 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m07:33:14.721976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m07:33:14.722724 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m07:33:14.726658 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:33:14.734375 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 07:33:14.723327 => 07:33:14.733927
[0m07:33:14.735690 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m07:33:14.739029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:15.622373 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:33:15.630405 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      with uppercase_suburbs as (
    select 
    distinct
    upper(suburb) as suburb,
    state 
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where suburb is not null)

check_duplicates_australian_suburbs as (
    select
    suburb,
    state,
    latitude,
    longitude,
    row_number() over (partition by suburb, state) as row_num
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs`
)

select 
uppercase_suburbs.suburb as suburb,
uppercase_suburbs.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
uppercase_suburbs
join check_duplicates_australian_suburbs
on uppercase_suburbs.suburb = check_duplicates_australian_suburbs.suburb
and uppercase_suburbs.state = check_duplicates_australian_suburbs.state
where check_duplicates_australian_suburbs.row_num = 1
    );
  
[0m07:33:15.911116 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "check_duplicates_australian_suburbs" at [20:1]')
[0m07:33:16.618217 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2fcf9dc1-b616-47fd-95eb-4fa2342889ca&page=queryresults
[0m07:33:16.620142 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 07:33:14.736412 => 07:33:16.619837
[0m07:33:16.626388 [debug] [Thread-1 (]: Database Error in model locations_staging (models/staging/locations_staging.sql)
  Syntax error: Unexpected identifier "check_duplicates_australian_suburbs" at [20:1]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/locations_staging.sql
[0m07:33:16.627748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f36d0a5-0bef-4f81-bdb5-8752e414e297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba921e7ed0>]}
[0m07:33:16.629117 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model autotrader_staging.locations_staging ..... [[31mERROR[0m in 1.91s]
[0m07:33:16.630486 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m07:33:16.633482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:16.634245 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m07:33:16.634919 [info ] [MainThread]: 
[0m07:33:16.635922 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m07:33:16.637567 [debug] [MainThread]: Command end result
[0m07:33:16.667559 [info ] [MainThread]: 
[0m07:33:16.668826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:33:16.669821 [info ] [MainThread]: 
[0m07:33:16.670701 [error] [MainThread]: [33mDatabase Error in model locations_staging (models/staging/locations_staging.sql)[0m
[0m07:33:16.671603 [error] [MainThread]:   Syntax error: Unexpected identifier "check_duplicates_australian_suburbs" at [20:1]
[0m07:33:16.672468 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/locations_staging.sql
[0m07:33:16.673296 [info ] [MainThread]: 
[0m07:33:16.674222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:33:16.675444 [debug] [MainThread]: Command `dbt run` failed at 07:33:16.675309 after 12.98 seconds
[0m07:33:16.676423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba93eeb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba93efe0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba946b4f90>]}
[0m07:33:16.677332 [debug] [MainThread]: Flushing usage events
[0m07:33:51.557738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd15ad910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd1290910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd1293e90>]}


============================== 07:33:51.562490 | 08367790-8352-48e4-8c46-26c9934f7024 ==============================
[0m07:33:51.562490 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:33:51.563670 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'debug': 'False', 'indirect_selection': 'eager'}
[0m07:33:51.997809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafcf137b90>]}
[0m07:33:52.014416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd0c222d0>]}
[0m07:33:52.016718 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:33:52.075052 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:33:54.420843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:33:54.422165 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/locations_staging.sql
[0m07:33:54.448182 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m07:33:54.533728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafcefc5f50>]}
[0m07:33:54.556859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafced58610>]}
[0m07:33:54.557898 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:33:54.558980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd41f01d0>]}
[0m07:33:54.561240 [info ] [MainThread]: 
[0m07:33:54.562669 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:33:54.564340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:33:54.565123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:57.030480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:33:57.031893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:58.365657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:33:58.367110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:59.206248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:33:59.208341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:00.085614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafcf14f650>]}
[0m07:34:00.087254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:00.088450 [info ] [MainThread]: 
[0m07:34:00.104639 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m07:34:00.105889 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m07:34:00.107542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listings_staging)
[0m07:34:00.108572 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m07:34:00.117020 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:34:00.124237 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 07:34:00.109619 => 07:34:00.123853
[0m07:34:00.125175 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m07:34:00.140502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:00.988785 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:34:00.996374 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null
    and price != 'For Auction' 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) = 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then replace(regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2'), '\\1\\2', 'LANDCRUISER')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m07:34:03.614868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:971d55ab-6092-4470-beaa-46fb0a8c7a16&page=queryresults
[0m07:34:03.632341 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 07:34:00.125862 => 07:34:03.632091
[0m07:34:03.634920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafcee6d110>]}
[0m07:34:03.636423 [info ] [Thread-1 (]: 1 of 2 OK created sql table model autotrader_staging.listings_staging .......... [[32mCREATE TABLE (13.4k rows, 1.2 MiB processed)[0m in 3.53s]
[0m07:34:03.638075 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m07:34:03.639194 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m07:34:03.640187 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m07:34:03.641480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m07:34:03.642233 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m07:34:03.646558 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:34:03.654028 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 07:34:03.642883 => 07:34:03.653572
[0m07:34:03.655436 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m07:34:03.659809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:04.495475 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:34:04.503419 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      with uppercase_suburbs as (
    select 
    distinct
    upper(suburb) as suburb,
    state 
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where suburb is not null),

check_duplicates_australian_suburbs as (
    select
    suburb,
    state,
    latitude,
    longitude,
    row_number() over (partition by suburb, state) as row_num
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs`
)

select 
uppercase_suburbs.suburb as suburb,
uppercase_suburbs.state as state,
australian_suburbs.latitude as latitude,
australian_suburbs.longitude as longitude
from
uppercase_suburbs
join check_duplicates_australian_suburbs
on uppercase_suburbs.suburb = check_duplicates_australian_suburbs.suburb
and uppercase_suburbs.state = check_duplicates_australian_suburbs.state
where check_duplicates_australian_suburbs.row_num = 1
    );
  
[0m07:34:05.425192 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: australian_suburbs at [33:1]')
[0m07:34:07.301100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a75cc58c-4e79-43c6-b431-a42c768910dd&page=queryresults
[0m07:34:07.302937 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 07:34:03.656746 => 07:34:07.302644
[0m07:34:07.308522 [debug] [Thread-1 (]: Database Error in model locations_staging (models/staging/locations_staging.sql)
  Unrecognized name: australian_suburbs at [33:1]
  compiled Code at target/run/autotrader_toyota_dbt/models/staging/locations_staging.sql
[0m07:34:07.309609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08367790-8352-48e4-8c46-26c9934f7024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafcefc9050>]}
[0m07:34:07.311001 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model autotrader_staging.locations_staging ..... [[31mERROR[0m in 3.67s]
[0m07:34:07.312326 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m07:34:07.315265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:07.316406 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m07:34:07.317436 [info ] [MainThread]: 
[0m07:34:07.318354 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m07:34:07.319719 [debug] [MainThread]: Command end result
[0m07:34:07.348233 [info ] [MainThread]: 
[0m07:34:07.349621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:34:07.350614 [info ] [MainThread]: 
[0m07:34:07.351550 [error] [MainThread]: [33mDatabase Error in model locations_staging (models/staging/locations_staging.sql)[0m
[0m07:34:07.352527 [error] [MainThread]:   Unrecognized name: australian_suburbs at [33:1]
[0m07:34:07.353457 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/staging/locations_staging.sql
[0m07:34:07.354359 [info ] [MainThread]: 
[0m07:34:07.355272 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:34:07.356544 [debug] [MainThread]: Command `dbt run` failed at 07:34:07.356394 after 15.82 seconds
[0m07:34:07.357428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd1105590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd14417d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd15afe90>]}
[0m07:34:07.358388 [debug] [MainThread]: Flushing usage events
[0m07:34:37.795591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8783b0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87844b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87841c390>]}


============================== 07:34:37.800245 | 0cb794a1-2820-489b-bf9f-b5472327b0d3 ==============================
[0m07:34:37.800245 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:34:37.801604 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False'}
[0m07:34:38.238885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876253610>]}
[0m07:34:38.255293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876226850>]}
[0m07:34:38.256753 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:34:38.321184 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:34:40.616822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:34:40.618203 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/locations_staging.sql
[0m07:34:40.643532 [debug] [MainThread]: 1699: static parser successfully parsed staging/locations_staging.sql
[0m07:34:40.727294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8761297d0>]}
[0m07:34:40.750548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87603cd50>]}
[0m07:34:40.751718 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:34:40.752902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b34f950>]}
[0m07:34:40.755162 [info ] [MainThread]: 
[0m07:34:40.756644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:34:40.758454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:34:40.759284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:41.952229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:34:41.953492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:42.752629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:34:42.754261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:43.577547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:34:43.579604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:44.864045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8783b0410>]}
[0m07:34:44.865723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:44.866985 [info ] [MainThread]: 
[0m07:34:44.882712 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m07:34:44.884114 [info ] [Thread-1 (]: 1 of 2 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m07:34:44.885988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listings_staging)
[0m07:34:44.886966 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m07:34:44.895270 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:34:44.902808 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 07:34:44.887979 => 07:34:44.902427
[0m07:34:44.903718 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m07:34:44.919091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:45.845580 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:34:45.853480 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null
    and price != 'For Auction' 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) = 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then replace(regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2'), '\\1\\2', 'LANDCRUISER')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select * from modified_types
    );
  
[0m07:34:48.650913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:78ed7a1c-def8-4c29-af01-2a73930df1b8&page=queryresults
[0m07:34:48.667423 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 07:34:44.904362 => 07:34:48.667175
[0m07:34:48.669479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8762605d0>]}
[0m07:34:48.670618 [info ] [Thread-1 (]: 1 of 2 OK created sql table model autotrader_staging.listings_staging .......... [[32mCREATE TABLE (13.4k rows, 1.2 MiB processed)[0m in 3.78s]
[0m07:34:48.671949 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m07:34:48.672898 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.locations_staging
[0m07:34:48.673792 [info ] [Thread-1 (]: 2 of 2 START sql table model autotrader_staging.locations_staging .............. [RUN]
[0m07:34:48.674933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.listings_staging, now model.autotrader_toyota_dbt.locations_staging)
[0m07:34:48.675684 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.locations_staging
[0m07:34:48.680007 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:34:48.687948 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (compile): 07:34:48.676318 => 07:34:48.687525
[0m07:34:48.688894 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.locations_staging
[0m07:34:48.692333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:50.690907 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.locations_staging"
[0m07:34:50.698943 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.locations_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.locations_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging`
    
    

    OPTIONS()
    as (
      with uppercase_suburbs as (
    select 
    distinct
    upper(suburb) as suburb,
    state 
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where suburb is not null),

check_duplicates_australian_suburbs as (
    select
    suburb,
    state,
    latitude,
    longitude,
    row_number() over (partition by suburb, state) as row_num
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`australian_suburbs`
)

select 
uppercase_suburbs.suburb as suburb,
uppercase_suburbs.state as state,
check_duplicates_australian_suburbs.latitude as latitude,
check_duplicates_australian_suburbs.longitude as longitude
from
uppercase_suburbs
join check_duplicates_australian_suburbs
on uppercase_suburbs.suburb = check_duplicates_australian_suburbs.suburb
and uppercase_suburbs.state = check_duplicates_australian_suburbs.state
where check_duplicates_australian_suburbs.row_num = 1
    );
  
[0m07:34:53.494398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:4dc049d6-0c7c-4097-a510-c1f51040b6c1&page=queryresults
[0m07:34:53.497511 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.locations_staging (execute): 07:34:48.689538 => 07:34:53.497297
[0m07:34:53.498706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb794a1-2820-489b-bf9f-b5472327b0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb875fe0950>]}
[0m07:34:53.499769 [info ] [Thread-1 (]: 2 of 2 OK created sql table model autotrader_staging.locations_staging ......... [[32mCREATE TABLE (563.0 rows, 801.2 KiB processed)[0m in 4.82s]
[0m07:34:53.501123 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.locations_staging
[0m07:34:53.503634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:53.504317 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.locations_staging' was properly closed.
[0m07:34:53.505133 [info ] [MainThread]: 
[0m07:34:53.505929 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m07:34:53.507396 [debug] [MainThread]: Command end result
[0m07:34:53.538036 [info ] [MainThread]: 
[0m07:34:53.539523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:34:53.540744 [info ] [MainThread]: 
[0m07:34:53.542012 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:34:53.543362 [debug] [MainThread]: Command `dbt run` succeeded at 07:34:53.543213 after 15.76 seconds
[0m07:34:53.544226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb877f01990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87839f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87c2dc790>]}
[0m07:34:53.544980 [debug] [MainThread]: Flushing usage events
[0m07:36:07.046866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d95d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d8183d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d95de10>]}


============================== 07:36:07.051636 | aa45ca20-e121-41a0-aec4-253557d99e02 ==============================
[0m07:36:07.051636 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:36:07.052828 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None'}
[0m07:36:07.494921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d19da10>]}
[0m07:36:07.510910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d837710>]}
[0m07:36:07.512257 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:36:07.573451 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:36:09.974830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:09.975773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:09.983435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b4c7210>]}
[0m07:36:10.008172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b6ba850>]}
[0m07:36:10.009415 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:36:10.010665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811076fd10>]}
[0m07:36:10.012901 [info ] [MainThread]: 
[0m07:36:10.014322 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:36:10.016147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:36:10.016932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:11.380706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:36:11.381935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:12.723229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:36:12.724741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:13.534949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:36:13.537333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:14.366807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b6b6e10>]}
[0m07:36:14.368527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:14.369628 [info ] [MainThread]: 
[0m07:36:14.387489 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.car_dim
[0m07:36:14.388742 [info ] [Thread-1 (]: 1 of 4 START sql incremental model autotrader_warehouse.car_dim ................ [RUN]
[0m07:36:14.390068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.car_dim)
[0m07:36:14.390918 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.car_dim
[0m07:36:14.405304 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.car_dim"
[0m07:36:14.412818 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (compile): 07:36:14.391664 => 07:36:14.412423
[0m07:36:14.413807 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.car_dim
[0m07:36:14.450542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:15.383944 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.car_dim"
[0m07:36:15.391035 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.car_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.car_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` as DBT_INTERNAL_DEST
        using (

with distinct_cars as (
    select
    distinct
    year,
    car_model,
    type
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(car_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`) as car_key,
*
from distinct_cars distinct_cars


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    where car_dim.year = distinct_cars.year
    and car_dim.car_model = distinct_cars.car_model
    and car_dim.type = distinct_cars.type
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`car_key`, `year`, `car_model`, `type`)
    values
        (`car_key`, `year`, `car_model`, `type`)


    
[0m07:36:17.626595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:321a62c4-56cc-4a8f-b600-ffc1f28de09d&page=queryresults
[0m07:36:17.642308 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.car_dim (execute): 07:36:14.414488 => 07:36:17.642090
[0m07:36:17.643813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b43e110>]}
[0m07:36:17.644993 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model autotrader_warehouse.car_dim ........... [[32mMERGE (2.7k rows, 411.8 KiB processed)[0m in 3.25s]
[0m07:36:17.646622 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.car_dim
[0m07:36:17.648200 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.date_dim
[0m07:36:17.649160 [info ] [Thread-1 (]: 2 of 4 START sql incremental model autotrader_warehouse.date_dim ............... [RUN]
[0m07:36:17.650436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.car_dim, now model.autotrader_toyota_dbt.date_dim)
[0m07:36:17.651185 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.date_dim
[0m07:36:17.656059 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.date_dim"
[0m07:36:17.663737 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (compile): 07:36:17.651836 => 07:36:17.663302
[0m07:36:17.664815 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.date_dim
[0m07:36:17.679928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:18.551601 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.date_dim"
[0m07:36:18.559784 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.date_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.date_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` as DBT_INTERNAL_DEST
        using (

with distinct_dates as (
    select
    distinct
    date
    from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
)

select
row_number() over () + (select coalesce(max(date_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`) as date_key,
date
from distinct_dates


where date not in (select date from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `date`)
    values
        (`date_key`, `date`)


    
[0m07:36:21.016627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:5ded29d1-9c9c-4223-8e2d-fa6bb1145f63&page=queryresults
[0m07:36:21.019612 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.date_dim (execute): 07:36:17.665569 => 07:36:21.019369
[0m07:36:21.021146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b309ed0>]}
[0m07:36:21.022317 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model autotrader_warehouse.date_dim .......... [[32mMERGE (0.0 rows, 105.1 KiB processed)[0m in 3.37s]
[0m07:36:21.023916 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.date_dim
[0m07:36:21.025083 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.location_dim
[0m07:36:21.026070 [info ] [Thread-1 (]: 3 of 4 START sql incremental model autotrader_warehouse.location_dim ........... [RUN]
[0m07:36:21.027360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.date_dim, now model.autotrader_toyota_dbt.location_dim)
[0m07:36:21.028303 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.location_dim
[0m07:36:21.033277 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.location_dim"
[0m07:36:21.040835 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (compile): 07:36:21.029051 => 07:36:21.040430
[0m07:36:21.041936 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.location_dim
[0m07:36:21.046875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:21.893238 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.location_dim"
[0m07:36:21.901206 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.location_dim"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` as DBT_INTERNAL_DEST
        using (

select
row_number() over () + (select coalesce(max(location_key), 0) from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`) as location_key,
suburb,
state,
st_geogpoint(longitude, latitude) as geolocation
from `autotrader-toyota-dashboard`.`autotrader_staging`.`locations_staging` locations_staging


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    where location_dim.suburb = locations_staging.suburb
    and location_dim.state = locations_staging.state
)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`location_key`, `suburb`, `state`, `geolocation`)
    values
        (`location_key`, `suburb`, `state`, `geolocation`)


    
[0m07:36:24.168536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:80b814fb-24f5-47a5-aca6-6fe24c8683f1&page=queryresults
[0m07:36:24.171460 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.location_dim (execute): 07:36:21.043057 => 07:36:24.171210
[0m07:36:24.172779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b6cb610>]}
[0m07:36:24.173960 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model autotrader_warehouse.location_dim ...... [[32mMERGE (563.0 rows, 17.7 KiB processed)[0m in 3.15s]
[0m07:36:24.175869 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.location_dim
[0m07:36:24.177681 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m07:36:24.178638 [info ] [Thread-1 (]: 4 of 4 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m07:36:24.179955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.autotrader_toyota_dbt.location_dim, now model.autotrader_toyota_dbt.listing_fact)
[0m07:36:24.180723 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m07:36:24.185844 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:36:24.193182 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 07:36:24.181320 => 07:36:24.192742
[0m07:36:24.194159 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m07:36:24.198453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:25.060745 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:36:25.070490 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
distinct
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m07:36:27.617511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ea27c690-7463-40ba-be2f-19ffb77249bc&page=queryresults
[0m07:36:27.620297 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 07:36:24.194810 => 07:36:27.620063
[0m07:36:27.621647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa45ca20-e121-41a0-aec4-253557d99e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810b57f350>]}
[0m07:36:27.622824 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (12.9k rows, 1.0 MiB processed)[0m in 3.44s]
[0m07:36:27.624634 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m07:36:27.627329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:27.628084 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m07:36:27.628828 [info ] [MainThread]: 
[0m07:36:27.629683 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 17.61 seconds (17.61s).
[0m07:36:27.631454 [debug] [MainThread]: Command end result
[0m07:36:27.664699 [info ] [MainThread]: 
[0m07:36:27.666632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:36:27.667928 [info ] [MainThread]: 
[0m07:36:27.668876 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:36:27.670169 [debug] [MainThread]: Command `dbt run` succeeded at 07:36:27.670021 after 20.64 seconds
[0m07:36:27.671113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d8098d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f810d6ff210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81116ec810>]}
[0m07:36:27.671966 [debug] [MainThread]: Flushing usage events
[0m07:38:12.178793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb570f5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57658f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57a80e90>]}


============================== 07:38:12.183516 | 0217fa62-8471-41d6-bc38-7c55cd51d47a ==============================
[0m07:38:12.183516 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:38:12.184701 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m07:38:12.629927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57775e90>]}
[0m07:38:12.646293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb55610b10>]}
[0m07:38:12.648088 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:38:12.710625 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:38:15.011131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:38:15.012385 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m07:38:15.036370 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m07:38:15.055125 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m07:38:15.116724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb55609390>]}
[0m07:38:15.140263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb55446b10>]}
[0m07:38:15.141516 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:38:15.142581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5a6cb950>]}
[0m07:38:15.144685 [info ] [MainThread]: 
[0m07:38:15.146061 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:38:15.147747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:38:15.148559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:16.481609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:38:16.482811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:17.267869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:38:17.269923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:18.462787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:38:18.464210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:19.311108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb55315250>]}
[0m07:38:19.312703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:38:19.313901 [info ] [MainThread]: 
[0m07:38:19.330030 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m07:38:19.331289 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m07:38:19.332593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listing_fact)
[0m07:38:19.333364 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m07:38:19.344888 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:38:19.351643 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 07:38:19.334036 => 07:38:19.351328
[0m07:38:19.352578 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m07:38:19.388339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:20.261469 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:38:20.269574 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m07:38:22.664387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:1f9caa22-76d7-4675-8abb-7e8965dd698e&page=queryresults
[0m07:38:22.680602 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 07:38:19.353397 => 07:38:22.680384
[0m07:38:22.682404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0217fa62-8471-41d6-bc38-7c55cd51d47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5548dc50>]}
[0m07:38:22.683576 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (13.4k rows, 1.0 MiB processed)[0m in 3.35s]
[0m07:38:22.685079 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m07:38:22.687678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:22.688412 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m07:38:22.689088 [info ] [MainThread]: 
[0m07:38:22.689957 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m07:38:22.691198 [debug] [MainThread]: Command end result
[0m07:38:22.719169 [info ] [MainThread]: 
[0m07:38:22.720493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:38:22.721462 [info ] [MainThread]: 
[0m07:38:22.722426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:38:22.723627 [debug] [MainThread]: Command `dbt run` succeeded at 07:38:22.723489 after 10.57 seconds
[0m07:38:22.724491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57aa6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57aa6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb57926510>]}
[0m07:38:22.725367 [debug] [MainThread]: Flushing usage events
[0m07:38:42.292370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7079a4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa707cba0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70797bf10>]}


============================== 07:38:42.297238 | 69e38622-27e2-4857-8b28-17301ef2fae7 ==============================
[0m07:38:42.297238 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:38:42.298475 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False'}
[0m07:38:42.746649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70565d6d0>]}
[0m07:38:42.763269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7079a74d0>]}
[0m07:38:42.764590 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:38:42.823226 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:38:45.034928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:45.035908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:45.044841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705600ad0>]}
[0m07:38:45.069169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7056bfd90>]}
[0m07:38:45.070307 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:38:45.071464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705367fd0>]}
[0m07:38:45.073620 [info ] [MainThread]: 
[0m07:38:45.075246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:38:45.077452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m07:38:45.078349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:46.308173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:38:46.309673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:47.131963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:38:47.133496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:47.945329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e38622-27e2-4857-8b28-17301ef2fae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7056a9450>]}
[0m07:38:47.947037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:38:47.948153 [info ] [MainThread]: 
[0m07:38:47.967079 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:38:47.968422 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m07:38:47.969842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m07:38:47.970728 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:38:47.991137 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:38:48.000397 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 07:38:47.971385 => 07:38:47.999926
[0m07:38:48.001483 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:38:48.023284 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:38:48.030558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:48.034143 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:38:50.002090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:f56400d8-6ae8-4679-8d61-62803ebebc09&page=queryresults
[0m07:38:50.004697 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 07:38:48.002329 => 07:38:50.004367
[0m07:38:50.006331 [error] [Thread-1 (]: 1 of 1 FAIL 463 dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[31mFAIL 463[0m in 2.04s]
[0m07:38:50.008119 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:38:50.010846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:50.011771 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1' was properly closed.
[0m07:38:50.012629 [info ] [MainThread]: 
[0m07:38:50.013580 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m07:38:50.014931 [debug] [MainThread]: Command end result
[0m07:38:50.044681 [info ] [MainThread]: 
[0m07:38:50.045876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:38:50.047099 [info ] [MainThread]: 
[0m07:38:50.048495 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer (models/warehouse/schema.yml)[0m
[0m07:38:50.049444 [error] [MainThread]:   Got 463 results, configured to fail if != 0
[0m07:38:50.050394 [info ] [MainThread]: 
[0m07:38:50.051318 [info ] [MainThread]:   compiled Code at target/compiled/autotrader_toyota_dbt/models/warehouse/schema.yml/dbt_utils_unique_combination_o_75380346b9f4e88a702deaa78925be15.sql
[0m07:38:50.052297 [info ] [MainThread]: 
[0m07:38:50.053261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:38:50.054406 [debug] [MainThread]: Command `dbt test` failed at 07:38:50.054265 after 7.78 seconds
[0m07:38:50.055281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa707b2e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70781a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70797b450>]}
[0m07:38:50.056182 [debug] [MainThread]: Flushing usage events
[0m07:42:05.893977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a86f4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a83eba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a82821d0>]}


============================== 07:42:05.898656 | e8d9c477-ed29-48a4-87d6-241ec14f6c5b ==============================
[0m07:42:05.898656 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:42:05.899836 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80'}
[0m07:42:06.345078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a62a1ed0>]}
[0m07:42:06.363189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a9795250>]}
[0m07:42:06.364482 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:42:06.426039 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:42:08.694420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:42:08.695701 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/staging/listings_staging.sql
[0m07:42:08.721416 [debug] [MainThread]: 1699: static parser successfully parsed staging/listings_staging.sql
[0m07:42:08.831032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a61026d0>]}
[0m07:42:08.854391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a5ec82d0>]}
[0m07:42:08.855539 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:42:08.856887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab348190>]}
[0m07:42:08.859256 [info ] [MainThread]: 
[0m07:42:08.860849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:42:08.863116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:42:08.864011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:10.300812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:42:10.302196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:11.105229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:42:11.107206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:12.359363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:42:12.360552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:13.196563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a5e109d0>]}
[0m07:42:13.198384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:13.199603 [info ] [MainThread]: 
[0m07:42:13.215648 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_staging
[0m07:42:13.216860 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_staging.listings_staging ............... [RUN]
[0m07:42:13.218149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listings_staging)
[0m07:42:13.218934 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_staging
[0m07:42:13.227727 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:42:13.234262 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (compile): 07:42:13.219673 => 07:42:13.233887
[0m07:42:13.235260 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_staging
[0m07:42:13.251075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:14.114573 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_staging"
[0m07:42:14.121774 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_staging: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_staging"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging`
    
    

    OPTIONS()
    as (
      with remove_empty_values as (
    select
    *
    from `autotrader-toyota-dashboard`.`autotrader_raw`.`listings_raw`
    where date is not null
    and price is not null
    and price != 'For Auction' 
    and odometer is not null
    and year is not null
    and car_model is not null
    and type is not null
    and suburb is not null
    and state is not null
    and right(odometer, 2) = 'km'
),

uppercase_columns as (
    select 
    date,
    price,
    odometer,
    year,
    upper(car_model) as car_model,
    upper(type) as type,
    upper(suburb) as suburb,
    state
    from remove_empty_values
),

format_columns as (
    select
    date,
    replace(replace(price, '$', ''), ',', '') as price,
    replace(replace(odometer, 'km', ''), ',', '') as odometer,
    year,
    case
    when car_model like '%LAND CRUISER%' then replace(regexp_replace(replace(car_model, type, ''), r'(\S+)\s(.+)', r'\\1\\2'), '\\1\\2', 'LANDCRUISER')
    else replace(car_model, type, '')
    end as car_model,
    case
    when type = '' then 'NOT SPECIFIED'
    else replace(replace(type, '(', ''), ')', '')
    end as type,
    ltrim(replace(replace(suburb, '(', ''), ')', '')) as suburb,
    state
    from uppercase_columns
),

modified_types as (
    select
    parse_date('%Y-%m-%d', date) as date,
    cast(price as INT64) as price,
    cast(odometer as INT64) as odometer,
    cast(year as INT64) as year,
    car_model,
    type,
    suburb,
    state
    from format_columns
)

select distinct * from modified_types
    );
  
[0m07:42:17.018614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:a026d553-13c8-4b36-b8b2-b748cba91d4a&page=queryresults
[0m07:42:17.036585 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_staging (execute): 07:42:13.235944 => 07:42:17.036327
[0m07:42:17.038550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d9c477-ed29-48a4-87d6-241ec14f6c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a85bd750>]}
[0m07:42:17.039613 [info ] [Thread-1 (]: 1 of 1 OK created sql table model autotrader_staging.listings_staging .......... [[32mCREATE TABLE (13.0k rows, 1.2 MiB processed)[0m in 3.82s]
[0m07:42:17.041113 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_staging
[0m07:42:17.043603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:17.044315 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_staging' was properly closed.
[0m07:42:17.045081 [info ] [MainThread]: 
[0m07:42:17.046122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m07:42:17.047611 [debug] [MainThread]: Command end result
[0m07:42:17.085861 [info ] [MainThread]: 
[0m07:42:17.087648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:17.089050 [info ] [MainThread]: 
[0m07:42:17.090604 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:42:17.091845 [debug] [MainThread]: Command `dbt run` succeeded at 07:42:17.091701 after 11.21 seconds
[0m07:42:17.092741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a8289b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a822dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ac2ef6d0>]}
[0m07:42:17.093595 [debug] [MainThread]: Flushing usage events
[0m07:44:23.454564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b244e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b244e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b28e2150>]}


============================== 07:44:23.459194 | d3fa61ba-5299-4eda-b29d-d727a55bace7 ==============================
[0m07:44:23.459194 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:44:23.460380 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True'}
[0m07:44:23.910821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b235dd10>]}
[0m07:44:23.927674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b07a4a10>]}
[0m07:44:23.928910 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:44:24.001847 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:44:26.548003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:26.548883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:26.556304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b0599f90>]}
[0m07:44:26.579445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b0813d10>]}
[0m07:44:26.580759 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:44:26.581956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b58af850>]}
[0m07:44:26.584071 [info ] [MainThread]: 
[0m07:44:26.585490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:44:26.587114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m07:44:26.587945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:28.443021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:44:28.444362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:29.285715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:44:29.287341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:30.107054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m07:44:30.109063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:31.511749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b246c9d0>]}
[0m07:44:31.513334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:44:31.514512 [info ] [MainThread]: 
[0m07:44:31.534511 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listing_fact
[0m07:44:31.536188 [info ] [Thread-1 (]: 1 of 1 START sql incremental model autotrader_warehouse.listing_fact ........... [RUN]
[0m07:44:31.538012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listing_fact)
[0m07:44:31.539110 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listing_fact
[0m07:44:31.557540 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:44:31.566243 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (compile): 07:44:31.540265 => 07:44:31.565791
[0m07:44:31.567911 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listing_fact
[0m07:44:31.605519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:32.502517 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listing_fact"
[0m07:44:32.509684 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listing_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listing_fact"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` as DBT_INTERNAL_DEST
        using (

select
date_dim.date_key as date_key,
car_dim.car_key as car_key,
location_dim.location_key as location_key,
listings_staging.price as price,
listings_staging.odometer as odometer
from `autotrader-toyota-dashboard`.`autotrader_staging`.`listings_staging` listings_staging
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
on listings_staging.date = date_dim.date
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
on listings_staging.year = car_dim.year
and listings_staging.car_model = car_dim.car_model
and listings_staging.type = car_dim.type
join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
on listings_staging.suburb = location_dim.suburb
and listings_staging.state = location_dim.state


where not exists (
    select 1
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    where listing_fact.date_key = date_dim.date_key
    and listing_fact.car_key = car_dim.car_key
    and listing_fact.location_key = location_dim.location_key

)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)
    values
        (`date_key`, `car_key`, `location_key`, `price`, `odometer`)


    
[0m07:44:34.883465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2fafb6e0-d98d-4743-98da-44ff3ba03338&page=queryresults
[0m07:44:34.900096 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listing_fact (execute): 07:44:31.569630 => 07:44:34.899869
[0m07:44:34.901537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3fa61ba-5299-4eda-b29d-d727a55bace7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b057a610>]}
[0m07:44:34.902710 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model autotrader_warehouse.listing_fact ...... [[32mMERGE (12.9k rows, 1.0 MiB processed)[0m in 3.36s]
[0m07:44:34.904153 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listing_fact
[0m07:44:34.906643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:34.907335 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listing_fact' was properly closed.
[0m07:44:34.908048 [info ] [MainThread]: 
[0m07:44:34.908894 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m07:44:34.910310 [debug] [MainThread]: Command end result
[0m07:44:34.940893 [info ] [MainThread]: 
[0m07:44:34.942425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:34.943679 [info ] [MainThread]: 
[0m07:44:34.944708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:34.945952 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:34.945811 after 11.51 seconds
[0m07:44:34.946793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b2970850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b2c2cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b686f690>]}
[0m07:44:34.947667 [debug] [MainThread]: Flushing usage events
[0m07:45:41.801819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d95fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d9647510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d91b76d0>]}


============================== 07:45:41.806528 | 21545933-8215-4de9-8b80-0672a8b486be ==============================
[0m07:45:41.806528 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:45:41.807775 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m07:45:42.273773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d8bb47d0>]}
[0m07:45:42.290320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d71be410>]}
[0m07:45:42.292246 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:45:42.356370 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:45:44.663134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:44.664289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:44.672460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6faa990>]}
[0m07:45:44.696003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d7027e50>]}
[0m07:45:44.697160 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:45:44.698364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc27f910>]}
[0m07:45:44.700764 [info ] [MainThread]: 
[0m07:45:44.702387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:45:44.704665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m07:45:44.705552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:46.482262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:45:46.483601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:47.343969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:45:47.346012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:48.207951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21545933-8215-4de9-8b80-0672a8b486be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d71c9d90>]}
[0m07:45:48.209743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:48.210999 [info ] [MainThread]: 
[0m07:45:48.230942 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:45:48.232160 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m07:45:48.233492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m07:45:48.234253 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:45:48.254248 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:45:48.262140 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 07:45:48.234863 => 07:45:48.261747
[0m07:45:48.263032 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:45:48.282596 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:45:48.290887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:48.295541 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:45:50.306532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c8802bd2-6cc4-46a4-b25c-fe93ca0bdc81&page=queryresults
[0m07:45:50.309483 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 07:45:48.263677 => 07:45:50.309112
[0m07:45:50.311382 [info ] [Thread-1 (]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[32mPASS[0m in 2.08s]
[0m07:45:50.313111 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:45:50.316439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:50.317267 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1' was properly closed.
[0m07:45:50.318215 [info ] [MainThread]: 
[0m07:45:50.319356 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m07:45:50.321127 [debug] [MainThread]: Command end result
[0m07:45:50.355350 [info ] [MainThread]: 
[0m07:45:50.356798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:50.357847 [info ] [MainThread]: 
[0m07:45:50.358910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:45:50.360099 [debug] [MainThread]: Command `dbt test` succeeded at 07:45:50.359957 after 8.58 seconds
[0m07:45:50.361027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d921f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d8cc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d9509a10>]}
[0m07:45:50.361944 [debug] [MainThread]: Flushing usage events
[0m07:48:09.054729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f3ffb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f5a2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f70b490>]}


============================== 07:48:09.060031 | 877bbdeb-1492-4537-8651-9a565209e649 ==============================
[0m07:48:09.060031 [info ] [MainThread]: Running with dbt=1.5.9
[0m07:48:09.061190 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'log_format': 'default'}
[0m07:48:09.506064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50d2a2690>]}
[0m07:48:09.523168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f6fce10>]}
[0m07:48:09.525104 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m07:48:09.587097 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m07:48:11.867316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:48:11.868661 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/warehouse/listing_fact.sql
[0m07:48:11.893074 [debug] [MainThread]: 1603: static parser failed on warehouse/listing_fact.sql
[0m07:48:11.913902 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/listing_fact.sql
[0m07:48:11.978956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50cf2f2d0>]}
[0m07:48:12.002484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50d2b0d90>]}
[0m07:48:12.003682 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m07:48:12.004970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f3ff110>]}
[0m07:48:12.007612 [info ] [MainThread]: 
[0m07:48:12.009169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:48:12.011251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m07:48:12.012057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:13.527712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m07:48:13.529053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:14.337738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m07:48:14.339383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:15.183320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877bbdeb-1492-4537-8651-9a565209e649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50d058b50>]}
[0m07:48:15.184974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:15.186062 [info ] [MainThread]: 
[0m07:48:15.205087 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:48:15.206075 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [RUN]
[0m07:48:15.207531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2)
[0m07:48:15.208404 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:48:15.219473 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m07:48:15.228846 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (compile): 07:48:15.209073 => 07:48:15.228351
[0m07:48:15.230033 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:48:15.250489 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"
[0m07:48:15.258740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:15.262372 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        year, car_model, type
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
    group by year, car_model, type
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:48:17.281126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:927845f3-ab6f-46c4-8c97-6ad74a98d9c2&page=queryresults
[0m07:48:17.283961 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2 (execute): 07:48:15.230775 => 07:48:17.283671
[0m07:48:17.285757 [info ] [Thread-1 (]: 1 of 10 PASS dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type  [[32mPASS[0m in 2.08s]
[0m07:48:17.287207 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2
[0m07:48:17.288392 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:48:17.289405 [info ] [Thread-1 (]: 2 of 10 START test dbt_utils_unique_combination_of_columns_date_dim_date_key__date  [RUN]
[0m07:48:17.290834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_car_dim_year__car_model__type.29eb59d1e2, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd)
[0m07:48:17.291757 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:48:17.299554 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m07:48:17.307838 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (compile): 07:48:17.292509 => 07:48:17.307425
[0m07:48:17.309040 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:48:17.313341 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"
[0m07:48:17.321375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:17.325641 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, date
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
    group by date_key, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:48:19.330286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:fee2a277-eaa9-44ec-a699-0968c1771193&page=queryresults
[0m07:48:19.332465 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd (execute): 07:48:17.310111 => 07:48:19.332111
[0m07:48:19.334454 [info ] [Thread-1 (]: 2 of 10 PASS dbt_utils_unique_combination_of_columns_date_dim_date_key__date ... [[32mPASS[0m in 2.04s]
[0m07:48:19.336068 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd
[0m07:48:19.337306 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:48:19.338302 [info ] [Thread-1 (]: 3 of 10 START test dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [RUN]
[0m07:48:19.339710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_date_dim_date_key__date.f077bed0cd, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1)
[0m07:48:19.340634 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:48:19.352412 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:48:19.359989 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (compile): 07:48:19.341452 => 07:48:19.359620
[0m07:48:19.360868 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:48:19.370640 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"
[0m07:48:19.378126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:19.382397 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        date_key, car_key, location_key, price, odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact`
    group by date_key, car_key, location_key, price, odometer
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:48:21.035003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:1b34b88c-51b5-464f-8968-81587723b856&page=queryresults
[0m07:48:21.036765 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1 (execute): 07:48:19.361492 => 07:48:21.036458
[0m07:48:21.038394 [info ] [Thread-1 (]: 3 of 10 PASS dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer  [[32mPASS[0m in 1.70s]
[0m07:48:21.039944 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1
[0m07:48:21.041126 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:48:21.042062 [info ] [Thread-1 (]: 4 of 10 START test dbt_utils_unique_combination_of_columns_location_dim_suburb__state  [RUN]
[0m07:48:21.043478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_listing_fact_date_key__car_key__location_key__price__odometer.7510832fd1, now test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9)
[0m07:48:21.044412 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:48:21.054557 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"
[0m07:48:21.063920 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9 (compile): 07:48:21.045243 => 07:48:21.063530
[0m07:48:21.064973 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:48:21.068585 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"
[0m07:48:21.076029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:21.079697 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        suburb, state
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
    group by suburb, state
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m07:48:22.941138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c84fc4f7-d40a-45e5-b078-60c286fd4862&page=queryresults
[0m07:48:22.942951 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9 (execute): 07:48:21.065668 => 07:48:22.942644
[0m07:48:22.944445 [info ] [Thread-1 (]: 4 of 10 PASS dbt_utils_unique_combination_of_columns_location_dim_suburb__state  [[32mPASS[0m in 1.90s]
[0m07:48:22.945960 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9
[0m07:48:22.947142 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:48:22.948094 [info ] [Thread-1 (]: 5 of 10 START test not_null_car_dim_car_key .................................... [RUN]
[0m07:48:22.949547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.dbt_utils_unique_combination_of_columns_location_dim_suburb__state.3d342b2ae9, now test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339)
[0m07:48:22.950490 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:48:22.959537 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m07:48:22.967829 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (compile): 07:48:22.951353 => 07:48:22.967399
[0m07:48:22.968833 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:48:22.972581 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"
[0m07:48:22.980271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:22.984178 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select car_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
where car_key is null



      
    ) dbt_internal_test
[0m07:48:24.915530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ac174d57-1e61-4f93-ad36-3eaf57e4b4ad&page=queryresults
[0m07:48:24.917469 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339 (execute): 07:48:22.969557 => 07:48:24.917151
[0m07:48:24.919106 [info ] [Thread-1 (]: 5 of 10 PASS not_null_car_dim_car_key .......................................... [[32mPASS[0m in 1.97s]
[0m07:48:24.920677 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339
[0m07:48:24.921940 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:48:24.923016 [info ] [Thread-1 (]: 6 of 10 START test not_null_date_dim_date_key .................................. [RUN]
[0m07:48:24.924535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_car_dim_car_key.72123ee339, now test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe)
[0m07:48:24.925443 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:48:24.933602 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"
[0m07:48:24.942455 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe (compile): 07:48:24.926228 => 07:48:24.942015
[0m07:48:24.943504 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:48:24.947173 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"
[0m07:48:24.954177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:24.957742 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
where date_key is null



      
    ) dbt_internal_test
[0m07:48:26.955778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:c6706e02-90ff-48b2-9c41-041006fd7767&page=queryresults
[0m07:48:26.957662 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe (execute): 07:48:24.944184 => 07:48:26.957394
[0m07:48:26.959338 [info ] [Thread-1 (]: 6 of 10 PASS not_null_date_dim_date_key ........................................ [[32mPASS[0m in 2.04s]
[0m07:48:26.960908 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe
[0m07:48:26.962129 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:48:26.963134 [info ] [Thread-1 (]: 7 of 10 START test not_null_location_dim_location_key .......................... [RUN]
[0m07:48:26.964493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_date_dim_date_key.83152a8dfe, now test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76)
[0m07:48:26.965366 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:48:26.978526 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:48:26.987391 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (compile): 07:48:26.966113 => 07:48:26.986924
[0m07:48:26.988297 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:48:26.991756 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"
[0m07:48:26.998542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:27.002198 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_key
from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
where location_key is null



      
    ) dbt_internal_test
[0m07:48:28.704200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ba11f002-de4f-4be3-ab0b-4d779108f7bb&page=queryresults
[0m07:48:28.706132 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76 (execute): 07:48:26.988887 => 07:48:28.705778
[0m07:48:28.707725 [info ] [Thread-1 (]: 7 of 10 PASS not_null_location_dim_location_key ................................ [[32mPASS[0m in 1.74s]
[0m07:48:28.709390 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76
[0m07:48:28.710624 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:48:28.711581 [info ] [Thread-1 (]: 8 of 10 START test unique_car_dim_car_key ...................................... [RUN]
[0m07:48:28.713076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_location_dim_location_key.231d5cfa76, now test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4)
[0m07:48:28.713994 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:48:28.725150 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m07:48:28.733454 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (compile): 07:48:28.714845 => 07:48:28.733006
[0m07:48:28.734429 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:48:28.738065 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"
[0m07:48:28.745177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:28.748918 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select car_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim`
  where car_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:48:30.696172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:3626841c-636d-4c64-9870-c68438d3a892&page=queryresults
[0m07:48:30.698053 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4 (execute): 07:48:28.735113 => 07:48:30.697720
[0m07:48:30.699654 [info ] [Thread-1 (]: 8 of 10 PASS unique_car_dim_car_key ............................................ [[32mPASS[0m in 1.99s]
[0m07:48:30.701320 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4
[0m07:48:30.702526 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:48:30.703549 [info ] [Thread-1 (]: 9 of 10 START test unique_date_dim_date_key .................................... [RUN]
[0m07:48:30.704987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.unique_car_dim_car_key.4f2c94a9b4, now test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1)
[0m07:48:30.705964 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:48:30.712083 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"
[0m07:48:30.721590 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1 (compile): 07:48:30.706828 => 07:48:30.721180
[0m07:48:30.722526 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:48:30.726226 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"
[0m07:48:30.734818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:30.738969 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim`
  where date_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:48:32.716342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:0bc0ae26-a953-4dbf-ba69-99692d252d9c&page=queryresults
[0m07:48:32.718350 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1 (execute): 07:48:30.723225 => 07:48:32.718066
[0m07:48:32.720131 [info ] [Thread-1 (]: 9 of 10 PASS unique_date_dim_date_key .......................................... [[32mPASS[0m in 2.02s]
[0m07:48:32.721810 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1
[0m07:48:32.722975 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:48:32.724006 [info ] [Thread-1 (]: 10 of 10 START test unique_location_dim_location_key ........................... [RUN]
[0m07:48:32.725427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.unique_date_dim_date_key.a16d57c7b1, now test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91)
[0m07:48:32.726292 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:48:32.732305 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:48:32.739921 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (compile): 07:48:32.726987 => 07:48:32.739562
[0m07:48:32.740771 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:48:32.744680 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"
[0m07:48:32.751593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:32.754981 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_key as unique_field
  from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim`
  where location_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:48:34.574634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:1817a115-44e4-40d2-92a4-0c12adff81a1&page=queryresults
[0m07:48:34.576506 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91 (execute): 07:48:32.741512 => 07:48:34.576137
[0m07:48:34.578225 [info ] [Thread-1 (]: 10 of 10 PASS unique_location_dim_location_key ................................. [[32mPASS[0m in 1.85s]
[0m07:48:34.579754 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91
[0m07:48:34.582555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:48:34.583450 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.unique_location_dim_location_key.8e93113e91' was properly closed.
[0m07:48:34.584350 [info ] [MainThread]: 
[0m07:48:34.585476 [info ] [MainThread]: Finished running 10 tests in 0 hours 0 minutes and 22.58 seconds (22.58s).
[0m07:48:34.600907 [debug] [MainThread]: Command end result
[0m07:48:34.624348 [info ] [MainThread]: 
[0m07:48:34.625605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:48:34.626636 [info ] [MainThread]: 
[0m07:48:34.627651 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m07:48:34.628822 [debug] [MainThread]: Command `dbt test` succeeded at 07:48:34.628688 after 25.59 seconds
[0m07:48:34.629589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f71a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50f5dea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5132ff7d0>]}
[0m07:48:34.630336 [debug] [MainThread]: Flushing usage events
[0m08:09:08.167060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729db4ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e2fd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729e0aac10>]}


============================== 08:09:08.171733 | 79d5f1ed-6870-49a9-8c73-942c50de903e ==============================
[0m08:09:08.171733 [info ] [MainThread]: Running with dbt=1.5.9
[0m08:09:08.172942 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True'}
[0m08:09:08.622338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79d5f1ed-6870-49a9-8c73-942c50de903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729c05fb10>]}
[0m08:09:08.639996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79d5f1ed-6870-49a9-8c73-942c50de903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729c05ee90>]}
[0m08:09:08.641536 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:09:08.704680 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m08:09:10.963472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:09:10.964397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:09:10.971941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79d5f1ed-6870-49a9-8c73-942c50de903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729be12e90>]}
[0m08:09:10.998058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79d5f1ed-6870-49a9-8c73-942c50de903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729bef3f10>]}
[0m08:09:10.999324 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:09:11.000398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d5f1ed-6870-49a9-8c73-942c50de903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a1118290>]}
[0m08:09:11.002846 [info ] [MainThread]: 
[0m08:09:11.004493 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:09:11.006731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m08:09:11.007812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:12.762854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m08:09:12.764194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:13.575222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m08:09:13.576434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:14.386706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:14.387713 [debug] [MainThread]: Connection 'list_autotrader-toyota-dashboard_autotrader_staging' was properly closed.
[0m08:09:14.388482 [info ] [MainThread]: 
[0m08:09:14.389415 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m08:09:14.390354 [error] [MainThread]: Encountered an error:

[0m08:09:14.394102 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 781, in test
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 405, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 383, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 461, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 435, in _relations_cache_for_schemas
    for future in as_completed(futures):
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m08:09:14.395303 [debug] [MainThread]: Command `dbt test` failed at 08:09:14.395173 after 6.25 seconds
[0m08:09:14.396181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729c055650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a20bb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a20bb810>]}
[0m08:09:14.397149 [debug] [MainThread]: Flushing usage events
[0m08:26:22.228627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4be59310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4be6d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4bd18b90>]}


============================== 08:26:22.233700 | 4bc42644-4862-40d0-849c-bdf4f3a12fba ==============================
[0m08:26:22.233700 [info ] [MainThread]: Running with dbt=1.5.9
[0m08:26:22.235074 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m08:26:22.671986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49cf4cd0>]}
[0m08:26:22.688751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49ce2b90>]}
[0m08:26:22.690261 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:26:22.776878 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m08:26:26.000832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:26:26.002259 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m08:26:26.029050 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m08:26:26.091673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b499e8910>]}
[0m08:26:26.114673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49d50750>]}
[0m08:26:26.115798 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:26:26.117021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4ee0b910>]}
[0m08:26:26.119238 [info ] [MainThread]: 
[0m08:26:26.120754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:26:26.122338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m08:26:26.123126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:27.716625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m08:26:27.717842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:28.536173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m08:26:28.537849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:29.367508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m08:26:29.368809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:30.169533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4be6de10>]}
[0m08:26:30.171253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:30.172385 [info ] [MainThread]: 
[0m08:26:30.187982 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m08:26:30.189350 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m08:26:30.190741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_obt)
[0m08:26:30.191873 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m08:26:30.204963 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m08:26:30.216581 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 08:26:30.192634 => 08:26:30.216165
[0m08:26:30.217625 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m08:26:30.233734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:31.110592 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m08:26:31.122142 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    listing_fact.location_key = listing_fact.location_key
    where timestamp(date_dim.date) >= timestamp(current_date(), interval 3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m08:26:31.413457 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]')
[0m08:26:31.907217 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:21f69784-8c55-4f3a-b21f-db9ea3d7944f&page=queryresults
[0m08:26:31.909223 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 08:26:30.218335 => 08:26:31.908936
[0m08:26:31.914886 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m08:26:31.916215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc42644-4862-40d0-849c-bdf4f3a12fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49d6d350>]}
[0m08:26:31.917765 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 1.73s]
[0m08:26:31.919313 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m08:26:31.922300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:31.923255 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m08:26:31.924180 [info ] [MainThread]: 
[0m08:26:31.925270 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m08:26:31.926571 [debug] [MainThread]: Command end result
[0m08:26:31.949314 [info ] [MainThread]: 
[0m08:26:31.950665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:26:31.951655 [info ] [MainThread]: 
[0m08:26:31.952593 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m08:26:31.953516 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]
[0m08:26:31.954449 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m08:26:31.955303 [info ] [MainThread]: 
[0m08:26:31.956227 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:26:31.957425 [debug] [MainThread]: Command `dbt run` failed at 08:26:31.957285 after 9.77 seconds
[0m08:26:31.958319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4c18b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4becff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49cd8610>]}
[0m08:26:31.959162 [debug] [MainThread]: Flushing usage events
[0m09:39:45.624677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332a713550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332a30b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332a75f290>]}


============================== 09:39:45.629720 | 2d171d55-d282-4f2f-9744-211888b6ce12 ==============================
[0m09:39:45.629720 [info ] [MainThread]: Running with dbt=1.5.9
[0m09:39:45.631017 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m09:39:46.094428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332910b390>]}
[0m09:39:46.110693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33281099d0>]}
[0m09:39:46.111941 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:39:46.176486 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m09:39:48.588083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:39:48.589398 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m09:39:48.615519 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m09:39:48.678276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33281485d0>]}
[0m09:39:48.701635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3328158b90>]}
[0m09:39:48.702793 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:39:48.703856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332d3a0590>]}
[0m09:39:48.705921 [info ] [MainThread]: 
[0m09:39:48.707319 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:39:48.709041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m09:39:48.709867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:39:51.785338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m09:39:51.786598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:52.788425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m09:39:52.789986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:53.718471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m09:39:53.720067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:54.579413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332d3a0590>]}
[0m09:39:54.581195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:39:54.582381 [info ] [MainThread]: 
[0m09:39:54.597954 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m09:39:54.599242 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m09:39:54.600568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_obt)
[0m09:39:54.601676 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m09:39:54.616044 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:39:54.623052 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 09:39:54.602400 => 09:39:54.622535
[0m09:39:54.625017 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m09:39:54.640707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:39:55.588252 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:39:55.596411 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    listing_fact.location_key = location_dim.location_key
    where timestamp(date_dim.date) >= timestamp(current_date(), interval 3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m09:39:55.961388 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]')
[0m09:39:56.579361 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:2dd18133-b974-440e-a96f-672d9b00ccdd&page=queryresults
[0m09:39:56.581316 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 09:39:54.625879 => 09:39:56.580987
[0m09:39:56.589338 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:39:56.590577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d171d55-d282-4f2f-9744-211888b6ce12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33280b9990>]}
[0m09:39:56.592035 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 1.99s]
[0m09:39:56.593510 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m09:39:56.596561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:39:56.597379 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m09:39:56.598469 [info ] [MainThread]: 
[0m09:39:56.599563 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m09:39:56.600706 [debug] [MainThread]: Command end result
[0m09:39:56.622621 [info ] [MainThread]: 
[0m09:39:56.624104 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:39:56.625093 [info ] [MainThread]: 
[0m09:39:56.626067 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m09:39:56.626993 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "listing_fact" at [32:5]
[0m09:39:56.627863 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:39:56.628791 [info ] [MainThread]: 
[0m09:39:56.629716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:39:56.630887 [debug] [MainThread]: Command `dbt run` failed at 09:39:56.630745 after 11.02 seconds
[0m09:39:56.631883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332a585310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332a586310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3329ef8cd0>]}
[0m09:39:56.632811 [debug] [MainThread]: Flushing usage events
[0m09:46:51.121757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d637b5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d637b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d63498d90>]}


============================== 09:46:51.126617 | f0cf2897-007e-405d-9fec-d6c53c96abd3 ==============================
[0m09:46:51.126617 [info ] [MainThread]: Running with dbt=1.5.9
[0m09:46:51.127911 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m09:46:51.587570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6349b910>]}
[0m09:46:51.604178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d62e30a10>]}
[0m09:46:51.605580 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:46:51.669151 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m09:46:53.854580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:53.855834 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m09:46:53.882014 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m09:46:53.945848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d61224350>]}
[0m09:46:53.970555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d60f98f50>]}
[0m09:46:53.971695 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:46:53.972759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d663fc050>]}
[0m09:46:53.974858 [info ] [MainThread]: 
[0m09:46:53.976235 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:46:53.977894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m09:46:53.978676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:56.935981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m09:46:56.937334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:57.773212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m09:46:57.775282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:58.671122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m09:46:58.672618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:59.617825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d611d3d10>]}
[0m09:46:59.619720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:46:59.620674 [info ] [MainThread]: 
[0m09:46:59.638403 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m09:46:59.639617 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m09:46:59.641067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listings_obt)
[0m09:46:59.642210 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m09:46:59.656797 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:46:59.664126 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 09:46:59.643000 => 09:46:59.663497
[0m09:46:59.665650 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m09:46:59.681280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:00.686757 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:47:00.693702 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    on listing_fact.location_key = location_dim.location_key
    where timestamp(date_dim.date) >= timestamp(current_date(), interval 3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m09:47:00.973629 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "calc_avg_price_national" at [68:1]')
[0m09:47:02.040496 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:afdf357e-e90e-4deb-9589-bb85727c96c7&page=queryresults
[0m09:47:02.042408 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 09:46:59.666423 => 09:47:02.042058
[0m09:47:02.048154 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  Syntax error: Expected ")" but got identifier "calc_avg_price_national" at [68:1]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:47:02.049263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cf2897-007e-405d-9fec-d6c53c96abd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6111d790>]}
[0m09:47:02.050545 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 2.41s]
[0m09:47:02.051923 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m09:47:02.054939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:02.055904 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m09:47:02.056867 [info ] [MainThread]: 
[0m09:47:02.058300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m09:47:02.059546 [debug] [MainThread]: Command end result
[0m09:47:02.081674 [info ] [MainThread]: 
[0m09:47:02.083129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:47:02.084455 [info ] [MainThread]: 
[0m09:47:02.085621 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m09:47:02.086751 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "calc_avg_price_national" at [68:1]
[0m09:47:02.087656 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:47:02.088542 [info ] [MainThread]: 
[0m09:47:02.089615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:47:02.090940 [debug] [MainThread]: Command `dbt run` failed at 09:47:02.090771 after 10.99 seconds
[0m09:47:02.091857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6339d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d635f0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d635f1c50>]}
[0m09:47:02.092690 [debug] [MainThread]: Flushing usage events
[0m09:55:34.582883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea675e1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea672b4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6749a650>]}


============================== 09:55:34.587726 | 07a256b4-e714-494e-9bc6-a34dde0b5c21 ==============================
[0m09:55:34.587726 [info ] [MainThread]: Running with dbt=1.5.9
[0m09:55:34.589162 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True'}
[0m09:55:35.058074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea64f97450>]}
[0m09:55:35.076641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea64f96710>]}
[0m09:55:35.078286 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:55:35.140519 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m09:55:37.389359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:37.391071 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m09:55:37.417477 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m09:55:37.481450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea64fac710>]}
[0m09:55:37.507593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea64dcf310>]}
[0m09:55:37.508785 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:55:37.509847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6a218050>]}
[0m09:55:37.511979 [info ] [MainThread]: 
[0m09:55:37.513480 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:55:37.515197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m09:55:37.516063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:38.966999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m09:55:38.968265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:39.859845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m09:55:39.861561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:40.926710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m09:55:40.928245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:41.849001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea672c6b50>]}
[0m09:55:41.850836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:41.851931 [info ] [MainThread]: 
[0m09:55:41.867980 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m09:55:41.869235 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m09:55:41.870761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_obt)
[0m09:55:41.871936 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m09:55:41.885655 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:55:41.893674 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 09:55:41.872665 => 09:55:41.893202
[0m09:55:41.894715 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m09:55:41.910654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:43.103350 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:55:43.111198 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    on listing_fact.location_key = location_dim.location_key
    where timestamp(date_dim.date) >= timestamp(current_date(), interval 3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer,
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m09:55:44.086536 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]')
[0m09:55:45.721394 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:f938e218-6650-4739-853a-09f2dd59f309&page=queryresults
[0m09:55:45.723284 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 09:55:41.895398 => 09:55:45.722969
[0m09:55:45.728748 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:55:45.729931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a256b4-e714-494e-9bc6-a34dde0b5c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea64dce190>]}
[0m09:55:45.731218 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 3.86s]
[0m09:55:45.732466 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m09:55:45.735411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:45.736493 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m09:55:45.737443 [info ] [MainThread]: 
[0m09:55:45.738425 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m09:55:45.739506 [debug] [MainThread]: Command end result
[0m09:55:45.761219 [info ] [MainThread]: 
[0m09:55:45.762401 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:55:45.763497 [info ] [MainThread]: 
[0m09:55:45.764652 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m09:55:45.765902 [error] [MainThread]:   No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]
[0m09:55:45.767341 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:55:45.768343 [info ] [MainThread]: 
[0m09:55:45.769729 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:55:45.771381 [debug] [MainThread]: Command `dbt run` failed at 09:55:45.771195 after 11.20 seconds
[0m09:55:45.772270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66c3b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66c4e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6b18c790>]}
[0m09:55:45.773204 [debug] [MainThread]: Flushing usage events
[0m09:57:42.358440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90323f7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90324243d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90323f7b90>]}


============================== 09:57:42.363522 | 2cb0f90f-c14a-4c6e-a857-307fdace7361 ==============================
[0m09:57:42.363522 [info ] [MainThread]: Running with dbt=1.5.9
[0m09:57:42.364815 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m09:57:42.820059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90323f78d0>]}
[0m09:57:42.836332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902ffde210>]}
[0m09:57:42.837739 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:57:42.899476 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m09:57:45.127960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:45.129191 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m09:57:45.154854 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m09:57:45.217338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f903004ac90>]}
[0m09:57:45.240374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902fe16f90>]}
[0m09:57:45.241571 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:57:45.242945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90350e7950>]}
[0m09:57:45.245099 [info ] [MainThread]: 
[0m09:57:45.246564 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:57:45.248243 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m09:57:45.249075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:47.699163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m09:57:47.700670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:48.716499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m09:57:48.718167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:49.601900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m09:57:49.603310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:50.563994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902ffb7990>]}
[0m09:57:50.565694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:50.566762 [info ] [MainThread]: 
[0m09:57:50.582667 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m09:57:50.583849 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m09:57:50.585202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now model.autotrader_toyota_dbt.listings_obt)
[0m09:57:50.586188 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m09:57:50.600366 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:57:50.608025 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 09:57:50.586775 => 09:57:50.607621
[0m09:57:50.609009 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m09:57:50.624303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:51.674294 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m09:57:51.682118 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    on listing_fact.location_key = location_dim.location_key
    where timestamp(date_dim.date) >= timestamp(current_date(), interval -3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer,
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m09:57:52.553006 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]')
[0m09:57:53.980872 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:ebaa910d-3965-4c59-9808-367497c4677c&page=queryresults
[0m09:57:53.982762 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 09:57:50.609693 => 09:57:53.982458
[0m09:57:53.988632 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:57:53.990292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb0f90f-c14a-4c6e-a857-307fdace7361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902fdc97d0>]}
[0m09:57:53.991772 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 3.41s]
[0m09:57:53.993195 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m09:57:53.996198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:53.997162 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m09:57:53.997873 [info ] [MainThread]: 
[0m09:57:53.998823 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m09:57:53.999897 [debug] [MainThread]: Command end result
[0m09:57:54.022698 [info ] [MainThread]: 
[0m09:57:54.024031 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:54.025050 [info ] [MainThread]: 
[0m09:57:54.025986 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m09:57:54.026926 [error] [MainThread]:   No matching signature for function TIMESTAMP for argument types: DATE, INTERVAL. Supported signatures: TIMESTAMP(STRING, [STRING]); TIMESTAMP(DATE, [STRING]); TIMESTAMP(DATETIME, [STRING]); TIMESTAMP(TIMESTAMP) at [33:39]
[0m09:57:54.027871 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m09:57:54.028720 [info ] [MainThread]: 
[0m09:57:54.029620 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:57:54.030812 [debug] [MainThread]: Command `dbt run` failed at 09:57:54.030671 after 11.69 seconds
[0m09:57:54.031720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9032120490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9031c8be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9032009dd0>]}
[0m09:57:54.032602 [debug] [MainThread]: Flushing usage events
[0m10:00:59.768865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf795cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf79ff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf796bbd0>]}


============================== 10:00:59.773721 | 1a7888a0-0c57-4889-b3e6-9fb4d7243f0d ==============================
[0m10:00:59.773721 [info ] [MainThread]: Running with dbt=1.5.9
[0m10:00:59.774953 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m10:01:00.222886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7888a0-0c57-4889-b3e6-9fb4d7243f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf766cc10>]}
[0m10:01:00.239771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7888a0-0c57-4889-b3e6-9fb4d7243f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf5f97550>]}
[0m10:01:00.241019 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:01:00.304642 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m10:01:02.641018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:02.641949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:02.649281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7888a0-0c57-4889-b3e6-9fb4d7243f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf5361ad0>]}
[0m10:01:02.673154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7888a0-0c57-4889-b3e6-9fb4d7243f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf5530490>]}
[0m10:01:02.674231 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:01:02.675274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7888a0-0c57-4889-b3e6-9fb4d7243f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfa61f990>]}
[0m10:01:02.677280 [info ] [MainThread]: 
[0m10:01:02.678582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:02.680080 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m10:01:02.680834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:05.277064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:05.278304 [debug] [MainThread]: Connection 'list_autotrader-toyota-dashboard' was properly closed.
[0m10:01:05.279428 [info ] [MainThread]: 
[0m10:01:05.280710 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m10:01:05.282135 [error] [MainThread]: Encountered an error:

[0m10:01:05.294666 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 405, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 545, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m10:01:05.296696 [debug] [MainThread]: Command `dbt run` failed at 10:01:05.296452 after 5.55 seconds
[0m10:01:05.297665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf799f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf7635bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf7a09c10>]}
[0m10:01:05.298563 [debug] [MainThread]: Flushing usage events
[0m10:01:23.644716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f50dd1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f50d877d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f50dd0290>]}


============================== 10:01:23.649401 | 86eaed25-5834-4645-97ca-cd072506367c ==============================
[0m10:01:23.649401 [info ] [MainThread]: Running with dbt=1.5.9
[0m10:01:23.650723 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80'}
[0m10:01:24.092519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4e95aa50>]}
[0m10:01:24.108930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5045dad0>]}
[0m10:01:24.110397 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:01:24.175881 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m10:01:26.670753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:01:26.672050 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m10:01:26.698027 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m10:01:26.763794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4e5c9010>]}
[0m10:01:26.788834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4e58fe10>]}
[0m10:01:26.789997 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:01:26.791093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f53a14250>]}
[0m10:01:26.793189 [info ] [MainThread]: 
[0m10:01:26.794536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:26.796359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m10:01:26.797414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:27.900762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m10:01:27.902212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:28.990779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m10:01:28.992799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:29.940235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m10:01:29.941892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:30.782643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4f77e7d0>]}
[0m10:01:30.784329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:30.785522 [info ] [MainThread]: 
[0m10:01:30.801685 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m10:01:30.802958 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m10:01:30.804424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now model.autotrader_toyota_dbt.listings_obt)
[0m10:01:30.805436 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m10:01:30.819468 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m10:01:30.826919 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 10:01:30.806069 => 10:01:30.826452
[0m10:01:30.827878 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m10:01:30.843158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:31.778051 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m10:01:31.785746 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    on listing_fact.location_key = location_dim.location_key
    where date_dim.date >= date_add(current_date(), interval -3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer,
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m10:01:32.747116 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name model not found inside calc_avg_price_national at [73:67]')
[0m10:01:34.322534 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:51e03567-a7a9-4949-8244-b780c16d533a&page=queryresults
[0m10:01:34.324329 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 10:01:30.828589 => 10:01:34.324029
[0m10:01:34.329648 [debug] [Thread-1 (]: Database Error in model listings_obt (models/analytics/listings_obt.sql)
  Name model not found inside calc_avg_price_national at [73:67]
  compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m10:01:34.330698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86eaed25-5834-4645-97ca-cd072506367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4e4ec710>]}
[0m10:01:34.332087 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model autotrader_analytics.listings_obt ........ [[31mERROR[0m in 3.53s]
[0m10:01:34.333573 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m10:01:34.336638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:34.337565 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m10:01:34.338332 [info ] [MainThread]: 
[0m10:01:34.339191 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m10:01:34.340370 [debug] [MainThread]: Command end result
[0m10:01:34.364670 [info ] [MainThread]: 
[0m10:01:34.365947 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:01:34.366895 [info ] [MainThread]: 
[0m10:01:34.367837 [error] [MainThread]: [33mDatabase Error in model listings_obt (models/analytics/listings_obt.sql)[0m
[0m10:01:34.368763 [error] [MainThread]:   Name model not found inside calc_avg_price_national at [73:67]
[0m10:01:34.369871 [error] [MainThread]:   compiled Code at target/run/autotrader_toyota_dbt/models/analytics/listings_obt.sql
[0m10:01:34.371059 [info ] [MainThread]: 
[0m10:01:34.372615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:01:34.374528 [debug] [MainThread]: Command `dbt run` failed at 10:01:34.374269 after 10.75 seconds
[0m10:01:34.375558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5093f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f4e85c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f548f8410>]}
[0m10:01:34.376501 [debug] [MainThread]: Flushing usage events
[0m10:02:17.804440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9bf8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9c059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9924a50>]}


============================== 10:02:17.809125 | 3da76ea7-ba42-4636-aefb-e9debe33e139 ==============================
[0m10:02:17.809125 [info ] [MainThread]: Running with dbt=1.5.9
[0m10:02:17.810527 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False'}
[0m10:02:18.254852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9173810>]}
[0m10:02:18.271494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9c2b490>]}
[0m10:02:18.273029 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:02:18.337907 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m10:02:20.504307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:20.505760 [debug] [MainThread]: Partial parsing: updated file: autotrader_toyota_dbt://models/analytics/listings_obt.sql
[0m10:02:20.531217 [debug] [MainThread]: 1699: static parser successfully parsed analytics/listings_obt.sql
[0m10:02:20.597336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa76a9fd0>]}
[0m10:02:20.621765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa7637210>]}
[0m10:02:20.622851 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:02:20.623968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaac84c050>]}
[0m10:02:20.626108 [info ] [MainThread]: 
[0m10:02:20.627514 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:02:20.629097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard'
[0m10:02:20.629951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:21.991164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m10:02:21.992556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:22.898508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m10:02:22.900463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:23.799854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now list_autotrader-toyota-dashboard_autotrader_analytics)
[0m10:02:23.801493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:24.693970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa98fbf50>]}
[0m10:02:24.695623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:24.696969 [info ] [MainThread]: 
[0m10:02:24.713246 [debug] [Thread-1 (]: Began running node model.autotrader_toyota_dbt.listings_obt
[0m10:02:24.714693 [info ] [Thread-1 (]: 1 of 1 START sql table model autotrader_analytics.listings_obt ................. [RUN]
[0m10:02:24.716284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now model.autotrader_toyota_dbt.listings_obt)
[0m10:02:24.717367 [debug] [Thread-1 (]: Began compiling node model.autotrader_toyota_dbt.listings_obt
[0m10:02:24.731710 [debug] [Thread-1 (]: Writing injected SQL for node "model.autotrader_toyota_dbt.listings_obt"
[0m10:02:24.740405 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (compile): 10:02:24.718210 => 10:02:24.739914
[0m10:02:24.741576 [debug] [Thread-1 (]: Began executing node model.autotrader_toyota_dbt.listings_obt
[0m10:02:24.757010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:25.654436 [debug] [Thread-1 (]: Writing runtime sql for node "model.autotrader_toyota_dbt.listings_obt"
[0m10:02:25.662095 [debug] [Thread-1 (]: On model.autotrader_toyota_dbt.listings_obt: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "model.autotrader_toyota_dbt.listings_obt"} */

  
    

    create or replace table `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
    
    

    OPTIONS()
    as (
      with last_three_months_records as (
    select
    listing_fact.date_key as date_key,
    listing_fact.car_key as car_key,
    listing_fact.location_key as location_key,
    date_dim.date as date,
    car_dim.year as year,
    car_dim.car_model as car_model,
    car_dim.type as type,
    location_dim.suburb as suburb,
    location_dim.state as state,
    location_dim.geolocation as geolocation,
    listing_fact.price as price,
    listing_fact.odometer as odometer
    from `autotrader-toyota-dashboard`.`autotrader_warehouse`.`listing_fact` listing_fact
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`date_dim` date_dim
    on listing_fact.date_key = date_dim.date_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`car_dim` car_dim
    on listing_fact.car_key = car_dim.car_key
    join `autotrader-toyota-dashboard`.`autotrader_warehouse`.`location_dim` location_dim
    on listing_fact.location_key = location_dim.location_key
    where date_dim.date >= date_add(current_date(), interval -3 month)
),

calc_avg_price_national as (
    select
    year,
    car_model,
    avg(price) as avg_price_national
    from last_three_months_records
    group by year, car_model
),

calc_avg_price_state as (
    select
    state,
    year,
    car_model,
    avg(price) as avg_price_state
    from last_three_months_records
    group by state, year, car_model
)

select 
last_three_months_records.date_key as date_key,
last_three_months_records.car_key as car_key,
last_three_months_records.location_key as location_key,
last_three_months_records.date as date,
last_three_months_records.suburb as suburb,
last_three_months_records.state as state,
last_three_months_records.geolocation as geolocation,
last_three_months_records.year as year,
last_three_months_records.car_model as car_model,
last_three_months_records.type as type,
last_three_months_records.price as price,
last_three_months_records.odometer as odometer,
calc_avg_price_national.avg_price_national as avg_price_national,
calc_avg_price_state.avg_price_state as avg_price_state
from last_three_months_records
join calc_avg_price_national
on last_three_months_records.year = calc_avg_price_national.year
and last_three_months_records.car_model = calc_avg_price_national.car_model
join calc_avg_price_state
on last_three_months_records.year = calc_avg_price_state.year
and last_three_months_records.car_model = calc_avg_price_state.car_model
and last_three_months_records.state = calc_avg_price_state.state
    );
  
[0m10:02:28.484408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:9a1899fb-e1d3-4959-9b03-ccfa3bf06b0b&page=queryresults
[0m10:02:28.502700 [debug] [Thread-1 (]: Timing info for model.autotrader_toyota_dbt.listings_obt (execute): 10:02:24.742334 => 10:02:28.502460
[0m10:02:28.504074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3da76ea7-ba42-4636-aefb-e9debe33e139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa7629e50>]}
[0m10:02:28.505192 [info ] [Thread-1 (]: 1 of 1 OK created sql table model autotrader_analytics.listings_obt ............ [[32mCREATE TABLE (12.9k rows, 651.4 KiB processed)[0m in 3.79s]
[0m10:02:28.506529 [debug] [Thread-1 (]: Finished running node model.autotrader_toyota_dbt.listings_obt
[0m10:02:28.508985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:28.509654 [debug] [MainThread]: Connection 'model.autotrader_toyota_dbt.listings_obt' was properly closed.
[0m10:02:28.510307 [info ] [MainThread]: 
[0m10:02:28.511206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m10:02:28.512513 [debug] [MainThread]: Command end result
[0m10:02:28.533768 [info ] [MainThread]: 
[0m10:02:28.535037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:02:28.536058 [info ] [MainThread]: 
[0m10:02:28.537066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:02:28.538364 [debug] [MainThread]: Command `dbt run` succeeded at 10:02:28.538222 after 10.75 seconds
[0m10:02:28.539232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa97f19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9282610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaad7c0790>]}
[0m10:02:28.540185 [debug] [MainThread]: Flushing usage events
[0m10:03:43.287720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed7939e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed7761410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed7938350>]}


============================== 10:03:43.292377 | 93657991-1f0d-4dd6-9402-0050baf6fa76 ==============================
[0m10:03:43.292377 [info ] [MainThread]: Running with dbt=1.5.9
[0m10:03:43.293500 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'fail_fast': 'False'}
[0m10:03:43.732033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed54c3910>]}
[0m10:03:43.748241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed793b490>]}
[0m10:03:43.749921 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:03:43.812574 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m10:03:46.017944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:46.018950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:46.026442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed527a410>]}
[0m10:03:46.052784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed54ba810>]}
[0m10:03:46.053924 [info ] [MainThread]: Found 7 models, 29 tests, 0 snapshots, 0 analyses, 734 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:03:46.055158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eda57c1d0>]}
[0m10:03:46.057550 [info ] [MainThread]: 
[0m10:03:46.059173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:03:46.061277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_autotrader-toyota-dashboard_autotrader_analytics'
[0m10:03:46.062156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:47.232427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_analytics, now list_autotrader-toyota-dashboard_autotrader_warehouse)
[0m10:03:47.233759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:48.132020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_warehouse, now list_autotrader-toyota-dashboard_autotrader_staging)
[0m10:03:48.133686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:48.983620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93657991-1f0d-4dd6-9402-0050baf6fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed5d67610>]}
[0m10:03:48.985324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:48.986460 [info ] [MainThread]: 
[0m10:03:49.005529 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6
[0m10:03:49.006738 [info ] [Thread-1 (]: 1 of 2 START test not_null_listings_obt_avg_price_national ..................... [RUN]
[0m10:03:49.008199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_autotrader-toyota-dashboard_autotrader_staging, now test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6)
[0m10:03:49.009064 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6
[0m10:03:49.026340 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6"
[0m10:03:49.037537 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6 (compile): 10:03:49.009803 => 10:03:49.037190
[0m10:03:49.038620 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6
[0m10:03:49.057233 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6"
[0m10:03:49.069981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:49.074488 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_price_national
from `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
where avg_price_national is null



      
    ) dbt_internal_test
[0m10:03:51.042821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:cea75db4-65d3-453a-a6ee-2833dabc99bb&page=queryresults
[0m10:03:51.045543 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6 (execute): 10:03:49.039313 => 10:03:51.045236
[0m10:03:51.047128 [info ] [Thread-1 (]: 1 of 2 PASS not_null_listings_obt_avg_price_national ........................... [[32mPASS[0m in 2.04s]
[0m10:03:51.048787 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6
[0m10:03:51.050091 [debug] [Thread-1 (]: Began running node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b
[0m10:03:51.051054 [info ] [Thread-1 (]: 2 of 2 START test not_null_listings_obt_avg_price_state ........................ [RUN]
[0m10:03:51.052550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_national.ced47878e6, now test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b)
[0m10:03:51.053422 [debug] [Thread-1 (]: Began compiling node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b
[0m10:03:51.059778 [debug] [Thread-1 (]: Writing injected SQL for node "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b"
[0m10:03:51.068524 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b (compile): 10:03:51.054148 => 10:03:51.068047
[0m10:03:51.069601 [debug] [Thread-1 (]: Began executing node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b
[0m10:03:51.073465 [debug] [Thread-1 (]: Writing runtime sql for node "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b"
[0m10:03:51.081028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:51.084890 [debug] [Thread-1 (]: On test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "autotrader_toyota_dbt", "target_name": "dev", "node_id": "test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_price_state
from `autotrader-toyota-dashboard`.`autotrader_analytics`.`listings_obt`
where avg_price_state is null



      
    ) dbt_internal_test
[0m10:03:53.069192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=autotrader-toyota-dashboard&j=bq:asia-southeast1:22d338e0-2e13-4950-96e2-aeebec2e7fcb&page=queryresults
[0m10:03:53.070949 [debug] [Thread-1 (]: Timing info for test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b (execute): 10:03:51.070325 => 10:03:53.070645
[0m10:03:53.072426 [info ] [Thread-1 (]: 2 of 2 PASS not_null_listings_obt_avg_price_state .............................. [[32mPASS[0m in 2.02s]
[0m10:03:53.073675 [debug] [Thread-1 (]: Finished running node test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b
[0m10:03:53.076104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:53.076863 [debug] [MainThread]: Connection 'test.autotrader_toyota_dbt.not_null_listings_obt_avg_price_state.a98035dc3b' was properly closed.
[0m10:03:53.077657 [info ] [MainThread]: 
[0m10:03:53.078619 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m10:03:53.080044 [debug] [MainThread]: Command end result
[0m10:03:53.113642 [info ] [MainThread]: 
[0m10:03:53.115045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:53.116226 [info ] [MainThread]: 
[0m10:03:53.117677 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:03:53.119059 [debug] [MainThread]: Command `dbt test` succeeded at 10:03:53.118855 after 9.85 seconds
[0m10:03:53.119979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed6f8ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edb51f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed791d090>]}
[0m10:03:53.120869 [debug] [MainThread]: Flushing usage events
